<!--
HTML file automatically generated from DocOnce source
(https://github.com/doconce/doconce/)
doconce format html week14.do.txt --html_style=bootstrap --pygments_html_style=default --html_admon=bootstrap_panel --html_output=week14-bs --no_mako
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="PHY321: Variational calculus">
<title>PHY321: Variational calculus</title>
<!-- Bootstrap style: bootstrap -->
<!-- doconce format html week14.do.txt --html_style=bootstrap --pygments_html_style=default --html_admon=bootstrap_panel --html_output=week14-bs --no_mako -->
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->
<style type="text/css">
/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}
/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px;      /* fixed header height for style bootstrap */
  margin:-50px 0 0; /* negative fixed header height */
}
</style>
</head>

<!-- tocinfo
{'highest level': 2,
 'sections': [('Aims and Overarching Motivation',
               2,
               None,
               'aims-and-overarching-motivation'),
              ('Monday April 10', 3, None, 'monday-april-10'),
              ('Wednesday April 12', 3, None, 'wednesday-april-12'),
              ('Friday April 14', 3, None, 'friday-april-14'),
              ('Variational Calculus', 2, None, 'variational-calculus'),
              ('Variational Calculus, introducing the action',
               2,
               None,
               'variational-calculus-introducing-the-action'),
              ('Variational Calculus, general Action',
               2,
               None,
               'variational-calculus-general-action'),
              ('Variational Calculus, Optimal Path',
               2,
               None,
               'variational-calculus-optimal-path'),
              ('Variational Calculus, Condition for an Extreme Value',
               2,
               None,
               'variational-calculus-condition-for-an-extreme-value'),
              ('Variational Calculus. $\\alpha$ Dependence',
               2,
               None,
               'variational-calculus-alpha-dependence'),
              ('Integrating by Parts', 2, None, 'integrating-by-parts'),
              ('Euler-Lagrange Equations', 2, None, 'euler-lagrange-equations'),
              ('Why is the Lagrangian defined as the difference between '
               'kinetic and potential energy?',
               2,
               None,
               'why-is-the-lagrangian-defined-as-the-difference-between-kinetic-and-potential-energy'),
              ('What if we plot the difference between kinetic and potential '
               'energy instead?',
               2,
               None,
               'what-if-we-plot-the-difference-between-kinetic-and-potential-energy-instead')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="week14-bs.html">PHY321: Variational calculus</a>
  </div>
  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="#aims-and-overarching-motivation" style="font-size: 80%;"><b>Aims and Overarching Motivation</b></a></li>
     <!-- navigation toc: --> <li><a href="#monday-april-10" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Monday April 10</a></li>
     <!-- navigation toc: --> <li><a href="#wednesday-april-12" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Wednesday April 12</a></li>
     <!-- navigation toc: --> <li><a href="#friday-april-14" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Friday April 14</a></li>
     <!-- navigation toc: --> <li><a href="#variational-calculus" style="font-size: 80%;"><b>Variational Calculus</b></a></li>
     <!-- navigation toc: --> <li><a href="#variational-calculus-introducing-the-action" style="font-size: 80%;"><b>Variational Calculus, introducing the action</b></a></li>
     <!-- navigation toc: --> <li><a href="#variational-calculus-general-action" style="font-size: 80%;"><b>Variational Calculus, general Action</b></a></li>
     <!-- navigation toc: --> <li><a href="#variational-calculus-optimal-path" style="font-size: 80%;"><b>Variational Calculus, Optimal Path</b></a></li>
     <!-- navigation toc: --> <li><a href="#variational-calculus-condition-for-an-extreme-value" style="font-size: 80%;"><b>Variational Calculus, Condition for an Extreme Value</b></a></li>
     <!-- navigation toc: --> <li><a href="#variational-calculus-alpha-dependence" style="font-size: 80%;"><b>Variational Calculus. \( \alpha \) Dependence</b></a></li>
     <!-- navigation toc: --> <li><a href="#integrating-by-parts" style="font-size: 80%;"><b>Integrating by Parts</b></a></li>
     <!-- navigation toc: --> <li><a href="#euler-lagrange-equations" style="font-size: 80%;"><b>Euler-Lagrange Equations</b></a></li>
     <!-- navigation toc: --> <li><a href="#why-is-the-lagrangian-defined-as-the-difference-between-kinetic-and-potential-energy" style="font-size: 80%;"><b>Why is the Lagrangian defined as the difference between kinetic and potential energy?</b></a></li>
     <!-- navigation toc: --> <li><a href="#what-if-we-plot-the-difference-between-kinetic-and-potential-energy-instead" style="font-size: 80%;"><b>What if we plot the difference between kinetic and potential energy instead?</b></a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->
<div class="container">
<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->
<!-- ------------------- main content ---------------------- -->
<div class="jumbotron">
<center>
<h1>PHY321: Variational calculus</h1>
</center>  <!-- document title -->

<!-- author(s): <a href="http://mhjgit.github.io/info/doc/web/" target="_self">Morten Hjorth-Jensen</a> -->
<center>
<b><a href="http://mhjgit.github.io/info/doc/web/" target="_self">Morten Hjorth-Jensen</a></b> [1, 2]
</center>
<!-- institution(s) -->
<center>
[1] <b>Department of Physics and Astronomy and Facility for Rare Isotope Beams (FRIB), Michigan State University, USA</b>
</center>
<center>
[2] <b>Department of Physics, University of Oslo, Norway</b>
</center>
<br>
<center>
<h4>April 10-14</h4>
</center> <!-- date -->
<br>

<!-- potential-jumbotron-button -->
</div> <!-- end jumbotron -->

<!-- !split -->
<h2 id="aims-and-overarching-motivation" class="anchor">Aims and Overarching Motivation </h2>
<h3 id="monday-april-10" class="anchor">Monday April 10 </h3>

<ul>
<li> Lagrangian formalism, top down approach first and derivation of the Euler-Lagrange equations</li>
<li> Principle of Least Action, watch <a href="https://www.feynmanlectures.caltech.edu/II_19.html" target="_self">Feynman Lecture</a>.</li>
<li> <a href="https://youtu.be/Sfkdnq9JKB8" target="_self">Video of lecture</a></li>
<li> <a href="https://github.com/mhjensen/Physics321/blob/master/doc/HandWrittenNotes/Spring2023/NotesApril10.pdf" target="_self">Handwritten notes</a></li>
</ul>
<p><b>Reading suggestion this week</b>: Taylor sections 6.1-6.4</p>
<h3 id="wednesday-april-12" class="anchor">Wednesday April 12 </h3>

<ul>
<li> Euler-Lagrange equations and the Lagrangian with examples</li>
<li> Principle of Least Action, watch <a href="https://www.feynmanlectures.caltech.edu/II_19.html" target="_self">Feynman Lecture</a>.</li>
<li> <a href="https://youtu.be/vNKn1HyC9kw" target="_self">Video of lecture TBA</a></li>
<li> <a href="https://github.com/mhjensen/Physics321/blob/master/doc/HandWrittenNotes/Spring2023/NotesApril12.pdf" target="_self">Handwritten notes</a></li>
</ul>
<p><b>Reading suggestion</b>: Taylor sections 6.1-6.4</p>

<a href="https://en.wikipedia.org/wiki/Calculus_of_variations" target="_self">See also Variational Calculus</a>
<h3 id="friday-april-14" class="anchor">Friday April 14 </h3>

<p>Discussion and work on second midterm. </p>

<!-- !split -->
<h2 id="variational-calculus" class="anchor">Variational Calculus </h2>

<p>The calculus of variations involves 
problems where the quantity to be minimized or maximized is an integral. 
</p>

<p>The usual minimization problem one faces involves taking a function
\( {\cal L}(x) \), then finding the single value \( x \) for which \( {\cal L} \)
is either a maximum or minimum. In multivariate calculus one also
learns to solve problems where you minimize for multiple variables,
\( {\cal L}(x_1,x_2,\cdots x_n) \), and finding the points \( (x_1\cdots
y_n) \) in an \( n \)-dimensional space that maximize or minimize the
function. Here, we consider what seems to be a much more ambitious
problem. Imagine you have a function \( {\cal L}(x(t),\dot{x}(t),t) \),
and you wish to find the extrema for an infinite number of values of
\( x \), i.e. \( x \) at each point \( t \). The function \( {\cal L} \) will not only
depend on \( x \) at each point \( t \), but also on the slope at each point,
plus an additional dependence on \( t \). Note we are NOT finding an
optimum value of \( t \), we are finding the set of optimum values of \( x \)
at each point \( t \), or equivalently, finding the function \( x(t) \).
</p>

<!-- !split -->
<h2 id="variational-calculus-introducing-the-action" class="anchor">Variational Calculus, introducing the action </h2>

<p>One treats the function \( x(t) \) as being unknown while minimizing the action</p>

$$
S=\int_{t_1}^{t_2}dt~{\cal L}(x(t),\dot{x}(t),t).
$$

<p>Thus, we are minimizing \( S \) with respect to an infinite number of
values of \( x(t_i) \) at points \( t_i \). As an additional criteria, we will
assume that \( x(t_1) \) and \( x(t_2) \) are fixed, and that that we will
only consider variations of \( x \) between the boundaries. The dependence
on the derivative, \( \dot{x}=dx/dt \), is crucial because otherwise the
solution would involve simply finding the one value of \( x \) that
minimized \( {\cal L} \), and \( x(t) \) would equal a constant if there were no
explicit \( t \) dependence. Furthermore, \( x \) wouldn't need to be
continuous at the boundary.
</p>

<!-- !split -->
<h2 id="variational-calculus-general-action" class="anchor">Variational Calculus, general Action </h2>

<p>In the general case we have an integral of the type</p>
$$ 
S[q]= \int_{t_1}^{t_2} {\cal L}(q(t),\dot{q}(t),t)dt,
$$

<p>where \( S \) is the quantity which is sought minimized or maximized.  The
problem is that although \( {\cal L} \)  is a function of the general variables
\( q(t),\dot{q}(t),t \) (note our change of variables), the exact dependence of \( q \) on \( t \) is not known.
This means again that even though the integral has fixed limits \( t_1 \)
and \( t_2 \), the path of integration is not known. In our case the unknown
quantities are the positions and general velocities of a given number
of objects and we wish to choose an integration path which makes the
functional \( S[q] \) stationary. This means that we want to find minima,
or maxima or saddle points. In physics we search normally for minima.
Our task is therefore to find the minimum of \( S[q] \) so that its
variation \( \delta S \) is zero subject to specific constraints.  The
constraints can be treated via the technique of Lagrangian multipliers
as we will see below.
</p>

<!-- !split -->
<h2 id="variational-calculus-optimal-path" class="anchor">Variational Calculus, Optimal Path </h2>

<p>We assume the existence of an optimum path, that is a path for which
\( S[q] \) is stationary. There are infinitely many such paths.  The
difference between two paths \( \delta q \) is called the variation of
\( q \).
</p>

<p>We call the variation \( \eta(t) \) and it is scaled by a factor \( \alpha \).
The function \( \eta(t) \) is arbitrary except for
</p>

$$
\eta(t_1)=\eta(t_2)=0,
$$

<p>and we assume that we can model the change in \( q \) as</p>

$$
q(t,\alpha) = q(t)+\alpha\eta(t),
$$

<p>and</p>

$$
\delta q = q(t,\alpha) -q(t,0)=\alpha\eta(t).
$$


<!-- !split -->
<h2 id="variational-calculus-condition-for-an-extreme-value" class="anchor">Variational Calculus, Condition for an Extreme Value </h2>

<p>We choose \( q(t,\alpha=0) \) as the unkonwn path  that will minimize \( S \).  The value
\( q(t,\alpha\ne 0) \)  describes a neighbouring path.
</p>

<p>We have</p>

$$
S[q(\alpha)]= \int_{t_1}^{t_2} {\cal L}(q(t,\alpha),\dot{q}(t,\alpha),t)dt.
$$

<p>The condition for an extreme of</p>

$$
S[q(\alpha)]= \int_{t_1}^{t_2} {\cal L}(q(t,\alpha),\dot{q}(t,\alpha),t)dt,
$$

<p>is</p>

$$
\left[\frac{\partial  S[q(\alpha)]}{\partial t}\right]_{\alpha=0} =0.
$$


<!-- !split -->
<h2 id="variational-calculus-alpha-dependence" class="anchor">Variational Calculus. \( \alpha \) Dependence </h2>

<p>The \( \alpha \) dependence is contained in \( q(t,\alpha) \) and \( \dot{q}(t,\alpha) \) meaning that</p>

$$
\left[\frac{\partial  E[q(\alpha)]}{\partial \alpha}\right]=\int_{t_1}^{t_2} \left( \frac{\partial {\cal l}}{\partial q}\frac{\partial q}{\partial \alpha}+\frac{\partial {\cal L}}{\partial \dot{q}}\frac{\partial \dot{q}}{\partial \alpha}\right)dt.
$$

<p>We have defined</p>

$$
\frac{\partial q(x,\alpha)}{\partial \alpha}=\eta(x)
$$

<p>and thereby</p>

$$
\frac{\partial \dot{q}(t,\alpha)}{\partial \alpha}=\frac{d(\eta(t))}{dt}.
$$


<!-- !split -->
<h2 id="integrating-by-parts" class="anchor">Integrating by Parts </h2>

<p>Using</p>

$$
\frac{\partial q(t,\alpha)}{\partial \alpha}=\eta(t),
$$

<p>and</p>

$$
\frac{\partial \dot{q}(t,\alpha)}{\partial \alpha}=\frac{d(\eta(t))}{dt},
$$

<p>in the integral gives</p>

$$
\left[\frac{\partial  S[q(\alpha)]}{\partial \alpha}\right]=\int_{t_1}^{t_2} \left( \frac{\partial {\cal L}}{\partial q}\eta(t)+\frac{\partial {\cal L}}{\partial \dot{q}}\frac{d(\eta(t))}{dt}\right)dt.
$$

<p>Integrating the second term by parts</p>

$$
\int_{t_1}^{t_2} \frac{\partial {\cal L}}{\partial \dot{q}}\frac{d(\eta(t))}{dt}dt =\eta(t)\frac{\partial {\cal L}}{\partial \dot{q}}|_{t_1}^{t_2}-
\int_a^b \eta(t)\frac{d}{dx}\frac{\partial {\cal L}}{\partial \dot{q}}dt,
$$

<p>and since the first term dissappears due to \( \eta(a)=\eta(b)=0 \), we obtain</p>

$$
\left[\frac{\partial  S[q(\alpha)]}{\partial \alpha}\right]=\int_{t_1}^{t_2} \left( \frac{\partial {\cal L}}{\partial q}-\frac{d}{dx}\frac{\partial {\cal L}}{\partial \dot{q}}
\right)\eta(t)dt=0.
$$


<!-- !split -->
<h2 id="euler-lagrange-equations" class="anchor">Euler-Lagrange Equations </h2>

<p>The latter can be written as</p>

$$
\left[\frac{\partial  S[q(\alpha)]}{\partial \alpha}\right]_{\alpha=0}=\int_{t_1}^{t_2} \left( \frac{\partial {\cal L}}{\partial q}-\frac{d}{\
dx}\frac{\partial {\cal L}}{\partial \dot{q}}\right)\delta q(t)dt=\delta S = 0.
$$

<p>The condition for a stationary value is thus a partial differential equation</p>

$$
\frac{\partial {\cal L}}{\partial q}-\frac{d}{dx}\frac{\partial {\cal L}}{\partial \dot{q}}=0,
$$

<p>known as the <b>Euler-Lagrange</b> equation.</p>

<!-- !split -->
<h2 id="why-is-the-lagrangian-defined-as-the-difference-between-kinetic-and-potential-energy" class="anchor">Why is the Lagrangian defined as the difference between kinetic and potential energy? </h2>

<p>To understand this let us develop some intuition before the math by looking at what we did in the second midterm. There we studied energy conservation.</p>


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;"><span style="color: #408080; font-style: italic"># let&#39;s start by importing useful packages we are familiar with</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">seaborn</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">sns</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">math</span> 

<span style="color: #408080; font-style: italic">#Velocity-Verlet Method</span>
DeltaT <span style="color: #666666">=</span> <span style="color: #666666">0.001</span>
<span style="color: #408080; font-style: italic">#set up arrays </span>
tfinal <span style="color: #666666">=</span> <span style="color: #666666">10</span> <span style="color: #408080; font-style: italic"># in years</span>
n <span style="color: #666666">=</span> ceil(tfinal<span style="color: #666666">/</span>DeltaT)
<span style="color: #408080; font-style: italic"># set up arrays for time t, velocity v, and position r</span>
t <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(n)
v <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((n,<span style="color: #666666">2</span>))
r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((n,<span style="color: #666666">2</span>))
<span style="color: #408080; font-style: italic"># Initial conditions as compact 2-dimensional arrays. Here: circular orbit conditions.</span>
r0 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array([<span style="color: #666666">1.0</span>,<span style="color: #666666">0.0</span>])
v0 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array([<span style="color: #666666">0.0</span>,<span style="color: #666666">5.0</span>])
r[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> r0
v[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> v0
Fourpi2 <span style="color: #666666">=</span> <span style="color: #666666">4*</span>pi<span style="color: #666666">*</span>pi
<span style="color: #408080; font-style: italic"># Start integrating using the Velocity-Verlet method</span>
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(n<span style="color: #666666">-1</span>):
    <span style="color: #408080; font-style: italic"># Set up the accelerationn</span>
    rabs <span style="color: #666666">=</span> sqrt(<span style="color: #008000">sum</span>(r[i]<span style="color: #666666">*</span>r[i]))
    a <span style="color: #666666">=</span> <span style="color: #666666">-</span>Fourpi2<span style="color: #666666">*</span>r[i]<span style="color: #666666">/</span>(rabs<span style="color: #666666">**3</span>)
    <span style="color: #408080; font-style: italic"># update velocity, time and position using the Velocity-Verlet  method</span>
    r[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> r[i] <span style="color: #666666">+</span> DeltaT<span style="color: #666666">*</span>v[i] <span style="color: #666666">+</span> ((DeltaT<span style="color: #666666">**2</span>)<span style="color: #666666">/2</span>)<span style="color: #666666">*</span>(a)
    rabs <span style="color: #666666">=</span> sqrt(<span style="color: #008000">sum</span>(r[i<span style="color: #666666">+1</span>]<span style="color: #666666">*</span>r[i<span style="color: #666666">+1</span>]))
    anew <span style="color: #666666">=</span> <span style="color: #666666">-4*</span>(pi<span style="color: #666666">**2</span>)<span style="color: #666666">*</span>r[i<span style="color: #666666">+1</span>]<span style="color: #666666">/</span>(rabs<span style="color: #666666">**3</span>)
    v[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> v[i] <span style="color: #666666">+</span> DeltaT<span style="color: #666666">*</span>(<span style="color: #666666">0.5</span>)<span style="color: #666666">*</span>(a <span style="color: #666666">+</span> anew)
    t[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> t[i] <span style="color: #666666">+</span> DeltaT
sns<span style="color: #666666">.</span>set()
plt<span style="color: #666666">.</span>plot(r[:,<span style="color: #666666">0</span>], r[:,<span style="color: #666666">1</span>])


<span style="color: #408080; font-style: italic"># We check that the total energy is conserved. For a circular orbit, potential and kinetic energy do not change since the radius is a constant. </span>

<span style="color: #408080; font-style: italic"># Note that we have set the mass of the Earth = 1</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">kinetic_energy</span>(v):
    KE <span style="color: #666666">=</span> []
    step <span style="color: #666666">=</span> <span style="color: #008000">len</span>(t)
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(step):
        KE<span style="color: #666666">.</span>append(<span style="color: #666666">0</span>)
        KE[i] <span style="color: #666666">+=</span> <span style="color: #666666">0.5</span> <span style="color: #666666">*</span>np<span style="color: #666666">.</span>sum(v[i]<span style="color: #666666">*</span>v[i])
    <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>array(KE)


<span style="color: #408080; font-style: italic"># Note that G x Mass_sun = 4*pi*pi and the mass of the Earth = 1</span>
<span style="color: #408080; font-style: italic"># Note also that if you change the exponent in the force you need also to change the potential energy!</span>
<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">pot</span>():
    Pot <span style="color: #666666">=</span> []
    step <span style="color: #666666">=</span> <span style="color: #008000">len</span>(t)
    <span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(step):
        Pot<span style="color: #666666">.</span>append(<span style="color: #666666">0</span>)
        Pot[i] <span style="color: #666666">+=</span>  <span style="color: #666666">-</span> <span style="color: #666666">4*</span>pi<span style="color: #666666">*</span>pi<span style="color: #666666">/</span> sqrt(np<span style="color: #666666">.</span>sum(r[i]<span style="color: #666666">*</span>r[i]))
    <span style="color: #008000; font-weight: bold">return</span> np<span style="color: #666666">.</span>array(Pot)

fig, ax <span style="color: #666666">=</span> plt<span style="color: #666666">.</span>subplots(<span style="color: #666666">1</span>,<span style="color: #666666">1</span>,figsize<span style="color: #666666">=</span>(<span style="color: #666666">12</span>,<span style="color: #666666">6</span>))
ax<span style="color: #666666">.</span>plot(t,kinetic_energy(v)<span style="color: #666666">+</span>pot(),label<span style="color: #666666">=</span><span style="color: #BA2121">&#39;Total&#39;</span>)
ax<span style="color: #666666">.</span>plot(t,kinetic_energy(v),label<span style="color: #666666">=</span><span style="color: #BA2121">&#39;Kinetic&#39;</span>)
ax<span style="color: #666666">.</span>plot(t,pot(),label<span style="color: #666666">=</span><span style="color: #BA2121">&#39;Potential&#39;</span>)
ax<span style="color: #666666">.</span>set_title(<span style="color: #BA2121">&#39;Energy vs time&#39;</span>)
ax<span style="color: #666666">.</span>set_xlabel(<span style="color: #BA2121">&#39;t [yr]&#39;</span>)
ax<span style="color: #666666">.</span>legend()
ax<span style="color: #666666">.</span>set_ylabel(<span style="color: #BA2121">r&#39;E&#39;</span>)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>The energy is conserved and does not say much about the variations in position and velocity as functions of time.</p>

<!-- !split -->
<h2 id="what-if-we-plot-the-difference-between-kinetic-and-potential-energy-instead" class="anchor">What if we plot the difference between kinetic and potential energy instead? </h2>


<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #f8f8f8">
  <pre style="line-height: 125%;">fig, ax <span style="color: #666666">=</span> plt<span style="color: #666666">.</span>subplots(<span style="color: #666666">1</span>,<span style="color: #666666">1</span>,figsize<span style="color: #666666">=</span>(<span style="color: #666666">12</span>,<span style="color: #666666">6</span>))
ax<span style="color: #666666">.</span>plot(t,kinetic_energy(v)<span style="color: #666666">-</span>pot(),label<span style="color: #666666">=</span><span style="color: #BA2121">&#39;L=K-V&#39;</span>)
ax<span style="color: #666666">.</span>plot(t,kinetic_energy(v),label<span style="color: #666666">=</span><span style="color: #BA2121">&#39;Kinetic&#39;</span>)
ax<span style="color: #666666">.</span>plot(t,pot(),label<span style="color: #666666">=</span><span style="color: #BA2121">&#39;Potential&#39;</span>)
ax<span style="color: #666666">.</span>set_title(<span style="color: #BA2121">&#39;Energy vs time&#39;</span>)
ax<span style="color: #666666">.</span>set_xlabel(<span style="color: #BA2121">&#39;t [yr]&#39;</span>)
ax<span style="color: #666666">.</span>legend()
ax<span style="color: #666666">.</span>set_ylabel(<span style="color: #BA2121">r&#39;E&#39;</span>)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>


<!-- ------------------- end of main content --------------- -->
</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>
<!-- Bootstrap footer
<footer>
<a href="https://..."><img width="250" align=right src="https://..."></a>
</footer>
-->
</body>
</html>

