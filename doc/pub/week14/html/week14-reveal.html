<!--
HTML file automatically generated from DocOnce source
(https://github.com/doconce/doconce/)
doconce format html week14-reveal.html week14-reveal reveal --html_slide_theme=beige
-->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="PHY321: Variational calculus">
<title>PHY321: Variational calculus</title>

<!-- reveal.js: https://lab.hakim.se/reveal-js/ -->

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/beige.css" id="theme">
<!--
<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/beige.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/beigesmall.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/solarized.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/serif.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/night.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/moon.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/sky.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/darkgray.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/default.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/cbc.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simula.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/black.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/white.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/league.css" id="theme">
-->

<!-- For syntax highlighting -->
<link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

<!-- Printing and PDF exports -->
<script>
var link = document.createElement( 'link' );
link.rel = 'stylesheet';
link.type = 'text/css';
link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
document.getElementsByTagName( 'head' )[0].appendChild( link );
</script>

<style type="text/css">
hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-size: 60%; font-style: italic; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
.reveal .alert-text-small   { font-size: 80%;  }
.reveal .alert-text-large   { font-size: 130%; }
.reveal .alert-text-normal  { font-size: 90%;  }
.reveal .alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:5px solid #bababa;
  -webkit-border-radius: 14px; -moz-border-radius: 14px;
  border-radius:14px;
  background-position: 10px 10px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 30px; /* 55px; if icon */
}
.reveal .alert-block {padding-top:14px; padding-bottom:14px}
.reveal .alert-block > p, .alert-block > ul {margin-bottom:1em}
/*.reveal .alert li {margin-top: 1em}*/
.reveal .alert-block p+p {margin-top:5px}
/*.reveal .alert-notice { background-image: url(https://hplgit.github.io/doconce/bundled/html_images/small_gray_notice.png); }
.reveal .alert-summary  { background-image:url(https://hplgit.github.io/doconce/bundled/html_images/small_gray_summary.png); }
.reveal .alert-warning { background-image: url(https://hplgit.github.io/doconce/bundled/html_images/small_gray_warning.png); }
.reveal .alert-question {background-image:url(https://hplgit.github.io/doconce/bundled/html_images/small_gray_question.png); } */
/* Override reveal.js table border */
.reveal table td {
  border: 0;
}

<style type="text/css">
/* Override h1, h2, ... styles */
h1 { font-size: 2.8em; }
h2 { font-size: 1.5em; }
h3 { font-size: 1.4em; }
h4 { font-size: 1.3em; }
h1, h2, h3, h4 { font-weight: bold; line-height: 1.2; }
body { overflow: auto; } /* vertical scrolling */
hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-size: 60%; font-style: italic; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
.slide .alert-text-small   { font-size: 80%;  }
.slide .alert-text-large   { font-size: 130%; }
.slide .alert-text-normal  { font-size: 90%;  }
.slide .alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:5px solid #bababa;
    -webkit-border-radius:14px; -moz-border-radius:14px;
  border-radius:14px
  background-position: 10px 10px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 30px; /* 55px; if icon */
}
.slide .alert-block {padding-top:14px; padding-bottom:14px}
.slide .alert-block > p, .alert-block > ul {margin-bottom:0}
/*.slide .alert li {margin-top: 1em}*/
.deck .alert-block p+p {margin-top:5px}
/*.slide .alert-notice { background-image: url(https://hplgit.github.io/doconce/
bundled/html_images//small_gray_notice.png); }
.slide .alert-summary  { background-image:url(https://hplgit.github.io/doconce/
bundled/html_images//small_gray_summary.png); }
.slide .alert-warning { background-image: url(https://hplgit.github.io/doconce/
bundled/html_images//small_gray_warning.png); }
.slide .alert-question {background-image:url(https://hplgit.github.io/doconce/
bundled/html_images/small_gray_question.png); } */
.dotable table, .dotable th, .dotable tr, .dotable tr td {
  border: 2px solid black;
  border-collapse: collapse;
  padding: 2px;
}
</style>


<!-- Styles for table layout of slides -->
<style type="text/css">
td.padding {
  padding-top:20px;
  padding-bottom:20px;
  padding-right:50px;
  padding-left:50px;
}
</style>

</head>


<body>
<div class="reveal">
<div class="slides">





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>




<section>
<!-- ------------------- main content ---------------------- -->
<center>
<h1 style="text-align: center;">PHY321: Variational calculus</h1>
</center>  <!-- document title -->

<!-- author(s): <a href="http://mhjgit.github.io/info/doc/web/" target="_blank">Morten Hjorth-Jensen</a> -->
<center>
<b><a href="http://mhjgit.github.io/info/doc/web/" target="_blank">Morten Hjorth-Jensen</a></b> [1, 2]
</center>
<!-- institution(s) -->
<center>
[1] <b>Department of Physics and Astronomy and Facility for Rare Isotope Beams (FRIB), Michigan State University, USA</b>
</center>
<center>
[2] <b>Department of Physics, University of Oslo, Norway</b>
</center>
<br>
<center>
<h4>April 10-14</h4>
</center> <!-- date -->
<br>
</section>

<section>
<h2 id="aims-and-overarching-motivation">Aims and Overarching Motivation </h2>
<h3 id="monday-april-10">Monday April 10 </h3>

<ul>
<p><li> Lagrangian formalism, top down approach first and derivation of the Euler-Lagrange equations</li>
<p><li> Principle of Least Action, watch <a href="https://www.feynmanlectures.caltech.edu/II_19.html" target="_blank">Feynman Lecture</a>.</li>
<p><li> <a href="https://youtu.be/Sfkdnq9JKB8" target="_blank">Video of lecture</a></li>
<p><li> <a href="https://github.com/mhjensen/Physics321/blob/master/doc/HandWrittenNotes/Spring2023/NotesApril10.pdf" target="_blank">Handwritten notes</a></li>
</ul>
<p>
<p><b>Reading suggestion this week</b>: Taylor sections 6.1-6.4</p>
<h3 id="wednesday-april-12">Wednesday April 12 </h3>

<ul>
<p><li> Euler-Lagrange equations and the Lagrangian with examples</li>
<p><li> Principle of Least Action, watch <a href="https://www.feynmanlectures.caltech.edu/II_19.html" target="_blank">Feynman Lecture</a>.</li>
<p><li> <a href="https://youtu.be/vNKn1HyC9kw" target="_blank">Video of lecture TBA</a></li>
<p><li> <a href="https://github.com/mhjensen/Physics321/blob/master/doc/HandWrittenNotes/Spring2023/NotesApril12.pdf" target="_blank">Handwritten notes</a></li>
</ul>
<p>
<p><b>Reading suggestion</b>: Taylor sections 6.1-6.4</p>

<a href="https://en.wikipedia.org/wiki/Calculus_of_variations" target="_blank">See also Variational Calculus</a>
<h3 id="friday-april-14">Friday April 14 </h3>

<p>Discussion and work on second midterm. </p>
</section>

<section>
<h2 id="variational-calculus">Variational Calculus </h2>

<p>The calculus of variations involves 
problems where the quantity to be minimized or maximized is an integral. 
</p>

<p>The usual minimization problem one faces involves taking a function
\( {\cal L}(x) \), then finding the single value \( x \) for which \( {\cal L} \)
is either a maximum or minimum. In multivariate calculus one also
learns to solve problems where you minimize for multiple variables,
\( {\cal L}(x_1,x_2,\cdots x_n) \), and finding the points \( (x_1\cdots
y_n) \) in an \( n \)-dimensional space that maximize or minimize the
function. Here, we consider what seems to be a much more ambitious
problem. Imagine you have a function \( {\cal L}(x(t),\dot{x}(t),t) \),
and you wish to find the extrema for an infinite number of values of
\( x \), i.e. \( x \) at each point \( t \). The function \( {\cal L} \) will not only
depend on \( x \) at each point \( t \), but also on the slope at each point,
plus an additional dependence on \( t \). Note we are NOT finding an
optimum value of \( t \), we are finding the set of optimum values of \( x \)
at each point \( t \), or equivalently, finding the function \( x(t) \).
</p>
</section>

<section>
<h2 id="variational-calculus-introducing-the-action">Variational Calculus, introducing the action </h2>

<p>One treats the function \( x(t) \) as being unknown while minimizing the action</p>

<p>&nbsp;<br>
$$
S=\int_{t_1}^{t_2}dt~{\cal L}(x(t),\dot{x}(t),t).
$$
<p>&nbsp;<br>

<p>Thus, we are minimizing \( S \) with respect to an infinite number of
values of \( x(t_i) \) at points \( t_i \). As an additional criteria, we will
assume that \( x(t_1) \) and \( x(t_2) \) are fixed, and that that we will
only consider variations of \( x \) between the boundaries. The dependence
on the derivative, \( \dot{x}=dx/dt \), is crucial because otherwise the
solution would involve simply finding the one value of \( x \) that
minimized \( {\cal L} \), and \( x(t) \) would equal a constant if there were no
explicit \( t \) dependence. Furthermore, \( x \) wouldn't need to be
continuous at the boundary.
</p>
</section>

<section>
<h2 id="variational-calculus-general-action">Variational Calculus, general Action </h2>

<p>In the general case we have an integral of the type</p>
<p>&nbsp;<br>
$$ 
S[q]= \int_{t_1}^{t_2} {\cal L}(q(t),\dot{q}(t),t)dt,
$$
<p>&nbsp;<br>

<p>where \( S \) is the quantity which is sought minimized or maximized.  The
problem is that although \( {\cal L} \)  is a function of the general variables
\( q(t),\dot{q}(t),t \) (note our change of variables), the exact dependence of \( q \) on \( t \) is not known.
This means again that even though the integral has fixed limits \( t_1 \)
and \( t_2 \), the path of integration is not known. In our case the unknown
quantities are the positions and general velocities of a given number
of objects and we wish to choose an integration path which makes the
functional \( S[q] \) stationary. This means that we want to find minima,
or maxima or saddle points. In physics we search normally for minima.
Our task is therefore to find the minimum of \( S[q] \) so that its
variation \( \delta S \) is zero subject to specific constraints.  The
constraints can be treated via the technique of Lagrangian multipliers
as we will see below.
</p>
</section>

<section>
<h2 id="variational-calculus-optimal-path">Variational Calculus, Optimal Path </h2>

<p>We assume the existence of an optimum path, that is a path for which
\( S[q] \) is stationary. There are infinitely many such paths.  The
difference between two paths \( \delta q \) is called the variation of
\( q \).
</p>

<p>We call the variation \( \eta(t) \) and it is scaled by a factor \( \alpha \).
The function \( \eta(t) \) is arbitrary except for
</p>

<p>&nbsp;<br>
$$
\eta(t_1)=\eta(t_2)=0,
$$
<p>&nbsp;<br>

<p>and we assume that we can model the change in \( q \) as</p>

<p>&nbsp;<br>
$$
q(t,\alpha) = q(t)+\alpha\eta(t),
$$
<p>&nbsp;<br>

<p>and</p>

<p>&nbsp;<br>
$$
\delta q = q(t,\alpha) -q(t,0)=\alpha\eta(t).
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="variational-calculus-condition-for-an-extreme-value">Variational Calculus, Condition for an Extreme Value </h2>

<p>We choose \( q(t,\alpha=0) \) as the unkonwn path  that will minimize \( S \).  The value
\( q(t,\alpha\ne 0) \)  describes a neighbouring path.
</p>

<p>We have</p>

<p>&nbsp;<br>
$$
S[q(\alpha)]= \int_{t_1}^{t_2} {\cal L}(q(t,\alpha),\dot{q}(t,\alpha),t)dt.
$$
<p>&nbsp;<br>

<p>The condition for an extreme of</p>

<p>&nbsp;<br>
$$
S[q(\alpha)]= \int_{t_1}^{t_2} {\cal L}(q(t,\alpha),\dot{q}(t,\alpha),t)dt,
$$
<p>&nbsp;<br>

<p>is</p>

<p>&nbsp;<br>
$$
\left[\frac{\partial  S[q(\alpha)]}{\partial t}\right]_{\alpha=0} =0.
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="variational-calculus-alpha-dependence">Variational Calculus. \( \alpha \) Dependence </h2>

<p>The \( \alpha \) dependence is contained in \( q(t,\alpha) \) and \( \dot{q}(t,\alpha) \) meaning that</p>

<p>&nbsp;<br>
$$
\left[\frac{\partial  E[q(\alpha)]}{\partial \alpha}\right]=\int_{t_1}^{t_2} \left( \frac{\partial {\cal l}}{\partial q}\frac{\partial q}{\partial \alpha}+\frac{\partial {\cal L}}{\partial \dot{q}}\frac{\partial \dot{q}}{\partial \alpha}\right)dt.
$$
<p>&nbsp;<br>

<p>We have defined</p>

<p>&nbsp;<br>
$$
\frac{\partial q(x,\alpha)}{\partial \alpha}=\eta(x)
$$
<p>&nbsp;<br>

<p>and thereby</p>

<p>&nbsp;<br>
$$
\frac{\partial \dot{q}(t,\alpha)}{\partial \alpha}=\frac{d(\eta(t))}{dt}.
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="integrating-by-parts">Integrating by Parts </h2>

<p>Using</p>

<p>&nbsp;<br>
$$
\frac{\partial q(t,\alpha)}{\partial \alpha}=\eta(t),
$$
<p>&nbsp;<br>

<p>and</p>

<p>&nbsp;<br>
$$
\frac{\partial \dot{q}(t,\alpha)}{\partial \alpha}=\frac{d(\eta(t))}{dt},
$$
<p>&nbsp;<br>

<p>in the integral gives</p>

<p>&nbsp;<br>
$$
\left[\frac{\partial  S[q(\alpha)]}{\partial \alpha}\right]=\int_{t_1}^{t_2} \left( \frac{\partial {\cal L}}{\partial q}\eta(t)+\frac{\partial {\cal L}}{\partial \dot{q}}\frac{d(\eta(t))}{dt}\right)dt.
$$
<p>&nbsp;<br>

<p>Integrating the second term by parts</p>

<p>&nbsp;<br>
$$
\int_{t_1}^{t_2} \frac{\partial {\cal L}}{\partial \dot{q}}\frac{d(\eta(t))}{dt}dt =\eta(t)\frac{\partial {\cal L}}{\partial \dot{q}}|_{t_1}^{t_2}-
\int_a^b \eta(t)\frac{d}{dx}\frac{\partial {\cal L}}{\partial \dot{q}}dt,
$$
<p>&nbsp;<br>

<p>and since the first term dissappears due to \( \eta(a)=\eta(b)=0 \), we obtain</p>

<p>&nbsp;<br>
$$
\left[\frac{\partial  S[q(\alpha)]}{\partial \alpha}\right]=\int_{t_1}^{t_2} \left( \frac{\partial {\cal L}}{\partial q}-\frac{d}{dx}\frac{\partial {\cal L}}{\partial \dot{q}}
\right)\eta(t)dt=0.
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="euler-lagrange-equations">Euler-Lagrange Equations </h2>

<p>The latter can be written as</p>

<p>&nbsp;<br>
$$
\left[\frac{\partial  S[q(\alpha)]}{\partial \alpha}\right]_{\alpha=0}=\int_{t_1}^{t_2} \left( \frac{\partial {\cal L}}{\partial q}-\frac{d}{\
dx}\frac{\partial {\cal L}}{\partial \dot{q}}\right)\delta q(t)dt=\delta S = 0.
$$
<p>&nbsp;<br>

<p>The condition for a stationary value is thus a partial differential equation</p>

<p>&nbsp;<br>
$$
\frac{\partial {\cal L}}{\partial q}-\frac{d}{dx}\frac{\partial {\cal L}}{\partial \dot{q}}=0,
$$
<p>&nbsp;<br>

<p>known as the <b>Euler-Lagrange</b> equation.</p>
</section>

<section>
<h2 id="why-is-the-lagrangian-defined-as-the-difference-between-kinetic-and-potential-energy">Why is the Lagrangian defined as the difference between kinetic and potential energy? </h2>

<p>To understand this let us develop some intuition before the math by looking at what we did in the second midterm. There we studied energy conservation.</p>


<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #eeeedd">
  <pre style="font-size: 80%; line-height: 125%;"><span style="color: #228B22"># let&#39;s start by importing useful packages we are familiar with</span>
<span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">numpy</span> <span style="color: #8B008B; font-weight: bold">as</span> <span style="color: #008b45; text-decoration: underline">np</span>
<span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">math</span> <span style="color: #8B008B; font-weight: bold">import</span> *
<span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">matplotlib.pyplot</span> <span style="color: #8B008B; font-weight: bold">as</span> <span style="color: #008b45; text-decoration: underline">plt</span>
<span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">seaborn</span> <span style="color: #8B008B; font-weight: bold">as</span> <span style="color: #008b45; text-decoration: underline">sns</span>
<span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">math</span> 

<span style="color: #228B22">#Velocity-Verlet Method</span>
DeltaT = <span style="color: #B452CD">0.001</span>
<span style="color: #228B22">#set up arrays </span>
tfinal = <span style="color: #B452CD">10</span> <span style="color: #228B22"># in years</span>
n = ceil(tfinal/DeltaT)
<span style="color: #228B22"># set up arrays for time t, velocity v, and position r</span>
t = np.zeros(n)
v = np.zeros((n,<span style="color: #B452CD">2</span>))
r = np.zeros((n,<span style="color: #B452CD">2</span>))
<span style="color: #228B22"># Initial conditions as compact 2-dimensional arrays. Here: circular orbit conditions.</span>
r0 = np.array([<span style="color: #B452CD">1.0</span>,<span style="color: #B452CD">0.0</span>])
v0 = np.array([<span style="color: #B452CD">0.0</span>,<span style="color: #B452CD">5.0</span>])
r[<span style="color: #B452CD">0</span>] = r0
v[<span style="color: #B452CD">0</span>] = v0
Fourpi2 = <span style="color: #B452CD">4</span>*pi*pi
<span style="color: #228B22"># Start integrating using the Velocity-Verlet method</span>
<span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> <span style="color: #658b00">range</span>(n-<span style="color: #B452CD">1</span>):
    <span style="color: #228B22"># Set up the accelerationn</span>
    rabs = sqrt(<span style="color: #658b00">sum</span>(r[i]*r[i]))
    a = -Fourpi2*r[i]/(rabs**<span style="color: #B452CD">3</span>)
    <span style="color: #228B22"># update velocity, time and position using the Velocity-Verlet  method</span>
    r[i+<span style="color: #B452CD">1</span>] = r[i] + DeltaT*v[i] + ((DeltaT**<span style="color: #B452CD">2</span>)/<span style="color: #B452CD">2</span>)*(a)
    rabs = sqrt(<span style="color: #658b00">sum</span>(r[i+<span style="color: #B452CD">1</span>]*r[i+<span style="color: #B452CD">1</span>]))
    anew = -<span style="color: #B452CD">4</span>*(pi**<span style="color: #B452CD">2</span>)*r[i+<span style="color: #B452CD">1</span>]/(rabs**<span style="color: #B452CD">3</span>)
    v[i+<span style="color: #B452CD">1</span>] = v[i] + DeltaT*(<span style="color: #B452CD">0.5</span>)*(a + anew)
    t[i+<span style="color: #B452CD">1</span>] = t[i] + DeltaT
sns.set()
plt.plot(r[:,<span style="color: #B452CD">0</span>], r[:,<span style="color: #B452CD">1</span>])


<span style="color: #228B22"># We check that the total energy is conserved. For a circular orbit, potential and kinetic energy do not change since the radius is a constant. </span>

<span style="color: #228B22"># Note that we have set the mass of the Earth = 1</span>
<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">kinetic_energy</span>(v):
    KE = []
    step = <span style="color: #658b00">len</span>(t)
    <span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> <span style="color: #658b00">range</span>(step):
        KE.append(<span style="color: #B452CD">0</span>)
        KE[i] += <span style="color: #B452CD">0.5</span> *np.sum(v[i]*v[i])
    <span style="color: #8B008B; font-weight: bold">return</span> np.array(KE)


<span style="color: #228B22"># Note that G x Mass_sun = 4*pi*pi and the mass of the Earth = 1</span>
<span style="color: #228B22"># Note also that if you change the exponent in the force you need also to change the potential energy!</span>
<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">pot</span>():
    Pot = []
    step = <span style="color: #658b00">len</span>(t)
    <span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> <span style="color: #658b00">range</span>(step):
        Pot.append(<span style="color: #B452CD">0</span>)
        Pot[i] +=  - <span style="color: #B452CD">4</span>*pi*pi/ sqrt(np.sum(r[i]*r[i]))
    <span style="color: #8B008B; font-weight: bold">return</span> np.array(Pot)

fig, ax = plt.subplots(<span style="color: #B452CD">1</span>,<span style="color: #B452CD">1</span>,figsize=(<span style="color: #B452CD">12</span>,<span style="color: #B452CD">6</span>))
ax.plot(t,kinetic_energy(v)+pot(),label=<span style="color: #CD5555">&#39;Total&#39;</span>)
ax.plot(t,kinetic_energy(v),label=<span style="color: #CD5555">&#39;Kinetic&#39;</span>)
ax.plot(t,pot(),label=<span style="color: #CD5555">&#39;Potential&#39;</span>)
ax.set_title(<span style="color: #CD5555">&#39;Energy vs time&#39;</span>)
ax.set_xlabel(<span style="color: #CD5555">&#39;t [yr]&#39;</span>)
ax.legend()
ax.set_ylabel(<span style="color: #CD5555">r&#39;E&#39;</span>)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>The energy is conserved and does not say much about the variations in position and velocity as functions of time.</p>
</section>

<section>
<h2 id="what-if-we-plot-the-difference-between-kinetic-and-potential-energy-instead">What if we plot the difference between kinetic and potential energy instead? </h2>


<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #eeeedd">
  <pre style="font-size: 80%; line-height: 125%;">fig, ax = plt.subplots(<span style="color: #B452CD">1</span>,<span style="color: #B452CD">1</span>,figsize=(<span style="color: #B452CD">12</span>,<span style="color: #B452CD">6</span>))
ax.plot(t,kinetic_energy(v)-pot(),label=<span style="color: #CD5555">&#39;L=K-V&#39;</span>)
ax.plot(t,kinetic_energy(v),label=<span style="color: #CD5555">&#39;Kinetic&#39;</span>)
ax.plot(t,pot(),label=<span style="color: #CD5555">&#39;Potential&#39;</span>)
ax.set_title(<span style="color: #CD5555">&#39;Energy vs time&#39;</span>)
ax.set_xlabel(<span style="color: #CD5555">&#39;t [yr]&#39;</span>)
ax.legend()
ax.set_ylabel(<span style="color: #CD5555">r&#39;E&#39;</span>)
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
</section>



</div> <!-- class="slides" -->
</div> <!-- class="reveal" -->

<script src="reveal.js/lib/js/head.min.js"></script>
<script src="reveal.js/js/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

  // Display navigation controls in the bottom right corner
  controls: true,

  // Display progress bar (below the horiz. slider)
  progress: true,

  // Display the page number of the current slide
  slideNumber: true,

  // Push each slide change to the browser history
  history: false,

  // Enable keyboard shortcuts for navigation
  keyboard: true,

  // Enable the slide overview mode
  overview: true,

  // Vertical centering of slides
  //center: true,
  center: false,

  // Enables touch navigation on devices with touch input
  touch: true,

  // Loop the presentation
  loop: false,

  // Change the presentation direction to be RTL
  rtl: false,

  // Turns fragments on and off globally
  fragments: true,

  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,

  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,

  // Stop auto-sliding after user input
  autoSlideStoppable: true,

  // Enable slide navigation via mouse wheel
  mouseWheel: false,

  // Hides the address bar on mobile devices
  hideAddressBar: true,

  // Opens links in an iframe preview overlay
  previewLinks: false,

  // Transition style
  transition: 'default', // default/cube/page/concave/zoom/linear/fade/none

  // Transition speed
  transitionSpeed: 'default', // default/fast/slow

  // Transition style for full page slide backgrounds
  backgroundTransition: 'default', // default/none/slide/concave/convex/zoom

  // Number of slides away from the current that are visible
  viewDistance: 3,

  // Parallax background image
    //parallaxBackgroundImage: '', // e.g. "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'"

  // Parallax background size
  //parallaxBackgroundSize: '' // CSS syntax, e.g. "2100px 900px"

  theme: Reveal.getQueryHash().theme, // available themes are in reveal.js/css/theme
    transition: Reveal.getQueryHash().transition || 'none', // default/cube/page/concave/zoom/linear/none

});

Reveal.initialize({
  dependencies: [
      // Cross-browser shim that fully implements classList - https://github.com/eligrey/classList.js/
      { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },

      // Interpret Markdown in <section> elements
      { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },

      // Syntax highlight for <code> elements
      { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },

      // Zoom in and out with Alt+click
      { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },

      // Speaker notes
      { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },

      // Remote control your reveal.js presentation using a touch device
      //{ src: 'reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } },

      // MathJax
      //{ src: 'reveal.js/plugin/math/math.js', async: true }
  ]
});

Reveal.initialize({

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 1170,  // original: 960,
  height: 700,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.0

});
</script>

<!-- begin footer logo
<div style="position: absolute; bottom: 0px; left: 0; margin-left: 0px">
<img src="somelogo.png">
</div>
   end footer logo -->




</body>
</html>
