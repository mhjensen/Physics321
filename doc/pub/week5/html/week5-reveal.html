<!--
HTML file automatically generated from DocOnce source
(https://github.com/doconce/doconce/)
doconce format html week5-reveal.html week5-reveal reveal --html_slide_theme=beige
-->
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="PHY321: Work and Energy  and Conservation Theorems">
<title>PHY321: Work and Energy  and Conservation Theorems</title>

<!-- reveal.js: https://lab.hakim.se/reveal-js/ -->

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/beige.css" id="theme">
<!--
<link rel="stylesheet" href="reveal.js/css/reveal.css">
<link rel="stylesheet" href="reveal.js/css/theme/beige.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/beigesmall.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/solarized.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/serif.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/night.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/moon.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simple.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/sky.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/darkgray.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/default.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/cbc.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/simula.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/black.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/white.css" id="theme">
<link rel="stylesheet" href="reveal.js/css/theme/league.css" id="theme">
-->

<!-- For syntax highlighting -->
<link rel="stylesheet" href="reveal.js/lib/css/zenburn.css">

<!-- Printing and PDF exports -->
<script>
var link = document.createElement( 'link' );
link.rel = 'stylesheet';
link.type = 'text/css';
link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
document.getElementsByTagName( 'head' )[0].appendChild( link );
</script>

<style type="text/css">
hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-size: 60%; font-style: italic; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
.reveal .alert-text-small   { font-size: 80%;  }
.reveal .alert-text-large   { font-size: 130%; }
.reveal .alert-text-normal  { font-size: 90%;  }
.reveal .alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:5px solid #bababa;
  -webkit-border-radius: 14px; -moz-border-radius: 14px;
  border-radius:14px;
  background-position: 10px 10px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 30px; /* 55px; if icon */
}
.reveal .alert-block {padding-top:14px; padding-bottom:14px}
.reveal .alert-block > p, .alert-block > ul {margin-bottom:1em}
/*.reveal .alert li {margin-top: 1em}*/
.reveal .alert-block p+p {margin-top:5px}
/*.reveal .alert-notice { background-image: url(https://hplgit.github.io/doconce/bundled/html_images/small_gray_notice.png); }
.reveal .alert-summary  { background-image:url(https://hplgit.github.io/doconce/bundled/html_images/small_gray_summary.png); }
.reveal .alert-warning { background-image: url(https://hplgit.github.io/doconce/bundled/html_images/small_gray_warning.png); }
.reveal .alert-question {background-image:url(https://hplgit.github.io/doconce/bundled/html_images/small_gray_question.png); } */
/* Override reveal.js table border */
.reveal table td {
  border: 0;
}

<style type="text/css">
/* Override h1, h2, ... styles */
h1 { font-size: 2.8em; }
h2 { font-size: 1.5em; }
h3 { font-size: 1.4em; }
h4 { font-size: 1.3em; }
h1, h2, h3, h4 { font-weight: bold; line-height: 1.2; }
body { overflow: auto; } /* vertical scrolling */
hr { border: 0; width: 80%; border-bottom: 1px solid #aaa}
p.caption { width: 80%; font-size: 60%; font-style: italic; text-align: left; }
hr.figure { border: 0; width: 80%; border-bottom: 1px solid #aaa}
.slide .alert-text-small   { font-size: 80%;  }
.slide .alert-text-large   { font-size: 130%; }
.slide .alert-text-normal  { font-size: 90%;  }
.slide .alert {
  padding:8px 35px 8px 14px; margin-bottom:18px;
  text-shadow:0 1px 0 rgba(255,255,255,0.5);
  border:5px solid #bababa;
    -webkit-border-radius:14px; -moz-border-radius:14px;
  border-radius:14px
  background-position: 10px 10px;
  background-repeat: no-repeat;
  background-size: 38px;
  padding-left: 30px; /* 55px; if icon */
}
.slide .alert-block {padding-top:14px; padding-bottom:14px}
.slide .alert-block > p, .alert-block > ul {margin-bottom:0}
/*.slide .alert li {margin-top: 1em}*/
.deck .alert-block p+p {margin-top:5px}
/*.slide .alert-notice { background-image: url(https://hplgit.github.io/doconce/
bundled/html_images//small_gray_notice.png); }
.slide .alert-summary  { background-image:url(https://hplgit.github.io/doconce/
bundled/html_images//small_gray_summary.png); }
.slide .alert-warning { background-image: url(https://hplgit.github.io/doconce/
bundled/html_images//small_gray_warning.png); }
.slide .alert-question {background-image:url(https://hplgit.github.io/doconce/
bundled/html_images/small_gray_question.png); } */
.dotable table, .dotable th, .dotable tr, .dotable tr td {
  border: 2px solid black;
  border-collapse: collapse;
  padding: 2px;
}
</style>


<!-- Styles for table layout of slides -->
<style type="text/css">
td.padding {
  padding-top:20px;
  padding-bottom:20px;
  padding-right:50px;
  padding-left:50px;
}
</style>

</head>


<body>
<div class="reveal">
<div class="slides">





<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "none"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>




<section>
<!-- ------------------- main content ---------------------- -->
<center>
<h1 style="text-align: center;">PHY321: Work and Energy  and Conservation Theorems</h1>
</center>  <!-- document title -->

<!-- author(s): <a href="http://mhjgit.github.io/info/doc/web/" target="_blank">Morten Hjorth-Jensen</a> -->
<center>
<b><a href="http://mhjgit.github.io/info/doc/web/" target="_blank">Morten Hjorth-Jensen</a></b> 
</center>
<!-- institution -->
<center>
<b>Department of Physics and Astronomy and Facility for Rare Ion Beams (FRIB), Michigan State University, USA</b>
</center>
<br>
<center>
<h4>Jan 30, 2023</h4>
</center> <!-- date -->
<br>


<center style="font-size:80%">
<!-- copyright --> &copy; 1999-2023, "Morten Hjorth-Jensen":"http://mhjgit.github.io/info/doc/web/". Released under CC Attribution-NonCommercial 4.0 license
</center>
</section>

<section>
<h2 id="plans-for-the-week-january-30-february-3">Plans for the week January 30-February 3 </h2>
<h3 id="monday">Monday </h3>

<p>The work-energy theorem with examples. Discussion of momentum and angular momentum.
Reading suggestion: Taylor sections 3.1-3.4 and 4.1-4.3
</p>

<p>Lecture via zoom only.</p>
<h3 id="wednesday">Wednesday </h3>

<p>Examples and conservation of  angular momentum, Taylor sections 3.4 and 3.5. 
Discussion of exercises 5 and 6. This is also the assignment for Friday's session.
</p>

<p>Lecture via zoom only.</p>
<h3 id="friday">Friday </h3>

<p>Solution of exercises and discussion of homework 3. We focus on  exercises 5 and 6, see end of these slides.</p>

<p>If you wish to read more about conservative forces or not, Feyman's lectures from 1963 are quite interesting.
He states for example that <b>All fundamental forces in nature appear to be conservative</b>.
This statement was made while developing his argument that <em>there are no nonconservative forces</em>.
You may enjoy the link to <a href="http://www.feynmanlectures.caltech.edu/I_14.html" target="_blank">Feynman's lecture</a>.
</p>
</section>

<section>
<h2 id="work-energy-momentum-and-conservation-laws">Work, Energy, Momentum and Conservation laws </h2>

<p>The systems we studied the first three weeks have shown us how to use Newton&#8217;s laws of
motion to determine the motion of an object based on the forces acting
on it. For some of the cases there is an underlying assumption that we can find an analytical solution to a continuous problem.
With a continuous problem we mean a problem where the various variables can take any value within a finite or infinite interval. 
</p>

<p>Unfortunately, in many cases we
cannot find an exact solution to the equations of motion we get from
Newton&#8217;s second law. The numerical approach, where we discretize the continuous problem, allows us however to study a much richer set of problems.
For problems involving Newton's laws and the various equations of motion we encounter, solving the equations numerically, is the standard approach.
</p>

<p>It allows us to focus on the underlying forces. Often we end up using the same numerical algorithm for different problems.</p>

<p>Here we introduce a commonly used technique that allows us to find the
velocity as a function of position without finding the position as a
function of time&#8212;an alternate form of Newton&#8217;s second law. The method
is based on a simple principle: Instead of solving the equations of
motion directly, we integrate the equations of motion. Such a method
is called an integration method. 
</p>

<p>This allows us also to introduce the <b>work-energy</b> theorem. This
theorem allows us to find the velocity as a function of position for
an object even in cases when we cannot solve the equations of
motion. This introduces us to the concept of work and kinetic energy,
an energy related to the motion of an object.
</p>

<p>And finally, we will link the work-energy theorem with the principle of conservation of energy.</p>
</section>

<section>
<h2 id="the-work-energy-theorem">The Work-Energy Theorem </h2>

<p>Let us define the kinetic energy \( K \) with a given velocity \( \boldsymbol{v} \)</p>
<p>&nbsp;<br>
$$
K=\frac{1}{2}mv^2,
$$
<p>&nbsp;<br>

<p>where \( m \) is the mass of the object we are considering.
We assume also that there is a force \( \boldsymbol{F} \) acting on the given object
</p>

<p>&nbsp;<br>
$$
\boldsymbol{F}=\boldsymbol{F}(\boldsymbol{r},\boldsymbol{v},t),
$$
<p>&nbsp;<br>

<p>with \( \boldsymbol{r} \) the position and \( t \) the time.
In general we assume the force is a function of all these variables.
Many of the more central forces in Nature however, depende only on the
position. Examples are the gravitational force and the force derived
from the Coulomb potential in electromagnetism.
</p>
</section>

<section>
<h2 id="rewriting-the-kinetic-energy">Rewriting the Kinetic Energy </h2>

<p>Let us study the derivative of the kinetic energy with respect to time \( t \). Its continuous form is</p>
<p>&nbsp;<br>
$$
\frac{dK}{dt}=\frac{1}{2}m\frac{d\boldsymbol{v}\cdot\boldsymbol{v}}{dt}. 
$$
<p>&nbsp;<br>

<p>Using our results from exercise 3 of homework 1, we can write the derivative of a vector dot product as</p>

<p>&nbsp;<br>
$$
\frac{dK}{dt}=\frac{1}{2}m\frac{d\boldsymbol{v}\cdot\boldsymbol{v}}{dt}= \frac{1}{2}m\left(\frac{d\boldsymbol{v}}{dt}\cdot\boldsymbol{v}+\boldsymbol{v}\cdot\frac{d\boldsymbol{v}}{dt}\right)=m\frac{d\boldsymbol{v}}{dt}\cdot\boldsymbol{v}. 
$$
<p>&nbsp;<br>

<p>We know also that the acceleration is defined as</p>
<p>&nbsp;<br>
$$
\boldsymbol{a}=\frac{\boldsymbol{F}}{m}=\frac{d\boldsymbol{v}}{dt}.
$$
<p>&nbsp;<br>

<p>We can then rewrite the equation for the derivative of the kinetic energy as </p>
<p>&nbsp;<br>
$$
\frac{dK}{dt}=m\frac{d\boldsymbol{v}}{dt}\boldsymbol{v}=\boldsymbol{F}\frac{d\boldsymbol{r}}{dt}, 
$$
<p>&nbsp;<br>

<p>where we defined the velocity as the derivative of the position with respect to time.</p>
</section>

<section>
<h2 id="discretizing">Discretizing </h2>

<p>Let us now discretize the above equation by letting the instantaneous terms be replaced by a discrete quantity, that is
we let \( dK\rightarrow \Delta K \), \( dt\rightarrow \Delta t \), \( d\boldsymbol{r}\rightarrow \Delta \boldsymbol{r} \) and \( d\boldsymbol{v}\rightarrow \Delta \boldsymbol{v} \).
</p>

<p>We have then</p>

<p>&nbsp;<br>
$$
\frac{\Delta K}{\Delta t}=m\frac{\Delta \boldsymbol{v}}{\Delta t}\boldsymbol{v}=\boldsymbol{F}\frac{\Delta \boldsymbol{r}}{\Delta t}, 
$$
<p>&nbsp;<br>

<p>or by multiplying out \( \Delta t \) we have</p>
<p>&nbsp;<br>
$$
\Delta K=\boldsymbol{F}\Delta \boldsymbol{r}. 
$$
<p>&nbsp;<br>

<p>We define this quantity as the <b>work</b> done by the force \( \boldsymbol{F} \)
during the displacement \( \Delta \boldsymbol{r} \). If we study the dimensionality
of this problem we have mass times length squared divided by time
squared, or just dimension energy.
</p>
</section>

<section>
<h2 id="difference-in-kinetic-energy">Difference in kinetic energy </h2>

<p>If we now define a series of such displacements \( \Delta\boldsymbol{r} \) we have a difference in kinetic energy at a final position \( \boldsymbol{r}_n \) and an 
initial position \( \boldsymbol{r}_0 \) given by
</p>
<p>&nbsp;<br>
$$
\Delta K=\frac{1}{2}mv_n^2-\frac{1}{2}mv_0^2=\sum_{i=0}^n\boldsymbol{F}_i\Delta \boldsymbol{r},
$$
<p>&nbsp;<br>

<p>where \( \boldsymbol{F}_i \) are the forces acting at every position \( \boldsymbol{r}_i \).</p>

<p>The work done by acting with a force on a set of displacements can
then be as expressed as the difference between the initial and final
kinetic energies.
</p>

<p>This defines the <b>work-energy</b> theorem.</p>
</section>

<section>
<h2 id="from-the-discrete-version-to-the-continuous-version">From the discrete version to the continuous version </h2>

<p>If we take the limit \( \Delta \boldsymbol{r}\rightarrow 0 \), we can rewrite the sum over the various displacements in terms of an integral, that is</p>
<p>&nbsp;<br>
$$
\Delta K=\frac{1}{2}mv_n^2-\frac{1}{2}mv_0^2=\sum_{i=0}^n\boldsymbol{F}_i\Delta \boldsymbol{r}\rightarrow \int_{\boldsymbol{r}_0}^{\boldsymbol{r}_n}\boldsymbol{F}(\boldsymbol{r},\boldsymbol{v},t)d\boldsymbol{r}.
$$
<p>&nbsp;<br>

<p>This integral defines a path integral since it will depend on the given path we take between the two end points. We will replace the limits with the symbol \( c \) in order to indicate that we take a specific countour in space when the force acts on the system. That is the work \( W_{n0} \) between two points \( \boldsymbol{r}_n \) and \( \boldsymbol{r}_0 \) is labeled as</p>
<p>&nbsp;<br>
$$
W_{n0}=\frac{1}{2}mv_n^2-\frac{1}{2}mv_0^2=\int_{c}\boldsymbol{F}(\boldsymbol{r},\boldsymbol{v},t)d\boldsymbol{r}.
$$
<p>&nbsp;<br>

<p>Note that if the force is perpendicular to the displacement, then the force does not affect the kinetic energy.</p>

<p>Let us now study some examples of forces and how to find the velocity from the integration over a given path.</p>

<p>Thereafter we study how to  evaluate an integral numerically.</p>
</section>

<section>
<h2 id="studying-the-work-energy-theorem-numerically">Studying the Work-energy Theorem numerically </h2>

<p>In order to study the work- energy, we will normally need to perform
a numerical integration, unless we can integrate analytically. Here we
present some of the simpler  methods such as the <b>rectangle</b> rule, the <b>trapezoidal</b> rule and higher-order methods like the Simpson family of methods.
</p>
</section>

<section>
<h2 id="example-of-an-electron-moving-along-a-surface">Example of an Electron moving along a Surface </h2>

<p>As an example, let us consider the following case.
We have  classical electron which moves in the \( x \)-direction along a surface. The force from the surface is
</p>
<p>&nbsp;<br>
$$
\boldsymbol{F}(x)=-F_0\sin{(\frac{2\pi x}{b})}\boldsymbol{e}_1.
$$
<p>&nbsp;<br>

<p>The constant \( b \) represents the distance between atoms at the surface of the material, \( F_0 \) is a constant and \( x \) is the position of the electron.</p>

<p>Using the work-energy theorem we can find the work \( W \) done when moving an electron from a position \( x_0 \) to a final position \( x \) through the
 integral
</p>
<p>&nbsp;<br>
$$
W=\int_{x_0}^x \boldsymbol{F}(x')dx' =  -\int_{x_0}^x F_0\sin{(\frac{2\pi x'}{b})} dx', 
$$
<p>&nbsp;<br>

<p>which results in</p>
<p>&nbsp;<br>
$$
W=\frac{F_0b}{2\pi}\left[\cos{(\frac{2\pi x}{b})}-\cos{(\frac{2\pi x_0}{b})}\right].
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="finding-the-velocity">Finding the Velocity </h2>

<p>If we now use the work-energy theorem we can find the the velocity at a final position \( x \) by setting up
the differences in kinetic energies between the final position and the initial position \( x_0 \).
</p>

<p>We have that the work done by the force is given by the difference in kinetic energies as</p>
<p>&nbsp;<br>
$$
W=\frac{1}{2}m\left(v^2(x)-v^2(x_0)\right)=\frac{F_0b}{2\pi}\left[\cos{(\frac{2\pi x}{b})}-\cos{(\frac{2\pi x_0}{b})}\right],
$$
<p>&nbsp;<br>

<p>and labeling \( v(x_0)=v_0 \) (and assuming we know the initial velocity) we have</p>
<p>&nbsp;<br>
$$
v(x)=\pm \sqrt{v_0^2+\frac{F_0b}{m\pi}\left[\cos{(\frac{2\pi x}{b})}-\cos{(\frac{2\pi x_0}{b})}\right]},
$$
<p>&nbsp;<br>

<p>Choosing $x_0=0$m and $v_0=0$m/s we can simplify the above equation to</p>
<p>&nbsp;<br>
$$
v(x)=\pm \sqrt{\frac{F_0b}{m\pi}\left[\cos{(\frac{2\pi x}{b})}-1\right]},
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="harmonic-oscillations">Harmonic Oscillations </h2>

<p>Another well-known force (and we will derive when we come to Harmonic
Oscillations) is the case of a sliding block attached to a wall
through a spring. The block is attached to a spring with spring
constant \( k \). The other end of the spring is attached to the wall at
the origin \( x=0 \).  We assume the spring has an equilibrium length
\( L_0 \).
</p>

<p>The force \( F_x \) from the spring on the block is then</p>
<p>&nbsp;<br>
$$
F_x=-k(x-L_0).
$$
<p>&nbsp;<br>

<p>The position \( x \) where the spring force is zero is called the equilibrium position. In our case this is
\( x=L_0 \).
</p>

<p>We can now compute the work done by this force when we move our block from an initial position \( x_0 \) to a final position \( x \)</p>
<p>&nbsp;<br>
$$
W=\int_{x_0}^{x}F_xdx'=-k\int_{x_0}^{x}(x'-L_0)dx'=\frac{1}{2}k(x_0-L_0)^2-\frac{1}{2}k(x-L_0)^2.
$$
<p>&nbsp;<br>

<p>If we now bring back the definition of the work-energy theorem in terms of the kinetic energy we have</p>

<p>&nbsp;<br>
$$
W=\frac{1}{2}mv^2(x)-\frac{1}{2}mv_0^2=\frac{1}{2}k(x_0-L_0)^2-\frac{1}{2}k(x-L_0)^2,
$$
<p>&nbsp;<br>

<p>which we rewrite as</p>

<p>&nbsp;<br>
$$
\frac{1}{2}mv^2(x)+\frac{1}{2}k(x-L_0)^2=\frac{1}{2}mv_0^2+\frac{1}{2}k(x_0-L_0)^2.
$$
<p>&nbsp;<br>

<p>What does this mean? The total energy, which is the sum of potential and kinetic energy, is conserved.
Wow, this sounds interesting. We will analyze this next week in more detail when we study energy, momentum and angular momentum conservation.
</p>
</section>

<section>
<h2 id="work-energy-theorem-and-energy-conservation">Work-Energy Theorem and Energy Conservation  </h2>

<p>We have made the observation that energy was conserved for a force which
depends only on the position.
In particular we considered a force acting on a block 
attached to a spring with a so-called spring
constant \( k \). The other end of the spring was attached to the wall.  
</p>

<p>The force \( F_x \) from the spring on the block was defined as</p>
<p>&nbsp;<br>
$$
F_x=-kx.
$$
<p>&nbsp;<br>

<p>The work done on the block due to a displacement from a position \( x_0 \) to \( x \) </p>
<p>&nbsp;<br>
$$
W=\int_{x_0}^{x}F_xdx'=\frac{1}{2}kx_0^2-\frac{1}{2}kx^2.
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="conservation-of-energy">Conservation of energy </h2>
<p>With the definition of the work-energy theorem in terms of the kinetic energy we obtained</p>

<p>&nbsp;<br>
$$
W=\frac{1}{2}mv^2(x)-\frac{1}{2}mv_0^2=\frac{1}{2}kx_0^2-\frac{1}{2}kx^2,
$$
<p>&nbsp;<br>

<p>which we rewrote as</p>

<p>&nbsp;<br>
$$
\frac{1}{2}mv^2(x)+\frac{1}{2}kx^2=\frac{1}{2}mv_0^2+\frac{1}{2}kx_0^2.
$$
<p>&nbsp;<br>

<p>The total energy, which is the sum of potential and kinetic energy, is conserved.
We will analyze this interesting result now in more detail when we study energy, momentum and angular momentum conservation.
</p>

<p>But before we start with energy conservation, conservative forces and potential energies, we need to revisit our definitions of momentum and angular momentum.</p>
</section>

<section>
<h2 id="what-is-a-conservative-force">What is a Conservative Force? </h2>

<p>A conservative force is a force whose property is that the total work
done in moving an object between two points is independent of the
taken path. This means that the work on an object under the influence
of a conservative force, is independent on the path of the object. It
depends only on the spatial degrees of freedom and it is possible to
assign a numerical value for the potential at any point. It leads to
conservation of energy. The gravitational force is an example of a
conservative force.
</p>
</section>

<section>
<h2 id="two-important-conditions">Two important conditions </h2>

<p>First, a conservative force depends only on the spatial degrees of freedom. This is a necessary condition for obtaining a path integral which is independent of path.
The  important condition for the final work to be independent of the path is that the <b>curl</b> of the force is zero, that
is
</p>
<p>&nbsp;<br>
$$
\boldsymbol{\nabla} \times \boldsymbol{F}=0
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="work-energy-theorem-to-show-that-energy-is-conserved-with-a-conservative-force">Work-energy theorem to show that energy is conserved with a conservative force </h2>

<p>The work-energy theorem states that the work done \( W \) by a force \( \boldsymbol{F} \) that moves an object from a position \( \boldsymbol{r}_0 \) to a new position \( \boldsymbol{r}_1 \)</p>
<p>&nbsp;<br>
$$
W=\int_{\boldsymbol{r}_0}^{\boldsymbol{r}_1}\boldsymbol{F}\boldsymbol{dr}=\frac{1}{2}mv_1^2-\frac{1}{2}mv_0^2,
$$
<p>&nbsp;<br>

<p>where \( v_1^2 \) is the velocity squared at a time \( t_1 \) and \( v_0^2 \) the corresponding quantity at a time \( t_0 \).
The work done is thus the difference in kinetic energies. We can rewrite the above equation as
</p>
<p>&nbsp;<br>
$$
\frac{1}{2}mv_1^2=\int_{\boldsymbol{r}_0}^{\boldsymbol{r}_1}\boldsymbol{F}\boldsymbol{dr}+\frac{1}{2}mv_0^2,
$$
<p>&nbsp;<br>

<p>that is the final kinetic energy is equal to the initial kinetic energy plus the work done by the force over a given path from a  position \( \boldsymbol{r}_0 \) at time \( t_0 \) to a final position position \( \boldsymbol{r}_1 \) at a later time \( t_1 \).</p>
</section>

<section>
<h2 id="conservation-of-momentum">Conservation of Momentum </h2>

<p>Before we move on however, we need to remind ourselves about important aspects like the linear momentum and angular momentum. After these considerations, we move back to more details about conservatives forces.</p>

<p>Assume we have \( N \) objects, each with velocity \( \boldsymbol{v}_i \) with
\( i=1,2,\dots,N \) and mass \( m_i \). The momentum of each object is
\( \boldsymbol{p}_i=m\boldsymbol{v}_i \) and the total linear (or mechanical) momentum is
defined as
</p>

<p>&nbsp;<br>
$$
\boldsymbol{P}=\sum_{i=1}^N\boldsymbol{p}_i=\sum_{i=1}^Nm_i\boldsymbol{v}_i,
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="two-objects-first">Two objects first </h2>

<p>Let us assume we have two objects only that interact with each other and are influenced by an external force.</p>

<p>We define also the total net force acting on object 1 as </p>

<p>&nbsp;<br>
$$
\boldsymbol{F}_1^{\mathrm{net}}=\boldsymbol{F}_1^{\mathrm{ext}}+\boldsymbol{F}_{12},
$$
<p>&nbsp;<br>

<p>where \( \boldsymbol{F}_1^{\mathrm{ext}} \) is the external force
(for example the force due to an electron moving in an electromagnetic field) and \( \boldsymbol{F}_{12} \) is the
force between object one and two. Similarly for object 2 we have
</p>

<p>&nbsp;<br>
$$
\boldsymbol{F}_2^{\mathrm{net}}=\boldsymbol{F}_2^{\mathrm{ext}}+\boldsymbol{F}_{21}.
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="newton-s-third-law">Newton's Third Law </h2>

<p>Newton's third law which we met earlier states that <b>for every action there is an equal and opposite reaction</b>.
It is more accurately stated as
</p>

<b>if two bodies exert forces on each other, these forces are equal in magnitude and opposite in direction</b>.

<p>This means that for two bodies \( i \) and \( j \), if the force on \( i \) due to \( j \) is called \( \boldsymbol{F}_{ij} \), then </p>

<p>&nbsp;<br>
$$
\begin{equation}
\boldsymbol{F}_{ij}=-\boldsymbol{F}_{ji}. 
\tag{1}
\end{equation}
$$
<p>&nbsp;<br>

<p>For the abovementioned two objects we have thus \( \boldsymbol{F}_{12}=-\boldsymbol{F}_{21} \).</p>
</section>

<section>
<h2 id="newton-s-second-law-and-momentum">Newton's Second Law and Momentum </h2>

<p>With the net forces acting on each object we can now related the momentum to the forces via</p>

<p>&nbsp;<br>
$$
\boldsymbol{F}_1^{\mathrm{net}}=m_1\boldsymbol{a}_i=m_1\frac{d\boldsymbol{v}_1}{dt}=\boldsymbol{F}_1^{\mathrm{ext}}+\boldsymbol{F}_{12},
$$
<p>&nbsp;<br>

<p>and </p>

<p>&nbsp;<br>
$$
\boldsymbol{F}_2^{\mathrm{net}}=m_2\boldsymbol{a}_2=m_2\frac{d\boldsymbol{v}_2}{dt}=\boldsymbol{F}_2^{\mathrm{ext}}+\boldsymbol{F}_{21}.
$$
<p>&nbsp;<br>

<p>Recalling our definition for the linear momentum we have then</p>

<p>&nbsp;<br>
$$
\frac{d\boldsymbol{p}_1}{dt}=\boldsymbol{F}_1^{\mathrm{ext}}+\boldsymbol{F}_{12},
$$
<p>&nbsp;<br>

<p>and </p>

<p>&nbsp;<br>
$$
\frac{d\boldsymbol{p}_2}{dt}=\boldsymbol{F}_2^{\mathrm{ext}}+\boldsymbol{F}_{21}.
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="the-total-momentum">The total Momentum </h2>

<p>The total momentum \( \boldsymbol{P} \) is defined as the sum of the individual momenta, meaning that we can rewrite</p>

<p>&nbsp;<br>
$$
\boldsymbol{F}_1^{\mathrm{net}}+\boldsymbol{F}_2^{\mathrm{net}}=\frac{d\boldsymbol{p}_1}{dt}+\frac{d\boldsymbol{p}_2}{dt}=\frac{d\boldsymbol{P}}{dt},
$$
<p>&nbsp;<br>

<p>that is the derivate with respect to time of the total momentum. If we now
write the net forces as sums of the external plus internal forces
between the objects we have
</p>

<p>&nbsp;<br>
$$
\frac{d\boldsymbol{P}}{dt}=\boldsymbol{F}_1^{\mathrm{ext}}+\boldsymbol{F}_{12}+\boldsymbol{F}_2^{\mathrm{ext}}+\boldsymbol{F}_{21}=\boldsymbol{F}_1^{\mathrm{ext}}+\boldsymbol{F}_2^{\mathrm{ext}}.
$$
<p>&nbsp;<br>

<p>The derivative of the total momentum is just <b>the sum of the external
forces</b>. If we assume that the external forces are zero and that only
internal (here two-body forces) are at play, we obtain the important
result that the derivative of the total momentum is zero. This means
again that the total momentum is a constant of the motion and
conserved quantity. This is a very important result that we will use
in many applications to come.
</p>
</section>

<section>
<h2 id="newton-s-second-law">Newton's Second Law </h2>

<p>Let us now general to several objects \( N \) and let us also assume that there are no external forces. We will label such a system as <b>an isolated system</b>. </p>

<p>Newton's second law, \( \boldsymbol{F}=m\boldsymbol{a} \), can be written for a particle \( i \) as</p>

<p>&nbsp;<br>
$$
\begin{equation}
\boldsymbol{F}_i=\sum_{j\ne i}^N \boldsymbol{F}_{ij}=m_i\boldsymbol{a}_i,
\tag{2}
\end{equation}
$$
<p>&nbsp;<br>

<p>where \( \boldsymbol{F}_i \) (a single subscript) denotes the net force acting on \( i \) from the other objects/particles.
Because the mass of \( i \) is fixed and we assume it does not change with time, one can see that
</p>

<p>&nbsp;<br>
$$
\begin{equation}
\boldsymbol{F}_i=\frac{d}{dt}m_i\boldsymbol{v}_i=\sum_{j\ne i}^N\boldsymbol{F}_{ij}.
\tag{3}
\end{equation}
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="summing-over-all-objects-particles">Summing over all Objects/Particles </h2>

<p>Now, one can sum over all the objects/particles and obtain</p>

<p>&nbsp;<br>
$$
\frac{d}{dt}\sum_i m_iv_i=\sum_{ij, i\ne j}^N\boldsymbol{F}_{ij}=0.
$$
<p>&nbsp;<br>

<p>How did we arrive at the last step?  We rewrote the double sum as</p>

<p>&nbsp;<br>
$$
\sum_{ij, i\ne j}^N\boldsymbol{F}_{ij}=\sum_i^N\sum_{j>i}\left(\boldsymbol{F}_{ij}+\boldsymbol{F}_{ji}\right),
$$
<p>&nbsp;<br>

<p>and using Newton's third law which states that
\( \boldsymbol{F}_{ij}=-\boldsymbol{F}_{ji} \), we obtain that the net sum over all  the two-particle
forces is zero when we only consider so-called <b>internal forces</b>.
Stated differently, the last step made use of the fact that for every
term \( ij \), there is an equivalent term \( ji \) with opposite
force. Because the momentum is defined as \( m\boldsymbol{v} \), for a system of
particles, we have thus
</p>

<p>&nbsp;<br>
$$
\begin{equation}
\frac{d}{dt}\sum_im_i\boldsymbol{v}_i=0,~~{\rm for~isolated~particles}.
\tag{4}
\end{equation}
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="conservation-of-total-momentum">Conservation of total Momentum </h2>

<p>By "isolated" one means that the only force acting on any particle \( i \)
are those originating from other particles in the sum, i.e. &quot;no
external&quot; forces. Thus, Newton's third law leads to the conservation
of total momentum,
</p>

<p>&nbsp;<br>
$$
\boldsymbol{P}=\sum_i m_i\boldsymbol{v}_i,
$$
<p>&nbsp;<br>

<p>and we have</p>
<p>&nbsp;<br>
$$
\frac{d}{dt}\boldsymbol{P}=0.
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="example-rocket-science">Example: Rocket Science </h2>

<p>Consider a rocket of mass \( M \) moving with velocity \( v \). After a
brief instant, the velocity of the rocket is \( v+\Delta v \) and the mass
is \( M-\Delta M \). Momentum conservation gives
</p>

<p>&nbsp;<br>
$$
\begin{eqnarray*}
Mv&=&(M-\Delta M)(v+\Delta v)+\Delta M(v-v_e)\\
0&=&-\Delta Mv+M\Delta v+\Delta M(v-v_e),\\
0&=&M\Delta v-\Delta Mv_e.
\end{eqnarray*}
$$
<p>&nbsp;<br>

<p>In the second step we ignored the term \( \Delta M\Delta v \) because it is doubly small. The last equation gives</p>

<p>&nbsp;<br>
$$
\begin{eqnarray}
\Delta v&=&\frac{v_e}{M}\Delta M,\\
\nonumber
\frac{dv}{dt}&=&\frac{v_e}{M}\frac{dM}{dt}.
\end{eqnarray}
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="integrating-the-equations">Integrating the Equations </h2>

<p>Integrating the expression with lower limits \( v_0=0 \) and \( M_0 \), one finds</p>

<p>&nbsp;<br>
$$
\begin{eqnarray*}
v&=&v_e\int_{M_0}^M \frac{dM'}{M'}\\
v&=&v_e\ln(M/M_0)\\
&=&v_e\ln[(M_0-\alpha t)/M_0].
\end{eqnarray*}
$$
<p>&nbsp;<br>

<p>Because the total momentum of an isolated system is constant, one can
also quickly see that the center of mass of an isolated system is also
constant. The center of mass is the average position of a set of
masses weighted by the mass,
</p>

<p>&nbsp;<br>
$$
\begin{equation}
\bar{x}=\frac{\sum_im_ix_i}{\sum_i m_i}.
\tag{5}
\end{equation}
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="rate-of-change">Rate of Change </h2>

<p>The rate of change of \( \bar{x} \) is</p>

<p>&nbsp;<br>
$$
\dot{\bar{x}}=\frac{1}{M}\sum_i m_i\dot{x}_i=\frac{1}{M}P_x.
$$
<p>&nbsp;<br>

<p>Thus if the total momentum is constant the center of mass moves at a
constant velocity, and if the total momentum is zero the center of
mass is fixed.
</p>
</section>

<section>
<h2 id="conservation-of-angular-momentum">Conservation of Angular Momentum </h2>

<p>The angular momentum is defined as</p>

<p>&nbsp;<br>
$$
\begin{equation}
\boldsymbol{L}=\boldsymbol{r}\times\boldsymbol{p}=m\boldsymbol{r}\times\boldsymbol{v}.
\tag{6}
\end{equation}
$$
<p>&nbsp;<br>

<p>It means that the angular momentum is perpendicular to the plane defined by position \( \boldsymbol{r} \) and the momentum \( \boldsymbol{p} \) via \( \boldsymbol{r}\times \boldsymbol{p} \). </p>
</section>

<section>
<h2 id="rate-of-change-of-angular-momentum">Rate of Change of Angular Momentum </h2>

<p>The rate of change of the angular momentum is</p>

<p>&nbsp;<br>
$$
\frac{d\boldsymbol{L}}{dt}=m\boldsymbol{v}\times\boldsymbol{v}+m\boldsymbol{r}\times\dot{\boldsymbol{v}}=\boldsymbol{r}\times{\boldsymbol{F}}
$$
<p>&nbsp;<br>

<p>The first term is zero because \( \boldsymbol{v} \) is parallel to itself, and the
second term defines the so-called torque. If \( \boldsymbol{F} \) is parallel to \( \boldsymbol{r} \) then the torque is zero and we say that angular momentum is conserved.
</p>

<p>If the force is not radial, \( \boldsymbol{r}\times\boldsymbol{F}\ne 0 \) as above, and angular momentum is no longer conserved,</p>

<p>&nbsp;<br>
$$
\begin{equation}
\frac{d\boldsymbol{L}}{dt}=\boldsymbol{r}\times\boldsymbol{F}\equiv\boldsymbol{\tau},
\tag{7}
\end{equation}
$$
<p>&nbsp;<br>

<p>where \( \boldsymbol{\tau} \) is the torque.</p>
</section>

<section>
<h2 id="the-torque-example-1-hw-4-exercise-4">The Torque, Example 1 (hw 4, exercise 4) </h2>

<p>Let us assume we have an initial position \( \boldsymbol{r}_0=x_0\boldsymbol{e}_1+y_0\boldsymbol{e}_2 \) at a time \( t_0=0 \).
We add now a force in the positive \( x \)-direction
</p>
<p>&nbsp;<br>
$$
\boldsymbol{F}=F_x\boldsymbol{e}_1=\frac{d\boldsymbol{p}}{dt},
$$
<p>&nbsp;<br>

<p>where we used the force as defined by the time derivative of the momentum.</p>

<p>We can use this force (and its pertinent acceleration) to find the velocity via the relation</p>
<p>&nbsp;<br>
$$
\boldsymbol{v}(t)=\boldsymbol{v}_0+\int_{t_0}^t\boldsymbol{a}dt',
$$
<p>&nbsp;<br>

<p>and with \( \boldsymbol{v}_0=0 \) we have</p>
<p>&nbsp;<br>
$$
\boldsymbol{v}(t)=\int_{t_0}^t\frac{\boldsymbol{F}}{m}dt',
$$
<p>&nbsp;<br>

<p>where \( m \) is the mass of the object.</p>
</section>

<section>
<h2 id="the-torque-example-1-hw-4-exercise-4">The Torque, Example 1 (hw 4, exercise 4) </h2>

<p>Since the force acts only in the \( x \)-direction, we have after integration</p>
<p>&nbsp;<br>
$$
\boldsymbol{v}(t)=\frac{\boldsymbol{F}}{m}t=\frac{F_x}{m}t\boldsymbol{e}_1=v_x(t)\boldsymbol{e}_1.
$$
<p>&nbsp;<br>

<p>The momentum is in turn given by \( \boldsymbol{p}=p_x\boldsymbol{e}_1=mv_x\boldsymbol{e}_1=F_xt\boldsymbol{e}_1 \).</p>

<p>Integrating over time again we find the final position as (note the force depends only on the \( x \)-direction)</p>
<p>&nbsp;<br>
$$
\boldsymbol{r}(t)=(x_0+\frac{1}{2}\frac{F_x}{m}t^2) \boldsymbol{e}_1+y_0\boldsymbol{e}_2.
$$
<p>&nbsp;<br>

<p>There is no change in the position in the \( y \)-direction since the force acts only in the \( x \)-direction.</p>
</section>

<section>
<h2 id="the-torque-example-1-hw-4-exercise-4">The Torque, Example 1 (hw 4, exercise 4) </h2>

<p>We can now compute the angular momentum given by</p>
<p>&nbsp;<br>
$$
\boldsymbol{l}=\boldsymbol{r}\times\boldsymbol{p}=\left[(x_0+\frac{1}{2}\frac{F_x}{m}t^2) \boldsymbol{e}_1+y_0\boldsymbol{e}_2\right]\times F_xt\boldsymbol{e}_1.
$$
<p>&nbsp;<br>

<p>Computing the cross product we find</p>

<p>&nbsp;<br>
$$
\boldsymbol{l}=-y_0F_xt\boldsymbol{e}_3=-y_0F_xt\boldsymbol{e}_z.
$$
<p>&nbsp;<br>

<p>The torque is the time derivative of the angular momentum and we have</p>

<p>&nbsp;<br>
$$
\boldsymbol{\tau}=-y_0F_x\boldsymbol{e}_3=-y_0F_x\boldsymbol{e}_z.
$$
<p>&nbsp;<br>

<p>The torque is non-zero and angular momentum is not conserved.</p>
</section>

<section>
<h2 id="the-torque-example-2">The Torque, Example 2 </h2>

<p>One can write the torque about a given axis, which we will denote as \( \hat{z} \), in polar coordinates, where</p>

<p>&nbsp;<br>
$$
\begin{eqnarray}
x&=&r\sin\theta\cos\phi,~~y=r\sin\theta\cos\phi,~~z=r\cos\theta,
\end{eqnarray}
$$
<p>&nbsp;<br>

<p>to find the \( z \) component of the torque,</p>

<p>&nbsp;<br>
$$
\begin{eqnarray}
\tau_z&=&xF_y-yF_x\\
\nonumber
&=&-r\sin\theta\left\{\cos\phi \partial_y-\sin\phi \partial_x\right\}V(x,y,z).
\end{eqnarray}
$$
<p>&nbsp;<br>
</section>

<section>
<h2 id="chain-rule-and-partial-derivatives">Chain Rule and Partial Derivatives </h2>

<p>One can use the chain rule to write the partial derivative w.r.t. \( \phi \) (keeping \( r \) and \( \theta \) fixed),</p>

<p>&nbsp;<br>
$$
\begin{eqnarray}
\partial_\phi&=&\frac{\partial x}{\partial\phi}\partial_x+\frac{\partial_y}{\partial\phi}\partial_y
+\frac{\partial z}{\partial\phi}\partial_z\\
\nonumber
&=&-r\sin\theta\sin\phi\partial_x+\sin\theta\cos\phi\partial_y.
\end{eqnarray}
$$
<p>&nbsp;<br>

<p>Combining the two equations,</p>

<p>&nbsp;<br>
$$
\begin{eqnarray}
\tau_z&=&-\partial_\phi V(r,\theta,\phi).
\end{eqnarray}
$$
<p>&nbsp;<br>

<p>Thus, if the potential is independent of the azimuthal angle \( \phi \),
there is no torque about the \( z \) axis and \( L_z \) is conserved.
</p>
</section>

<section>
<h2 id="system-of-isolated-particles">System of Isolated Particles </h2>

<p>For a system of isolated particles, one can write</p>

<p>&nbsp;<br>
$$
\begin{eqnarray}
\frac{d}{dt}\sum_i\boldsymbol{L}_i&=&\sum_{i\ne j}\boldsymbol{r}_i\times \boldsymbol{F}_{ij}\\
\nonumber
&=&\frac{1}{2}\sum_{ij, i\ne j} \boldsymbol{r}_i\times \boldsymbol{F}_{ij}+\boldsymbol{r}_j\times\boldsymbol{F}_{ji}\\
\nonumber
&=&\frac{1}{2}\sum_{ij, i\ne j} (\boldsymbol{r}_i-\boldsymbol{r}_j)\times\boldsymbol{F}_{ij}=0,
\end{eqnarray}
$$
<p>&nbsp;<br>

<p>where the last step used Newton's third law,
\( \boldsymbol{F}_{ij}=-\boldsymbol{F}_{ji} \). If the forces between the particles are
radial, i.e. \( \boldsymbol{F}_{ij} ~||~ (\boldsymbol{r}_i-\boldsymbol{r}_j) \), then each term in
the sum is zero and the net angular momentum is fixed. Otherwise, you
could imagine an isolated system that would start spinning
spontaneously.
</p>
</section>

<section>
<h2 id="homework-3-exercises-5-and-6-numerical-solution">Homework 3, exercises 5 and 6, numerical solution </h2>


<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #eeeedd">
  <pre style="font-size: 80%; line-height: 125%;"><span style="color: #228B22"># let&#39;s start by importing useful packages we are familiar with</span>
<span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">numpy</span> <span style="color: #8B008B; font-weight: bold">as</span> <span style="color: #008b45; text-decoration: underline">np</span>
<span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">matplotlib.pyplot</span> <span style="color: #8B008B; font-weight: bold">as</span> <span style="color: #008b45; text-decoration: underline">plt</span>
%matplotlib inline
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>

<p>We will choose the following values</p>
<ol>
<p><li> mass \( m=0,2 \) kg</li>
<p><li> accelleration (gravity) \( g=9.81 \) m/s$^{2}$.</li>
<p><li> initial position is the height \( h=2 \) m</li>
<p><li> initial velocities \( v_{x,0}=v_{y,0}=10 \) m/s</li>
</ol>
<p>
<p>You need also to define an initial time and 
the step size \( \Delta t \). We can define the step size \( \Delta t \) as the difference between any
two neighboring values in time (time steps) that we analyze within
some range. It can be determined by dividing the interval we are
analyzing, which in our case is time \( t_{\mathrm{final}}-t_0 \), by the number of steps we
are taking \( (N) \). This gives us a step size \( \Delta t = \dfrac{t_{\mathrm{final}}-t_0}{N} \).
</p>

<p>With these preliminaries we are now ready to plot our results from exercise 5.</p>

<p>In setting up our code we need to</p>

<ol>
<p><li> Define and obtain all initial values, constants, and time to be analyzed with step sizes as done above (you can use the same values)</li>
<p><li> Calculate the velocity using \( v_{i+1} = v_{i} + (\Delta t)*a_{i} \)</li>
<p><li> Calculate the position using \( pos_{i+1} = r_{i} + (\Delta t)*v_{i} \)</li>
<p><li> Calculate the new acceleration \( a_{i+1} \).</li>
<p><li> Repeat steps 2-4 for all time steps within a loop.</li>
</ol>
<p>

<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #eeeedd">
  <pre style="font-size: 80%; line-height: 125%;"><span style="color: #228B22"># Exercise 6, hw3, brute force way with declaration of vx, vy, x and y</span>
<span style="color: #228B22"># Common imports</span>
<span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">numpy</span> <span style="color: #8B008B; font-weight: bold">as</span> <span style="color: #008b45; text-decoration: underline">np</span>
<span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">pandas</span> <span style="color: #8B008B; font-weight: bold">as</span> <span style="color: #008b45; text-decoration: underline">pd</span>
<span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">math</span> <span style="color: #8B008B; font-weight: bold">import</span> *
<span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">matplotlib.pyplot</span> <span style="color: #8B008B; font-weight: bold">as</span> <span style="color: #008b45; text-decoration: underline">plt</span>
<span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">os</span>

<span style="color: #228B22"># Where to save the figures and data files</span>
PROJECT_ROOT_DIR = <span style="color: #CD5555">&quot;Results&quot;</span>
FIGURE_ID = <span style="color: #CD5555">&quot;Results/FigureFiles&quot;</span>
DATA_ID = <span style="color: #CD5555">&quot;DataFiles/&quot;</span>

<span style="color: #8B008B; font-weight: bold">if</span> <span style="color: #8B008B">not</span> os.path.exists(PROJECT_ROOT_DIR):
    os.mkdir(PROJECT_ROOT_DIR)

<span style="color: #8B008B; font-weight: bold">if</span> <span style="color: #8B008B">not</span> os.path.exists(FIGURE_ID):
    os.makedirs(FIGURE_ID)

<span style="color: #8B008B; font-weight: bold">if</span> <span style="color: #8B008B">not</span> os.path.exists(DATA_ID):
    os.makedirs(DATA_ID)

<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">image_path</span>(fig_id):
    <span style="color: #8B008B; font-weight: bold">return</span> os.path.join(FIGURE_ID, fig_id)

<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">data_path</span>(dat_id):
    <span style="color: #8B008B; font-weight: bold">return</span> os.path.join(DATA_ID, dat_id)

<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">save_fig</span>(fig_id):
    plt.savefig(image_path(fig_id) + <span style="color: #CD5555">&quot;.png&quot;</span>, <span style="color: #658b00">format</span>=<span style="color: #CD5555">&#39;png&#39;</span>)

<span style="color: #228B22"># Output file</span>
outfile = <span style="color: #658b00">open</span>(data_path(<span style="color: #CD5555">&quot;Eulerresults.dat&quot;</span>),<span style="color: #CD5555">&#39;w&#39;</span>)

<span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">pylab</span> <span style="color: #8B008B; font-weight: bold">import</span> plt, mpl
plt.style.use(<span style="color: #CD5555">&#39;seaborn&#39;</span>)
mpl.rcParams[<span style="color: #CD5555">&#39;font.family&#39;</span>] = <span style="color: #CD5555">&#39;serif&#39;</span>


g = <span style="color: #B452CD">9.80655</span> <span style="color: #228B22">#m/s^2</span>
<span style="color: #228B22"># The mass and the drag constant D</span>
D = <span style="color: #B452CD">0.00245</span> <span style="color: #228B22">#mass/length   kg/m</span>
m = <span style="color: #B452CD">0.2</span> <span style="color: #228B22">#kg, mass of falling object</span>
DeltaT = <span style="color: #B452CD">0.001</span>
<span style="color: #228B22">#set up arrays </span>
tfinal = <span style="color: #B452CD">1.4</span>
<span style="color: #228B22"># set up number of points for all variables</span>
n = ceil(tfinal/DeltaT)
<span style="color: #228B22"># define scaling constant vT used in analytical solution</span>
vT = sqrt(m*g/D)
<span style="color: #228B22"># set up arrays for t, a, v, and y and arrays for analytical results</span>
<span style="color: #228B22">#brute force setting up of arrays for x and y, vx, vy, ax and ay</span>
t = np.zeros(n)
vy = np.zeros(n)
y = np.zeros(n)
vx = np.zeros(n)
x = np.zeros(n)
yanalytic = np.zeros(n)
<span style="color: #228B22"># Initial conditions, note that these correspond to an object falling in the y-direction only.</span>
vx[<span style="color: #B452CD">0</span>] = <span style="color: #B452CD">0.0</span> <span style="color: #228B22">#m/s</span>
vy[<span style="color: #B452CD">0</span>] = <span style="color: #B452CD">0.0</span>  <span style="color: #228B22">#m/s</span>
y[<span style="color: #B452CD">0</span>] = <span style="color: #B452CD">10.0</span> <span style="color: #228B22">#m</span>
x[<span style="color: #B452CD">0</span>] = <span style="color: #B452CD">0.0</span> <span style="color: #228B22">#m</span>
yanalytic[<span style="color: #B452CD">0</span>] = y[<span style="color: #B452CD">0</span>]
<span style="color: #228B22"># Start integrating using Euler&#39;s method</span>
<span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> <span style="color: #658b00">range</span>(n-<span style="color: #B452CD">1</span>):
    <span style="color: #228B22"># expression for acceleration, note the absolute value and division by mass</span>
<span style="color: #228B22"># Note: you need to think of the sign for the drag force as function of the velocity vector </span>
    ax = -D*vx[i]*sqrt(vx[i]**<span style="color: #B452CD">2</span>+vy[i]**<span style="color: #B452CD">2</span>)/m
    ay = -g - D*vy[i]*sqrt(vx[i]**<span style="color: #B452CD">2</span>+vy[i]**<span style="color: #B452CD">2</span>)/m
    <span style="color: #228B22"># update velocity and position</span>
    vx[i+<span style="color: #B452CD">1</span>] = vx[i] + DeltaT*ax
    x[i+<span style="color: #B452CD">1</span>] = x[i] + DeltaT*vx[i]
    vy[i+<span style="color: #B452CD">1</span>] = vy[i] + DeltaT*ay
    y[i+<span style="color: #B452CD">1</span>] = y[i] + DeltaT*vy[i]
    <span style="color: #228B22"># update time to next time step and compute analytical answer</span>
    t[i+<span style="color: #B452CD">1</span>] = t[i] + DeltaT
    yanalytic[i+<span style="color: #B452CD">1</span>] = y[<span style="color: #B452CD">0</span>]-(vT*vT/g)*log(cosh(g*t[i+<span style="color: #B452CD">1</span>]/vT))+vy[<span style="color: #B452CD">0</span>]*t[i+<span style="color: #B452CD">1</span>]
    <span style="color: #8B008B; font-weight: bold">if</span> ( y[i+<span style="color: #B452CD">1</span>] &lt; <span style="color: #B452CD">0.0</span>):
        <span style="color: #8B008B; font-weight: bold">break</span>
data = {<span style="color: #CD5555">&#39;t[s]&#39;</span>: t,
        <span style="color: #CD5555">&#39;Relative error in y&#39;</span>: <span style="color: #658b00">abs</span>((y-yanalytic)/yanalytic),
        <span style="color: #CD5555">&#39;vy[m/s]&#39;</span>: vy,
        <span style="color: #CD5555">&#39;x[m]&#39;</span>: x,
        <span style="color: #CD5555">&#39;vx[m/s]&#39;</span>: vx
}
NewData = pd.DataFrame(data)
display(NewData)
<span style="color: #228B22"># save to file</span>
NewData.to_csv(outfile, index=<span style="color: #8B008B; font-weight: bold">False</span>)
<span style="color: #228B22">#then plot</span>
fig, axs = plt.subplots(<span style="color: #B452CD">4</span>, <span style="color: #B452CD">1</span>)
axs[<span style="color: #B452CD">0</span>].plot(t, y)
axs[<span style="color: #B452CD">0</span>].set_xlim(<span style="color: #B452CD">0</span>, tfinal)
axs[<span style="color: #B452CD">0</span>].set_ylabel(<span style="color: #CD5555">&#39;y&#39;</span>)
axs[<span style="color: #B452CD">1</span>].plot(t, vy)
axs[<span style="color: #B452CD">1</span>].set_ylabel(<span style="color: #CD5555">&#39;vy[m/s]&#39;</span>)
axs[<span style="color: #B452CD">1</span>].set_xlabel(<span style="color: #CD5555">&#39;time[s]&#39;</span>)
axs[<span style="color: #B452CD">2</span>].plot(t, x)
axs[<span style="color: #B452CD">2</span>].set_xlim(<span style="color: #B452CD">0</span>, tfinal)
axs[<span style="color: #B452CD">2</span>].set_ylabel(<span style="color: #CD5555">&#39;x&#39;</span>)
axs[<span style="color: #B452CD">3</span>].plot(t, vx)
axs[<span style="color: #B452CD">3</span>].set_ylabel(<span style="color: #CD5555">&#39;vx[m/s]&#39;</span>)
axs[<span style="color: #B452CD">3</span>].set_xlabel(<span style="color: #CD5555">&#39;time[s]&#39;</span>)
fig.tight_layout()
save_fig(<span style="color: #CD5555">&quot;EulerIntegration&quot;</span>)
plt.show()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
</section>

<section>
<h2 id="a-more-compact-version-of-the-code">A more compact version of the code </h2>


<!-- code=python (!bc pycod) typeset with pygments style "perldoc" -->
<div class="cell border-box-sizing code_cell rendered">
  <div class="input">
    <div class="inner_cell">
      <div class="input_area">
        <div class="highlight" style="background: #eeeedd">
  <pre style="font-size: 80%; line-height: 125%;"><span style="color: #228B22"># Exercise 6, hw3, smarter way with declaration of vx, vy, x and y</span>
<span style="color: #228B22"># Common imports</span>
<span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">numpy</span> <span style="color: #8B008B; font-weight: bold">as</span> <span style="color: #008b45; text-decoration: underline">np</span>
<span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">pandas</span> <span style="color: #8B008B; font-weight: bold">as</span> <span style="color: #008b45; text-decoration: underline">pd</span>
<span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">math</span> <span style="color: #8B008B; font-weight: bold">import</span> *
<span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">matplotlib.pyplot</span> <span style="color: #8B008B; font-weight: bold">as</span> <span style="color: #008b45; text-decoration: underline">plt</span>
<span style="color: #8B008B; font-weight: bold">import</span> <span style="color: #008b45; text-decoration: underline">os</span>

<span style="color: #228B22"># Where to save the figures and data files</span>
PROJECT_ROOT_DIR = <span style="color: #CD5555">&quot;Results&quot;</span>
FIGURE_ID = <span style="color: #CD5555">&quot;Results/FigureFiles&quot;</span>
DATA_ID = <span style="color: #CD5555">&quot;DataFiles/&quot;</span>

<span style="color: #8B008B; font-weight: bold">if</span> <span style="color: #8B008B">not</span> os.path.exists(PROJECT_ROOT_DIR):
    os.mkdir(PROJECT_ROOT_DIR)

<span style="color: #8B008B; font-weight: bold">if</span> <span style="color: #8B008B">not</span> os.path.exists(FIGURE_ID):
    os.makedirs(FIGURE_ID)

<span style="color: #8B008B; font-weight: bold">if</span> <span style="color: #8B008B">not</span> os.path.exists(DATA_ID):
    os.makedirs(DATA_ID)

<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">image_path</span>(fig_id):
    <span style="color: #8B008B; font-weight: bold">return</span> os.path.join(FIGURE_ID, fig_id)

<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">data_path</span>(dat_id):
    <span style="color: #8B008B; font-weight: bold">return</span> os.path.join(DATA_ID, dat_id)

<span style="color: #8B008B; font-weight: bold">def</span> <span style="color: #008b45">save_fig</span>(fig_id):
    plt.savefig(image_path(fig_id) + <span style="color: #CD5555">&quot;.png&quot;</span>, <span style="color: #658b00">format</span>=<span style="color: #CD5555">&#39;png&#39;</span>)


<span style="color: #8B008B; font-weight: bold">from</span> <span style="color: #008b45; text-decoration: underline">pylab</span> <span style="color: #8B008B; font-weight: bold">import</span> plt, mpl
plt.style.use(<span style="color: #CD5555">&#39;seaborn&#39;</span>)
mpl.rcParams[<span style="color: #CD5555">&#39;font.family&#39;</span>] = <span style="color: #CD5555">&#39;serif&#39;</span>

g = <span style="color: #B452CD">9.80655</span> <span style="color: #228B22">#m/s^2 g to 6 leading digits after decimal point</span>
D = <span style="color: #B452CD">0.00245</span> <span style="color: #228B22">#m/s</span>
m = <span style="color: #B452CD">0.2</span> <span style="color: #228B22"># kg</span>
<span style="color: #228B22"># Define Gravitational force as a vector in x and y. It is a constant</span>
G = -m*g*np.array([<span style="color: #B452CD">0.0</span>,<span style="color: #B452CD">1</span>])
DeltaT = <span style="color: #B452CD">0.01</span>
<span style="color: #228B22">#set up arrays </span>
tfinal = <span style="color: #B452CD">1.3</span>
n = ceil(tfinal/DeltaT)
<span style="color: #228B22"># set up arrays for t, a, v, and x</span>
t = np.zeros(n)
v = np.zeros((n,<span style="color: #B452CD">2</span>))
r = np.zeros((n,<span style="color: #B452CD">2</span>))
<span style="color: #228B22"># Initial conditions as compact 2-dimensional arrays</span>
r0 = np.array([<span style="color: #B452CD">0.0</span>,<span style="color: #B452CD">10.0</span>])
v0 = np.array([<span style="color: #B452CD">10.0</span>,<span style="color: #B452CD">0.0</span>])
r[<span style="color: #B452CD">0</span>] = r0
v[<span style="color: #B452CD">0</span>] = v0
<span style="color: #228B22"># Start integrating using Euler&#39;s method</span>
<span style="color: #8B008B; font-weight: bold">for</span> i <span style="color: #8B008B">in</span> <span style="color: #658b00">range</span>(n-<span style="color: #B452CD">1</span>):
    <span style="color: #228B22"># Set up forces, air resistance FD, note now that we need the norm of the vector</span>
    <span style="color: #228B22"># Here you could have defined your own function for this</span>
    vabs = sqrt(<span style="color: #658b00">sum</span>(v[i]*v[i]))
<span style="color: #228B22"># Note: you need to think of the sign for the drag force </span>
    FD = -D*v[i]*vabs
    <span style="color: #228B22"># Final net forces acting on falling object</span>
    Fnet = FD+G
    <span style="color: #228B22"># The accelration at a given time t_i</span>
    a = Fnet/m
    <span style="color: #228B22"># update velocity, time and position using Euler&#39;s method</span>
    v[i+<span style="color: #B452CD">1</span>] = v[i] + DeltaT*a
    r[i+<span style="color: #B452CD">1</span>] = r[i] + DeltaT*v[i]
    t[i+<span style="color: #B452CD">1</span>] = t[i] + DeltaT

fig, axs = plt.subplots(<span style="color: #B452CD">4</span>, <span style="color: #B452CD">1</span>)
axs[<span style="color: #B452CD">0</span>].plot(t, r[:,<span style="color: #B452CD">1</span>])
axs[<span style="color: #B452CD">0</span>].set_xlim(<span style="color: #B452CD">0</span>, tfinal)
axs[<span style="color: #B452CD">0</span>].set_ylabel(<span style="color: #CD5555">&#39;y&#39;</span>)
axs[<span style="color: #B452CD">1</span>].plot(t, v[:,<span style="color: #B452CD">1</span>])
axs[<span style="color: #B452CD">1</span>].set_ylabel(<span style="color: #CD5555">&#39;vy[m/s]&#39;</span>)
axs[<span style="color: #B452CD">1</span>].set_xlabel(<span style="color: #CD5555">&#39;time[s]&#39;</span>)
axs[<span style="color: #B452CD">2</span>].plot(t, r[:,<span style="color: #B452CD">0</span>])
axs[<span style="color: #B452CD">2</span>].set_xlim(<span style="color: #B452CD">0</span>, tfinal)
axs[<span style="color: #B452CD">2</span>].set_ylabel(<span style="color: #CD5555">&#39;x&#39;</span>)
axs[<span style="color: #B452CD">3</span>].plot(t, v[:,<span style="color: #B452CD">0</span>])
axs[<span style="color: #B452CD">3</span>].set_ylabel(<span style="color: #CD5555">&#39;vx[m/s]&#39;</span>)
axs[<span style="color: #B452CD">3</span>].set_xlabel(<span style="color: #CD5555">&#39;time[s]&#39;</span>)

fig.tight_layout()
save_fig(<span style="color: #CD5555">&quot;EulerIntegration&quot;</span>)
plt.show()
</pre>
</div>
      </div>
    </div>
  </div>
  <div class="output_wrapper">
    <div class="output">
      <div class="output_area">
        <div class="output_subarea output_stream output_stdout output_text">          
        </div>
      </div>
    </div>
  </div>
</div>
</section>



</div> <!-- class="slides" -->
</div> <!-- class="reveal" -->

<script src="reveal.js/lib/js/head.min.js"></script>
<script src="reveal.js/js/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

  // Display navigation controls in the bottom right corner
  controls: true,

  // Display progress bar (below the horiz. slider)
  progress: true,

  // Display the page number of the current slide
  slideNumber: true,

  // Push each slide change to the browser history
  history: false,

  // Enable keyboard shortcuts for navigation
  keyboard: true,

  // Enable the slide overview mode
  overview: true,

  // Vertical centering of slides
  //center: true,
  center: false,

  // Enables touch navigation on devices with touch input
  touch: true,

  // Loop the presentation
  loop: false,

  // Change the presentation direction to be RTL
  rtl: false,

  // Turns fragments on and off globally
  fragments: true,

  // Flags if the presentation is running in an embedded mode,
  // i.e. contained within a limited portion of the screen
  embedded: false,

  // Number of milliseconds between automatically proceeding to the
  // next slide, disabled when set to 0, this value can be overwritten
  // by using a data-autoslide attribute on your slides
  autoSlide: 0,

  // Stop auto-sliding after user input
  autoSlideStoppable: true,

  // Enable slide navigation via mouse wheel
  mouseWheel: false,

  // Hides the address bar on mobile devices
  hideAddressBar: true,

  // Opens links in an iframe preview overlay
  previewLinks: false,

  // Transition style
  transition: 'default', // default/cube/page/concave/zoom/linear/fade/none

  // Transition speed
  transitionSpeed: 'default', // default/fast/slow

  // Transition style for full page slide backgrounds
  backgroundTransition: 'default', // default/none/slide/concave/convex/zoom

  // Number of slides away from the current that are visible
  viewDistance: 3,

  // Parallax background image
    //parallaxBackgroundImage: '', // e.g. "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'"

  // Parallax background size
  //parallaxBackgroundSize: '' // CSS syntax, e.g. "2100px 900px"

  theme: Reveal.getQueryHash().theme, // available themes are in reveal.js/css/theme
    transition: Reveal.getQueryHash().transition || 'none', // default/cube/page/concave/zoom/linear/none

});

Reveal.initialize({
  dependencies: [
      // Cross-browser shim that fully implements classList - https://github.com/eligrey/classList.js/
      { src: 'reveal.js/lib/js/classList.js', condition: function() { return !document.body.classList; } },

      // Interpret Markdown in <section> elements
      { src: 'reveal.js/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'reveal.js/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },

      // Syntax highlight for <code> elements
      { src: 'reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },

      // Zoom in and out with Alt+click
      { src: 'reveal.js/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },

      // Speaker notes
      { src: 'reveal.js/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } },

      // Remote control your reveal.js presentation using a touch device
      //{ src: 'reveal.js/plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } },

      // MathJax
      //{ src: 'reveal.js/plugin/math/math.js', async: true }
  ]
});

Reveal.initialize({

  // The "normal" size of the presentation, aspect ratio will be preserved
  // when the presentation is scaled to fit different resolutions. Can be
  // specified using percentage units.
  width: 1170,  // original: 960,
  height: 700,

  // Factor of the display size that should remain empty around the content
  margin: 0.1,

  // Bounds for smallest/largest possible scale to apply to content
  minScale: 0.2,
  maxScale: 1.0

});
</script>

<!-- begin footer logo
<div style="position: absolute; bottom: 0px; left: 0; margin-left: 0px">
<img src="somelogo.png">
</div>
   end footer logo -->




</body>
</html>
