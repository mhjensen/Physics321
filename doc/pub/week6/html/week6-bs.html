<!--
Automatically generated HTML file from DocOnce source
(https://github.com/doconce/doconce/)
-->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="DocOnce: https://github.com/doconce/doconce/" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="description" content="PHY321: Conservative Forces, Momentum and Angular Momentum conservation">

<title>PHY321: Conservative Forces, Momentum and Angular Momentum conservation</title>

<!-- Bootstrap style: bootstrap -->
<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<!-- not necessary
<link href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
-->

<style type="text/css">

/* Add scrollbar to dropdown menus in bootstrap navigation bar */
.dropdown-menu {
   height: auto;
   max-height: 400px;
   overflow-x: hidden;
}

/* Adds an invisible element before each target to offset for the navigation
   bar */
.anchor::before {
  content:"";
  display:block;
  height:50px;      /* fixed header height for style bootstrap */
  margin:-50px 0 0; /* negative fixed header height */
}
</style>


</head>

<!-- tocinfo
{'highest level': 2,
 'sections': [('Aims and Overarching Motivation',
               2,
               None,
               'aims-and-overarching-motivation'),
              ('Monday', 3, None, 'monday'),
              ('Wednesday', 3, None, 'wednesday'),
              ('Friday', 3, None, 'friday'),
              ('Work-Energy Theorem and Energy Conservation',
               2,
               None,
               'work-energy-theorem-and-energy-conservation'),
              ('Conservation of energy', 2, None, 'conservation-of-energy'),
              ('What is a Conservative Force?',
               2,
               None,
               'what-is-a-conservative-force'),
              ('Two important conditions', 2, None, 'two-important-conditions'),
              ('Work-energy theorem to show that energy is conserved with a '
               'conservative force',
               2,
               None,
               'work-energy-theorem-to-show-that-energy-is-conserved-with-a-conservative-force'),
              ('Conservation of Momentum', 2, None, 'conservation-of-momentum'),
              ('Two objects first', 2, None, 'two-objects-first'),
              ("Newton's Third Law", 2, None, 'newton-s-third-law'),
              ("Newton's Second Law and Momentum",
               2,
               None,
               'newton-s-second-law-and-momentum'),
              ('The total Momentum', 2, None, 'the-total-momentum'),
              ("Newton's Second Law", 2, None, 'newton-s-second-law'),
              ('Summing over all Objects/Particles',
               2,
               None,
               'summing-over-all-objects-particles'),
              ('Conservation of total Momentum',
               2,
               None,
               'conservation-of-total-momentum'),
              ('Example: Rocket Science', 2, None, 'example-rocket-science'),
              ('Integrating the Equations',
               2,
               None,
               'integrating-the-equations'),
              ('Rate of Change', 2, None, 'rate-of-change'),
              ('Conservation of Angular Momentum',
               2,
               None,
               'conservation-of-angular-momentum'),
              ('Rate of Change of Angular Momentum',
               2,
               None,
               'rate-of-change-of-angular-momentum'),
              ('The Torque, Example 1 (hw 4, exercise 4)',
               2,
               None,
               'the-torque-example-1-hw-4-exercise-4'),
              ('The Torque, Example 1 (hw 4, exercise 4)',
               2,
               None,
               'the-torque-example-1-hw-4-exercise-4'),
              ('The Torque, Example 1 (hw 4, exercise 4)',
               2,
               None,
               'the-torque-example-1-hw-4-exercise-4'),
              ('The Torque, Example 2', 2, None, 'the-torque-example-2'),
              ('Chain Rule and Partial Derivatives',
               2,
               None,
               'chain-rule-and-partial-derivatives'),
              ('System of Isolated Particles',
               2,
               None,
               'system-of-isolated-particles'),
              ('Work, Energy, Momentum and Conservation laws',
               2,
               None,
               'work-energy-momentum-and-conservation-laws'),
              ('Energy Conservation', 2, None, 'energy-conservation'),
              ('Net Energy', 2, None, 'net-energy'),
              ('In Vector Notation', 2, None, 'in-vector-notation'),
              ('Harmonic Oscillator Potential',
               2,
               None,
               'harmonic-oscillator-potential'),
              ('Symmetries and Conservation Laws',
               2,
               None,
               'symmetries-and-conservation-laws'),
              ('Translational Invariance', 2, None, 'translational-invariance'),
              ('Translational Invariance and Conservation of Momentum',
               2,
               None,
               'translational-invariance-and-conservation-of-momentum'),
              ('Bulding a code for the Earth-Sun system',
               2,
               None,
               'bulding-a-code-for-the-earth-sun-system'),
              ('Building a code for the solar system, final coupled equations',
               2,
               None,
               'building-a-code-for-the-solar-system-final-coupled-equations'),
              ('Building a code for the solar system, discretized equations',
               2,
               None,
               'building-a-code-for-the-solar-system-discretized-equations'),
              ("Code Example with Euler's Method",
               2,
               None,
               'code-example-with-euler-s-method'),
              ("Problems with Euler's Method",
               2,
               None,
               'problems-with-euler-s-method'),
              ('Deriving the Euler-Cromer Method',
               2,
               None,
               'deriving-the-euler-cromer-method'),
              ('Deriving the Velocity-Verlet Method',
               2,
               None,
               'deriving-the-velocity-verlet-method'),
              ('The velocity Verlet method',
               2,
               None,
               'the-velocity-verlet-method'),
              ('Adding the Velocity-Verlet Method',
               2,
               None,
               'adding-the-velocity-verlet-method')]}
end of tocinfo -->

<body>



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: {
     equationNumbers: {  autoNumber: "AMS"  },
     extensions: ["AMSmath.js", "AMSsymbols.js", "autobold.js", "color.js"]
  }
});
</script>
<script type="text/javascript" async
 src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



    
<!-- Bootstrap navigation bar -->
<div class="navbar navbar-default navbar-fixed-top">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-responsive-collapse">
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="week6-bs.html">PHY321: Conservative Forces, Momentum and Angular Momentum conservation</a>
  </div>

  <div class="navbar-collapse collapse navbar-responsive-collapse">
    <ul class="nav navbar-nav navbar-right">
      <li class="dropdown">
        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Contents <b class="caret"></b></a>
        <ul class="dropdown-menu">
     <!-- navigation toc: --> <li><a href="#aims-and-overarching-motivation" style="font-size: 80%;"><b>Aims and Overarching Motivation</b></a></li>
     <!-- navigation toc: --> <li><a href="#monday" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Monday</a></li>
     <!-- navigation toc: --> <li><a href="#wednesday" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Wednesday</a></li>
     <!-- navigation toc: --> <li><a href="#friday" style="font-size: 80%;">&nbsp;&nbsp;&nbsp;Friday</a></li>
     <!-- navigation toc: --> <li><a href="#work-energy-theorem-and-energy-conservation" style="font-size: 80%;"><b>Work-Energy Theorem and Energy Conservation</b></a></li>
     <!-- navigation toc: --> <li><a href="#conservation-of-energy" style="font-size: 80%;"><b>Conservation of energy</b></a></li>
     <!-- navigation toc: --> <li><a href="#what-is-a-conservative-force" style="font-size: 80%;"><b>What is a Conservative Force?</b></a></li>
     <!-- navigation toc: --> <li><a href="#two-important-conditions" style="font-size: 80%;"><b>Two important conditions</b></a></li>
     <!-- navigation toc: --> <li><a href="#work-energy-theorem-to-show-that-energy-is-conserved-with-a-conservative-force" style="font-size: 80%;"><b>Work-energy theorem to show that energy is conserved with a conservative force</b></a></li>
     <!-- navigation toc: --> <li><a href="#conservation-of-momentum" style="font-size: 80%;"><b>Conservation of Momentum</b></a></li>
     <!-- navigation toc: --> <li><a href="#two-objects-first" style="font-size: 80%;"><b>Two objects first</b></a></li>
     <!-- navigation toc: --> <li><a href="#newton-s-third-law" style="font-size: 80%;"><b>Newton's Third Law</b></a></li>
     <!-- navigation toc: --> <li><a href="#newton-s-second-law-and-momentum" style="font-size: 80%;"><b>Newton's Second Law and Momentum</b></a></li>
     <!-- navigation toc: --> <li><a href="#the-total-momentum" style="font-size: 80%;"><b>The total Momentum</b></a></li>
     <!-- navigation toc: --> <li><a href="#newton-s-second-law" style="font-size: 80%;"><b>Newton's Second Law</b></a></li>
     <!-- navigation toc: --> <li><a href="#summing-over-all-objects-particles" style="font-size: 80%;"><b>Summing over all Objects/Particles</b></a></li>
     <!-- navigation toc: --> <li><a href="#conservation-of-total-momentum" style="font-size: 80%;"><b>Conservation of total Momentum</b></a></li>
     <!-- navigation toc: --> <li><a href="#example-rocket-science" style="font-size: 80%;"><b>Example: Rocket Science</b></a></li>
     <!-- navigation toc: --> <li><a href="#integrating-the-equations" style="font-size: 80%;"><b>Integrating the Equations</b></a></li>
     <!-- navigation toc: --> <li><a href="#rate-of-change" style="font-size: 80%;"><b>Rate of Change</b></a></li>
     <!-- navigation toc: --> <li><a href="#conservation-of-angular-momentum" style="font-size: 80%;"><b>Conservation of Angular Momentum</b></a></li>
     <!-- navigation toc: --> <li><a href="#rate-of-change-of-angular-momentum" style="font-size: 80%;"><b>Rate of Change of Angular Momentum</b></a></li>
     <!-- navigation toc: --> <li><a href="#the-torque-example-1-hw-4-exercise-4" style="font-size: 80%;"><b>The Torque, Example 1 (hw 4, exercise 4)</b></a></li>
     <!-- navigation toc: --> <li><a href="#the-torque-example-1-hw-4-exercise-4" style="font-size: 80%;"><b>The Torque, Example 1 (hw 4, exercise 4)</b></a></li>
     <!-- navigation toc: --> <li><a href="#the-torque-example-1-hw-4-exercise-4" style="font-size: 80%;"><b>The Torque, Example 1 (hw 4, exercise 4)</b></a></li>
     <!-- navigation toc: --> <li><a href="#the-torque-example-2" style="font-size: 80%;"><b>The Torque, Example 2</b></a></li>
     <!-- navigation toc: --> <li><a href="#chain-rule-and-partial-derivatives" style="font-size: 80%;"><b>Chain Rule and Partial Derivatives</b></a></li>
     <!-- navigation toc: --> <li><a href="#system-of-isolated-particles" style="font-size: 80%;"><b>System of Isolated Particles</b></a></li>
     <!-- navigation toc: --> <li><a href="#work-energy-momentum-and-conservation-laws" style="font-size: 80%;"><b>Work, Energy, Momentum and Conservation laws</b></a></li>
     <!-- navigation toc: --> <li><a href="#energy-conservation" style="font-size: 80%;"><b>Energy Conservation</b></a></li>
     <!-- navigation toc: --> <li><a href="#net-energy" style="font-size: 80%;"><b>Net Energy</b></a></li>
     <!-- navigation toc: --> <li><a href="#in-vector-notation" style="font-size: 80%;"><b>In Vector Notation</b></a></li>
     <!-- navigation toc: --> <li><a href="#harmonic-oscillator-potential" style="font-size: 80%;"><b>Harmonic Oscillator Potential</b></a></li>
     <!-- navigation toc: --> <li><a href="#symmetries-and-conservation-laws" style="font-size: 80%;"><b>Symmetries and Conservation Laws</b></a></li>
     <!-- navigation toc: --> <li><a href="#translational-invariance" style="font-size: 80%;"><b>Translational Invariance</b></a></li>
     <!-- navigation toc: --> <li><a href="#translational-invariance-and-conservation-of-momentum" style="font-size: 80%;"><b>Translational Invariance and Conservation of Momentum</b></a></li>
     <!-- navigation toc: --> <li><a href="#bulding-a-code-for-the-earth-sun-system" style="font-size: 80%;"><b>Bulding a code for the Earth-Sun system</b></a></li>
     <!-- navigation toc: --> <li><a href="#building-a-code-for-the-solar-system-final-coupled-equations" style="font-size: 80%;"><b>Building a code for the solar system, final coupled equations</b></a></li>
     <!-- navigation toc: --> <li><a href="#building-a-code-for-the-solar-system-discretized-equations" style="font-size: 80%;"><b>Building a code for the solar system, discretized equations</b></a></li>
     <!-- navigation toc: --> <li><a href="#code-example-with-euler-s-method" style="font-size: 80%;"><b>Code Example with Euler's Method</b></a></li>
     <!-- navigation toc: --> <li><a href="#problems-with-euler-s-method" style="font-size: 80%;"><b>Problems with Euler's Method</b></a></li>
     <!-- navigation toc: --> <li><a href="#deriving-the-euler-cromer-method" style="font-size: 80%;"><b>Deriving the Euler-Cromer Method</b></a></li>
     <!-- navigation toc: --> <li><a href="#deriving-the-velocity-verlet-method" style="font-size: 80%;"><b>Deriving the Velocity-Verlet Method</b></a></li>
     <!-- navigation toc: --> <li><a href="#the-velocity-verlet-method" style="font-size: 80%;"><b>The velocity Verlet method</b></a></li>
     <!-- navigation toc: --> <li><a href="#adding-the-velocity-verlet-method" style="font-size: 80%;"><b>Adding the Velocity-Verlet Method</b></a></li>

        </ul>
      </li>
    </ul>
  </div>
</div>
</div> <!-- end of navigation bar -->

<div class="container">

<p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p> <!-- add vertical space -->

<!-- ------------------- main content ---------------------- -->



<div class="jumbotron">
<center><h1>PHY321: Conservative Forces, Momentum and Angular Momentum conservation</h1></center>  <!-- document title -->

<p>
<!-- author(s): <a href="http://mhjgit.github.io/info/doc/web/" target="_self">Morten Hjorth-Jensen</a> -->

<center>
<b><a href="http://mhjgit.github.io/info/doc/web/" target="_self">Morten Hjorth-Jensen</a></b> [1, 2]
</center>

<p>
<!-- institution(s) -->

<center>[1] <b>Department of Physics and Astronomy and Facility for Rare Ion Beams (FRIB), Michigan State University, USA</b></center>
<center>[2] <b>Department of Physics, University of Oslo, Norway</b></center>
<br>
<p>
<center><h4>Feb 10, 2021</h4></center> <!-- date -->
<br>
<p>
<!-- potential-jumbotron-button -->
</div> <!-- end jumbotron -->

<!-- !split -->

<h2 id="aims-and-overarching-motivation" class="anchor">Aims and Overarching Motivation </h2>

<h3 id="monday" class="anchor">Monday </h3>

<p>
Short repetition from last week. Discussion of momentum and angular momentum.
Reading suggestion: Taylor sections 3.1-3.4

<h3 id="wednesday" class="anchor">Wednesday </h3>

<p>
More on angular momentum, Taylor sections 3.4 and 3.5. Discussion of potential energy and conservative forces.
Reading suggestions: Taylor section 4.2

<h3 id="friday" class="anchor">Friday </h3>

<p>
Conservative forces and potential energy. Reading suggestion: Taylor sections 4.2-4.4

<p>
If you wish to read more about conservative forces or not, Feyman's lectures from 1963 are quite interesting.
He states for example that <b>All fundamental forces in nature appear to be conservative</b>.
This statement was made while developing his argument that <em>there are no nonconservative forces</em>.
You may enjoy the link to <a href="http://www.feynmanlectures.caltech.edu/I_14.html" target="_self">Feynman's lecture</a>.

<p>
<!-- !split -->

<h2 id="work-energy-theorem-and-energy-conservation" class="anchor">Work-Energy Theorem and Energy Conservation  </h2>

<p>
Last week (Friday) we observed that energy was conserved for a force which
depends only on the position.
In particular we considered a force acting on a block 
attached to a spring with spring
constant \( k \). The other end of the spring was attached to the wall.

<p>
The force \( F_x \) from the spring on the block was defined as
$$
F_x=-kx.
$$

<p>
The work done on the block due to a displacement from a position \( x_0 \) to \( x \) 
$$
W=\int_{x_0}^{x}F_xdx'=\frac{1}{2}kx_0^2-\frac{1}{2}kx^2.
$$

<p>
<!-- !split -->

<h2 id="conservation-of-energy" class="anchor">Conservation of energy </h2>
With the definition of the work-energy theorem in terms of the kinetic energy we obtained

$$
W=\frac{1}{2}mv^2(x)-\frac{1}{2}mv_0^2=\frac{1}{2}kx_0^2-\frac{1}{2}kx^2,
$$

which we rewrote as

$$
\frac{1}{2}mv^2(x)+\frac{1}{2}kx^2=\frac{1}{2}mv_0^2+\frac{1}{2}kx_0^2.
$$

<p>
The total energy, which is the sum of potential and kinetic energy, is conserved.
We will analyze this interesting result now in more detail when we study energy, momentum and angular momentum conservation.

<p>
But before we start with energy conservation, conservative forces and potential energies, we need to revisit our definitions of momentum and angular momentum.

<p>
<!-- !split -->

<h2 id="what-is-a-conservative-force" class="anchor">What is a Conservative Force? </h2>

<p>
A conservative force is a force whose property is that the total work
done in moving an object between two points is independent of the
taken path. This means that the work on an object under the influence
of a conservative force, is independent on the path of the object. It
depends only on the spatial degrees of freedom and it is possible to
assign a numerical value for the potential at any point. It leads to
conservation of energy. The gravitational force is an example of a
conservative force.

<p>
<!-- !split -->

<h2 id="two-important-conditions" class="anchor">Two important conditions </h2>

<p>
First, a conservative force depends only on the spatial degrees of freedom. This is a necessary condition for obtaining a path integral which is independent of path.
The  important condition for the final work to be independent of the path is that the <b>curl</b> of the force is zero, that
is
$$
\boldsymbol{\nabla} \times \boldsymbol{F}=0
$$

<p>
<!-- !split -->

<h2 id="work-energy-theorem-to-show-that-energy-is-conserved-with-a-conservative-force" class="anchor">Work-energy theorem to show that energy is conserved with a conservative force </h2>

<p>
The work-energy theorem states that the work done \( W \) by a force \( \boldsymbol{F} \) that moves an object from a position \( \boldsymbol{r}_0 \) to a new position \( \boldsymbol{r}_1 \)
$$
W=\int_{\boldsymbol{r}_0}^{\boldsymbol{r}_1}\boldsymbol{F}\boldsymbol{dr}=\frac{1}{2}mv_1^2-\frac{1}{2}mv_0^2,
$$

where \( v_1^2 \) is the velocity squared at a time \( t_1 \) and \( v_0^2 \) the corresponding quantity at a time \( t_0 \).
The work done is thus the difference in kinetic energies. We can rewrite the above equation as
$$
\frac{1}{2}mv_1^2=\int_{\boldsymbol{r}_0}^{\boldsymbol{r}_1}\boldsymbol{F}\boldsymbol{dr}+\frac{1}{2}mv_0^2,
$$

that is the final kinetic energy is equal to the initial kinetic energy plus the work done by the force over a given path from a  position \( \boldsymbol{r}_0 \) at time \( t_0 \) to a final position position \( \boldsymbol{r}_1 \) at a later time \( t_1 \).

<p>
<!-- !split -->

<h2 id="conservation-of-momentum" class="anchor">Conservation of Momentum </h2>

<p>
Before we move on however, we need to remind ourselves about important aspects like the linear momentum and angular momentum. After these considerations, we move back to more details about conservatives forces.

<p>
Assume we have \( N \) objects, each with velocity \( \boldsymbol{v}_i \) with
\( i=1,2,\dots,N \) and mass \( m_i \). The momentum of each object is
\( \boldsymbol{p}_i=m\boldsymbol{v}_i \) and the total linear (or mechanical) momentum is
defined as

$$
\boldsymbol{P}=\sum_{i=1}^N\boldsymbol{p}_i=\sum_{i=1}^Nm_i\boldsymbol{v}_i,
$$

<p>
<!-- !split -->

<h2 id="two-objects-first" class="anchor">Two objects first </h2>

<p>
Let us assume we have two objects only that interact with each other and are influenced by an external force.

<p>
We define also the total net force acting on object 1 as 

$$
\boldsymbol{F}_1^{\mathrm{net}}=\boldsymbol{F}_1^{\mathrm{ext}}+\boldsymbol{F}_{12},
$$

<p>
where \( \boldsymbol{F}_1^{\mathrm{ext}} \) is the external force
(for example the force due to an electron moving in an electromagnetic field) and \( \boldsymbol{F}_{12} \) is the
force between object one and two. Similarly for object 2 we have

$$
\boldsymbol{F}_2^{\mathrm{net}}=\boldsymbol{F}_2^{\mathrm{ext}}+\boldsymbol{F}_{21}.
$$

<p>
<!-- !split -->

<h2 id="newton-s-third-law" class="anchor">Newton's Third Law </h2>

<p>
Newton's third law which we met earlier states that <b>for every action there is an equal and opposite reaction</b>.
It is more accurately stated as

<p>
<b>if two bodies exert forces on each other, these forces are equal in magnitude and opposite in direction</b>.

<p>
This means that for two bodies \( i \) and \( j \), if the force on \( i \) due to \( j \) is called \( \boldsymbol{F}_{ij} \), then 

$$
\begin{equation}
\boldsymbol{F}_{ij}=-\boldsymbol{F}_{ji}. 
\label{_auto1}
\end{equation}
$$

<p>
For the abovementioned two objects we have thus \( \boldsymbol{F}_{12}=-\boldsymbol{F}_{21} \).

<p>
<!-- !split -->

<h2 id="newton-s-second-law-and-momentum" class="anchor">Newton's Second Law and Momentum </h2>

<p>
With the net forces acting on each object we can now related the momentum to the forces via

$$
\boldsymbol{F}_1^{\mathrm{net}}=m_1\boldsymbol{a}_i=m_1\frac{d\boldsymbol{v}_i}{dt}=\boldsymbol{F}_1^{\mathrm{ext}}+\boldsymbol{F}_{12},
$$

<p>
and 

$$
\boldsymbol{F}_2^{\mathrm{net}}=m_2\boldsymbol{a}_2=m_1\frac{d\boldsymbol{v}_i}{dt}=\boldsymbol{F}_2^{\mathrm{ext}}+\boldsymbol{F}_{21}.
$$

<p>
Recalling our definition for the linear momentum we have then

$$
\frac{d\boldsymbol{p}_1}{dt}=\boldsymbol{F}_1^{\mathrm{ext}}+\boldsymbol{F}_{12},
$$

<p>
and 

$$
\frac{d\boldsymbol{p}_2}{dt}=\boldsymbol{F}_2^{\mathrm{ext}}+\boldsymbol{F}_{21}.
$$

<p>
<!-- !split -->

<h2 id="the-total-momentum" class="anchor">The total Momentum </h2>

<p>
The total momentum \( \boldsymbol{P} \) is defined as the sum of the individual momenta, meaning that we can rewrite

$$
\boldsymbol{F}_1^{\mathrm{net}}+\boldsymbol{F}_2^{\mathrm{net}}=\frac{d\boldsymbol{p}_1}{dt}+\frac{d\boldsymbol{p}_2}{dt}=\frac{d\boldsymbol{P}}{dt},
$$

<p>
that is the derivate with respect to time of the total momentum. If we now
write the net forces as sums of the external plus internal forces
between the objects we have

$$
\frac{d\boldsymbol{P}}{dt}=\boldsymbol{F}_1^{\mathrm{ext}}+\boldsymbol{F}_{12}+\boldsymbol{F}_2^{\mathrm{ext}}+\boldsymbol{F}_{21}=\boldsymbol{F}_1^{\mathrm{ext}}+\boldsymbol{F}_2^{\mathrm{ext}}.
$$

<p>
The derivative of the total momentum is just <b>the sum of the external
forces</b>. If we assume that the external forces are zero and that only
internal (here two-body forces) are at play, we obtain the important
result that the derivative of the total momentum is zero. This means
again that the total momentum is a constant of the motion and
conserved quantity. This is a very important result that we will use
in many applications to come.

<p>
<!-- !split -->

<h2 id="newton-s-second-law" class="anchor">Newton's Second Law </h2>

<p>
Let us now general to several objects \( N \) and let us also assume that there are no external forces. We will label such a system as <b>an isolated system</b>.

<p>
Newton's second law, \( \boldsymbol{F}=m\boldsymbol{a} \), can be written for a particle \( i \) as

$$
\begin{equation}
\boldsymbol{F}_i=\sum_{j\ne i}^N \boldsymbol{F}_{ij}=m_i\boldsymbol{a}_i,
\label{_auto2}
\end{equation}
$$

<p>
where \( \boldsymbol{F}_i \) (a single subscript) denotes the net force acting on \( i \) from the other objects/particles.
Because the mass of \( i \) is fixed and we assume it does not change with time, one can see that

$$
\begin{equation}
\boldsymbol{F}_i=\frac{d}{dt}m_i\boldsymbol{v}_i=\sum_{j\ne i}^N\boldsymbol{F}_{ij}.
\label{_auto3}
\end{equation}
$$

<p>
<!-- !split -->

<h2 id="summing-over-all-objects-particles" class="anchor">Summing over all Objects/Particles </h2>

<p>
Now, one can sum over all the objects/particles and obtain

$$
\frac{d}{dt}\sum_i m_iv_i=\sum_{ij, i\ne j}^N\boldsymbol{F}_{ij}=0.
$$

<p>
How did we arrive at the last step?  We rewrote the double sum as

$$
\sum_{ij, i\ne j}^N\boldsymbol{F}_{ij}=\sum_i^N\sum_{j>i}\left(\boldsymbol{F}_{ij}+\boldsymbol{F}_{ji}\right),
$$

<p>
and using Newton's third law which states that
\( \boldsymbol{F}_{ij}=-\boldsymbol{F}_{ji} \), we obtain that the net sum over all  the two-particle
forces is zero when we only consider so-called <b>internal forces</b>.
Stated differently, the last step made use of the fact that for every
term \( ij \), there is an equivalent term \( ji \) with opposite
force. Because the momentum is defined as \( m\boldsymbol{v} \), for a system of
particles, we have thus

$$
\begin{equation}
\frac{d}{dt}\sum_im_i\boldsymbol{v}_i=0,~~{\rm for~isolated~particles}.
\label{_auto4}
\end{equation}
$$

<p>
<!-- !split -->

<h2 id="conservation-of-total-momentum" class="anchor">Conservation of total Momentum </h2>

<p>
By "isolated" one means that the only force acting on any particle \( i \)
are those originating from other particles in the sum, i.e. &quot;no
external&quot; forces. Thus, Newton's third law leads to the conservation
of total momentum,

$$
\boldsymbol{P}=\sum_i m_i\boldsymbol{v}_i,
$$

and we have
$$
\frac{d}{dt}\boldsymbol{P}=0.
$$

<p>
<!-- !split -->

<h2 id="example-rocket-science" class="anchor">Example: Rocket Science </h2>

<p>
Consider a rocket of mass \( M \) moving with velocity \( v \). After a
brief instant, the velocity of the rocket is \( v+\Delta v \) and the mass
is \( M-\Delta M \). Momentum conservation gives

$$
\begin{eqnarray*}
Mv&=&(M-\Delta M)(v+\Delta v)+\Delta M(v-v_e)\\
0&=&-\Delta Mv+M\Delta v+\Delta M(v-v_e),\\
0&=&M\Delta v-\Delta Mv_e.
\end{eqnarray*}
$$

<p>
In the second step we ignored the term \( \Delta M\Delta v \) because it is doubly small. The last equation gives

$$
\begin{eqnarray}
\Delta v&=&\frac{v_e}{M}\Delta M,\\
\nonumber
\frac{dv}{dt}&=&\frac{v_e}{M}\frac{dM}{dt}.
\end{eqnarray}
$$

<p>
<!-- !split -->

<h2 id="integrating-the-equations" class="anchor">Integrating the Equations </h2>

<p>
Integrating the expression with lower limits \( v_0=0 \) and \( M_0 \), one finds

$$
\begin{eqnarray*}
v&=&v_e\int_{M_0}^M \frac{dM'}{M'}\\
v&=&-v_e\ln(M/M_0)\\
&=&-v_e\ln[(M_0-\alpha t)/M_0].
\end{eqnarray*}
$$

<p>
Because the total momentum of an isolated system is constant, one can
also quickly see that the center of mass of an isolated system is also
constant. The center of mass is the average position of a set of
masses weighted by the mass,

$$
\begin{equation}
\bar{x}=\frac{\sum_im_ix_i}{\sum_i m_i}.
\label{_auto5}
\end{equation}
$$

<p>
<!-- !split -->

<h2 id="rate-of-change" class="anchor">Rate of Change </h2>

<p>
The rate of change of \( \bar{x} \) is

$$
\dot{\bar{x}}=\frac{1}{M}\sum_i m_i\dot{x}_i=\frac{1}{M}P_x.
$$

<p>
Thus if the total momentum is constant the center of mass moves at a
constant velocity, and if the total momentum is zero the center of
mass is fixed.

<p>
<!-- !split -->

<h2 id="conservation-of-angular-momentum" class="anchor">Conservation of Angular Momentum </h2>

<p>
The angular momentum is defined as

$$
\begin{equation}
\boldsymbol{L}=\boldsymbol{r}\times\boldsymbol{p}=m\boldsymbol{r}\times\boldsymbol{v}.
\label{_auto6}
\end{equation}
$$

<p>
It means that the angular momentum is perpendicular to the plane defined by position \( \boldsymbol{r} \) and the momentum \( \boldsymbol{p} \) via \( \boldsymbol{r}\times \boldsymbol{p} \).

<p>
<!-- !split -->

<h2 id="rate-of-change-of-angular-momentum" class="anchor">Rate of Change of Angular Momentum </h2>

<p>
The rate of change of the angular momentum is

$$
\frac{d\boldsymbol{L}}{dt}=m\boldsymbol{v}\times\boldsymbol{v}+m\boldsymbol{r}\times\dot{\boldsymbol{v}}=\boldsymbol{r}\times{\boldsymbol{F}}
$$

<p>
The first term is zero because \( \boldsymbol{v} \) is parallel to itself, and the
second term defines the so-called torque. If \( \boldsymbol{F} \) is parallel to \( \boldsymbol{r} \) then the torque is zero and we say that angular momentum is conserved.

<p>
If the force is not radial, \( \boldsymbol{r}\times\boldsymbol{F}\ne 0 \) as above, and angular momentum is no longer conserved,

$$
\begin{equation}
\frac{d\boldsymbol{L}}{dt}=\boldsymbol{r}\times\boldsymbol{F}\equiv\boldsymbol{\tau},
\label{_auto7}
\end{equation}
$$

<p>
where \( \boldsymbol{\tau} \) is the torque.

<p>
<!-- !split -->

<h2 id="the-torque-example-1-hw-4-exercise-4" class="anchor">The Torque, Example 1 (hw 4, exercise 4) </h2>

<p>
Let us assume we have an initial position \( \boldsymbol{r}_0=x_0\boldsymbol{e}_1+y_0\boldsymbol{e}_2 \) at a time \( t_0=0 \).
We add now a force in the positive \( x \)-direction
$$
\boldsymbol{F}=F_x\boldsymbol{e}_1=\frac{d\boldsymbol{p}}{dt},
$$

where we used the force as defined by the time derivative of the momentum.

<p>
We can use this force (and its pertinent acceleration) to find the velocity via the relation
$$
\boldsymbol{v}(t)=\boldsymbol{v}_0+\int_{t_0}^t\boldsymbol{a}dt',
$$

and with \( \boldsymbol{v}_0=0 \) we have
$$
\boldsymbol{v}(t)=\int_{t_0}^t\frac{\boldsymbol{F}}{m}dt',
$$

where \( m \) is the mass of the object.

<p>
<!-- !split -->

<h2 id="the-torque-example-1-hw-4-exercise-4" class="anchor">The Torque, Example 1 (hw 4, exercise 4) </h2>

<p>
Since the force acts only in the \( x \)-direction, we have after integration
$$
\boldsymbol{v}(t)=\frac{\boldsymbol{F}}{m}t=\frac{F_x}{m}t\boldsymbol{e}_1=v_x(t)\boldsymbol{e}_1.
$$

<p>
The momentum is in turn given by \( \boldsymbol{p}=p_x\boldsymbol{e}_1=mv_x\boldsymbol{e}_1=F_xt\boldsymbol{e}_1 \).

<p>
Integrating over time again we find the final position as (note the force depends only on the \( x \)-direction)
$$
\boldsymbol{r}(t)=(x_0+\frac{1}{2}\frac{F_x}{m}t^2) \boldsymbol{e}_1+y_0\boldsymbol{e}_2.
$$

There is no change in the position in the \( y \)-direction since the force acts only in the \( x \)-direction.

<p>
<!-- !split -->

<h2 id="the-torque-example-1-hw-4-exercise-4" class="anchor">The Torque, Example 1 (hw 4, exercise 4) </h2>

<p>
We can now compute the angular momentum given by
$$
\boldsymbol{l}=\boldsymbol{r}\times\boldsymbol{p}=\left[(x_0+\frac{1}{2}\frac{F_x}{m}t^2) \boldsymbol{e}_1+y_0\boldsymbol{e}_2\right]\times \frac{F_xt}{m}\boldsymbol{e}_1.
$$

Computing the cross product we find

$$
\boldsymbol{l}=-y_0F_xt\boldsymbol{e}_3=-y_0F_xt\boldsymbol{e}_z.
$$

The torque is the time derivative of the angular momentum and we have

$$
\boldsymbol{\tau}=-y_0F_x\boldsymbol{e}_3=-y_0F_x\boldsymbol{e}_z.
$$

The torque is non-zero and angular momentum is not conserved.

<p>
<!-- !split -->

<h2 id="the-torque-example-2" class="anchor">The Torque, Example 2 </h2>

<p>
One can write the torque about a given axis, which we will denote as \( \hat{z} \), in polar coordinates, where

$$
\begin{eqnarray}
x&=&r\sin\theta\cos\phi,~~y=r\sin\theta\cos\phi,~~z=r\cos\theta,
\end{eqnarray}
$$

to find the \( z \) component of the torque,

$$
\begin{eqnarray}
\tau_z&=&xF_y-yF_x\\
\nonumber
&=&-r\sin\theta\left\{\cos\phi \partial_y-\sin\phi \partial_x\right\}V(x,y,z).
\end{eqnarray}
$$

<p>
<!-- !split -->

<h2 id="chain-rule-and-partial-derivatives" class="anchor">Chain Rule and Partial Derivatives </h2>

<p>
One can use the chain rule to write the partial derivative w.r.t. \( \phi \) (keeping \( r \) and \( \theta \) fixed),

$$
\begin{eqnarray}
\partial_\phi&=&\frac{\partial x}{\partial\phi}\partial_x+\frac{\partial_y}{\partial\phi}\partial_y
+\frac{\partial z}{\partial\phi}\partial_z\\
\nonumber
&=&-r\sin\theta\sin\phi\partial_x+\sin\theta\cos\phi\partial_y.
\end{eqnarray}
$$

<p>
Combining the two equations,

$$
\begin{eqnarray}
\tau_z&=&-\partial_\phi V(r,\theta,\phi).
\end{eqnarray}
$$

<p>
Thus, if the potential is independent of the azimuthal angle \( \phi \),
there is no torque about the \( z \) axis and \( L_z \) is conserved.

<p>
<!-- !split -->

<h2 id="system-of-isolated-particles" class="anchor">System of Isolated Particles </h2>

<p>
For a system of isolated particles, one can write

$$
\begin{eqnarray}
\frac{d}{dt}\sum_i\boldsymbol{L}_i&=&\sum_{i\ne j}\boldsymbol{r}_i\times \boldsymbol{F}_{ij}\\
\nonumber
&=&\frac{1}{2}\sum_{i\ne j} \boldsymbol{r}_i\times \boldsymbol{F}_{ij}+\boldsymbol{r}_j\times\boldsymbol{F}_{ji}\\
\nonumber
&=&\frac{1}{2}\sum_{i\ne j} (\boldsymbol{r}_i-\boldsymbol{r}_j)\times\boldsymbol{F}_{ij}=0,
\end{eqnarray}
$$

<p>
where the last step used Newton's third law,
\( \boldsymbol{F}_{ij}=-\boldsymbol{F}_{ji} \). If the forces between the particles are
radial, i.e. \( \boldsymbol{F}_{ij} ~||~ (\boldsymbol{r}_i-\boldsymbol{r}_j) \), then each term in
the sum is zero and the net angular momentum is fixed. Otherwise, you
could imagine an isolated system that would start spinning
spontaneously.

<p>
<!-- !split -->

<h2 id="work-energy-momentum-and-conservation-laws" class="anchor">Work, Energy, Momentum and Conservation laws </h2>

<p>
Energy conservation is most convenient as a strategy for addressing
problems where time does not appear. For example, a particle goes
from position \( x_0 \) with speed \( v_0 \), to position \( x_f \); what is its
new speed? However, it can also be applied to problems where time
does appear, such as in solving for the trajectory \( x(t) \), or
equivalently \( t(x) \).

<p>
<!-- !split -->

<h2 id="energy-conservation" class="anchor">Energy Conservation </h2>
Energy is conserved in the case where the potential energy, \( V(\boldsymbol{r}) \), depends only on position, and not on time. The force is determined by \( V \),
$$
\begin{equation}
\boldsymbol{F}(\boldsymbol{r})=-\nabla V(\boldsymbol{r}).
\label{_auto8}
\end{equation}
$$

<p>
<!-- !split -->

<h2 id="net-energy" class="anchor">Net Energy  </h2>

<p>
The net energy, \( E=V+K \) where \( K \) is the kinetic energy, is then conserved,

$$
\begin{eqnarray}
\frac{d}{dt}(K+V)&=&\frac{d}{dt}\left(\frac{m}{2}(v_x^2+v_y^2+v_z^2)+V(\boldsymbol{r})\right)\\
\nonumber
&=&m\left(v_x\frac{dv_x}{dt}+v_y\frac{dv_y}{dt}+v_z\frac{dv_z}{dt}\right)
+\partial_xV\frac{dx}{dt}+\partial_yV\frac{dy}{dt}+\partial_zV\frac{dz}{dt}\\
\nonumber
&=&v_xF_x+v_yF_y+v_zF_z-F_xv_x-F_yv_y-F_zv_z=0.
\end{eqnarray}
$$

<p>
<!-- !split -->

<h2 id="in-vector-notation" class="anchor">In Vector Notation  </h2>

<p>
The same proof can be written more compactly with vector notation,

$$
\begin{eqnarray}
\frac{d}{dt}\left(\frac{m}{2}v^2+V(\boldsymbol{r})\right)
&=&m\boldsymbol{v}\cdot\dot{\boldsymbol{v}}+\nabla V(\boldsymbol{r})\cdot\dot{\boldsymbol{r}}\\
\nonumber
&=&\boldsymbol{v}\cdot\boldsymbol{F}-\boldsymbol{F}\cdot\boldsymbol{v}=0.
\end{eqnarray}
$$

<p>
Inverting the expression for kinetic energy,
$$
\begin{equation}
v=\sqrt{2K/m}=\sqrt{2(E-V)/m},
\label{_auto9}
\end{equation}
$$

<p>
allows one to solve for the one-dimensional trajectory \( x(t) \), by finding \( t(x) \),

$$
\begin{equation}
t=\int_{x_0}^x \frac{dx'}{v(x')}=\int_{x_0}^x\frac{dx'}{\sqrt{2(E-V(x'))/m}}.
\label{_auto10}
\end{equation}
$$

<p>
Note this would be much more difficult in higher dimensions, because
you would have to determine which points, \( x,y,z \), the particles might
reach in the trajectory, whereas in one dimension you can typically
tell by simply seeing whether the kinetic energy is positive at every
point between the old position and the new position.

<p>
<!-- !split -->

<h2 id="harmonic-oscillator-potential" class="anchor">Harmonic Oscillator Potential </h2>

<p>
Consider a simple harmonic oscillator potential, \( V(x)=kx^2/2 \), with a particle emitted from \( x=0 \) with velocity \( v_0 \). Solve for the trajectory \( t(x) \),

$$
\begin{eqnarray}
t&=&\int_{0}^x \frac{dx'}{\sqrt{2(E-kx^2/2)/m}}\\
\nonumber
&=&\sqrt{m/k}\int_0^x~\frac{dx'}{\sqrt{x_{\rm max}^2-x^{\prime 2}}},~~~x_{\rm max}^2=2E/k.
\end{eqnarray}
$$

<p>
Here \( E=mv_0^2/2 \) and \( x_{\rm max} \) is defined as the maximum
displacement before the particle turns around. This integral is done
by the substitution \( \sin\theta=x/x_{\rm max} \).

$$
\begin{eqnarray}
(k/m)^{1/2}t&=&\sin^{-1}(x/x_{\rm max}),\\
\nonumber
x&=&x_{\rm max}\sin\omega t,~~~\omega=\sqrt{k/m}.
\end{eqnarray}
$$

<p>
<!-- !split -->

<h2 id="symmetries-and-conservation-laws" class="anchor">Symmetries and Conservation Laws </h2>

<p>
When we derived the conservation of energy, we assumed that the
potential depended only on position, not on time. If it depended
explicitly on time, one can quickly see that the energy would have
changed at a rate \( \partial_tV(x,y,z,t) \). Note that if there is no
explicit dependence on time, i.e. \( V(x,y,z) \), the potential energy can
depend on time through the variations of \( x,y,z \) with time. However,
that variation does not lead to energy non-conservation. Further, we
just saw that if a potential does not depend on the azimuthal angle
about some axis, \( \phi \), that the angular momentum about that axis is
conserved.

<p>
<!-- !split -->

<h2 id="translational-invariance" class="anchor">Translational Invariance </h2>

<p>
Now, we relate momentum conservation to translational
invariance. Considering a system of particles with positions,
\( \boldsymbol{r}_i \), if one changed the coordinate system by a translation by a
differential distance \( \boldsymbol{\epsilon} \), the net potential would change
by

$$
\begin{eqnarray}
\delta V(\boldsymbol{r}_1,\boldsymbol{r}_2\cdots)&=&\sum_i \boldsymbol{\epsilon}\cdot\nabla_i V(\boldsymbol{r}_1,\boldsymbol{r}_2,\cdots)\\
\nonumber
&=&-\sum_i \boldsymbol{\epsilon}\cdot\boldsymbol{F}_i\\
\nonumber
&=&-\frac{d}{dt}\sum_i \boldsymbol{\epsilon}\cdot\boldsymbol{p}_i.
\end{eqnarray}
$$

<p>
<!-- !split -->

<h2 id="translational-invariance-and-conservation-of-momentum" class="anchor">Translational Invariance and Conservation of Momentum </h2>

<p>
Thus, if the potential is unchanged by a translation of the coordinate
system, the total momentum is conserved. If the potential is
translationally invariant in a given direction, defined by a unit
vector, \( \hat{\epsilon} \) in the \( \boldsymbol{\epsilon} \) direction, one can see
that

$$
\begin{eqnarray}
\hat{\epsilon}\cdot\nabla_i V(\boldsymbol{r}_i)&=&0.
\end{eqnarray}
$$

<p>
The component of the total momentum along that axis is conserved. This
is rather obvious for a single particle. If \( V(\boldsymbol{r}) \) does not
depend on some coordinate \( x \), then the force in the \( x \) direction is
\( F_x=-\partial_xV=0 \), and momentum along the \( x \) direction is
constant.

<p>
We showed how the total momentum of an isolated system of particle was conserved, even if the particles feel internal forces in all directions. In that case the potential energy could be written 

$$
\begin{eqnarray}
V=\sum_{i,j\le i}V_{ij}(\boldsymbol{r}_i-\boldsymbol{r}_j).
\end{eqnarray}
$$

<p>
In this case, a translation leads to \( \boldsymbol{r}_i\rightarrow
\boldsymbol{r}_i+\boldsymbol{\epsilon} \), with the translation equally affecting the
coordinates of each particle. Because the potential depends only on
the relative coordinates, \( \delta V \) is manifestly zero. If one were
to go through the exercise of calculating \( \delta V \) for small
\( \boldsymbol{\epsilon} \), one would find that the term
\( \nabla_i V(\boldsymbol{r}_i-\boldsymbol{r}_j) \) would be canceled by the term
\( \nabla_jV(\boldsymbol{r}_i-\boldsymbol{r}_j) \).

<p>
The relation between symmetries of the potential and conserved
quantities (also called constants of motion) is one of the most
profound concepts one should gain from this course. It plays a
critical role in all fields of physics. This is especially true in
quantum mechanics, where a quantity \( A \) is conserved if its operator
commutes with the Hamiltonian. For example if the momentum operator
\( -i\hbar\partial_x \) commutes with the Hamiltonian, momentum is
conserved, and clearly this operator commutes if the Hamiltonian
(which represents the total energy, not just the potential) does not
depend on \( x \). Also in quantum mechanics the angular momentum operator
is \( L_z=-i\hbar\partial_\phi \). In fact, if the potential is unchanged
by rotations about some axis, angular momentum about that axis is
conserved. We return to this concept, from a more formal perspective,
later in the course when Lagrangian mechanics is presented.

<h2 id="bulding-a-code-for-the-earth-sun-system" class="anchor">Bulding a code for the Earth-Sun system </h2>

<p>
We will now venture into a study of a system which is energy
conserving. The aim is to see if we (since it is not possible to solve
the general equations analytically) we can develop stable numerical
algorithms whose results we can trust!

<p>
We solve the equations of motion numerically. We will also compute
quantities like the energy numerically.

<p>
We start with a simpler case first, the Earth-Sun system  in two dimensions only.  The gravitational force \( F_G \) on the earth from the sun is  
$$
\boldsymbol{F}_G=-\frac{GM_{\odot}M_E}{r^3}\boldsymbol{r},
$$

where \( G \) is the gravitational constant, 
$$
M_E=6\times 10^{24}\mathrm{Kg},
$$

the mass of Earth, 
$$
M_{\odot}=2\times 10^{30}\mathrm{Kg}, 
$$

the mass of the Sun and 
$$
r=1.5\times 10^{11}\mathrm{m}, 
$$

is the distance between Earth and the Sun. The latter defines what we call an astronomical unit <b>AU</b>.
From Newton's second law we have then for the \( x \) direction
$$
\frac{d^2x}{dt^2}=-\frac{F_{x}}{M_E},
$$

and
$$
\frac{d^2y}{dt^2}=-\frac{F_{y}}{M_E},
$$

for the \( y \) direction.

<p>
Here we will use  that  \( x=r\cos{(\theta)} \), \( y=r\sin{(\theta)} \) and
$$
r = \sqrt{x^2+y^2}.
$$

We can rewrite 
$$
F_{x}=-\frac{GM_{\odot}M_E}{r^2}\cos{(\theta)}=-\frac{GM_{\odot}M_E}{r^3}x,
$$

and
$$
F_{y}=-\frac{GM_{\odot}M_E}{r^2}\sin{(\theta)}=-\frac{GM_{\odot}M_E}{r^3}y,
$$

for the \( y \) direction.

<p>
We can rewrite these two equations
$$
F_{x}=-\frac{GM_{\odot}M_E}{r^2}\cos{(\theta)}=-\frac{GM_{\odot}M_E}{r^3}x,
$$

and
$$
F_{y}=-\frac{GM_{\odot}M_E}{r^2}\sin{(\theta)}=-\frac{GM_{\odot}M_E}{r^3}y,
$$

as four first-order coupled differential equations
$$
\frac{dv_x}{dt}=-\frac{GM_{\odot}}{r^3}x,
$$

$$
\frac{dx}{dt}=v_x,
$$

$$
\frac{dv_y}{dt}=-\frac{GM_{\odot}}{r^3}y,
$$

$$
\frac{dy}{dt}=v_y.
$$

<p>
<!-- !split -->

<h2 id="building-a-code-for-the-solar-system-final-coupled-equations" class="anchor">Building a code for the solar system, final coupled equations </h2>

<p>
The four coupled differential equations
$$
\frac{dv_x}{dt}=-\frac{GM_{\odot}}{r^3}x,
$$

$$
\frac{dx}{dt}=v_x,
$$

$$
\frac{dv_y}{dt}=-\frac{GM_{\odot}}{r^3}y,
$$

$$
\frac{dy}{dt}=v_y,
$$

can be turned into dimensionless equations or we can introduce astronomical units with \( 1 \) AU = \( 1.5\times 10^{11} \).

<p>
Using the equations from circular motion (with \( r =1\mathrm{AU} \)) 
$$
\frac{M_E v^2}{r} = F = \frac{GM_{\odot}M_E}{r^2},
$$

we have
$$
GM_{\odot}=v^2r,
$$

and using that the velocity of Earth (assuming circular motion) is
\( v = 2\pi r/\mathrm{yr}=2\pi\mathrm{AU}/\mathrm{yr} \), we have
$$
GM_{\odot}= v^2r = 4\pi^2 \frac{(\mathrm{AU})^3}{\mathrm{yr}^2}.
$$

<p>
<!-- !split -->

<h2 id="building-a-code-for-the-solar-system-discretized-equations" class="anchor">Building a code for the solar system, discretized equations </h2>

<p>
The four coupled differential equations can then be discretized using Euler's method as (with step length \( h \))
$$
v_{x,i+1}=v_{x,i}-h\frac{4\pi^2}{r_i^3}x_i,
$$

$$
x_{i+1}=x_i+hv_{x,i},
$$

$$
v_{y,i+1}=v_{y,i}-h\frac{4\pi^2}{r_i^3}y_i,
$$

$$
y_{i+1}=y_i+hv_{y,i},
$$

<p>
<!-- !split -->

<h2 id="code-example-with-euler-s-method" class="anchor">Code Example with Euler's Method </h2>

<p>
The code here implements Euler's method for the Earth-Sun system using a more compact way of representing the vectors. Alternatively, you could have spelled out all the variables \( v_x \), \( v_y \), \( x \) and \( y \) as one-dimensional arrays.

<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span><span style="color: #408080; font-style: italic"># Common imports</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">numpy</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">np</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">pandas</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">pd</span>
<span style="color: #008000; font-weight: bold">from</span> <span style="color: #0000FF; font-weight: bold">math</span> <span style="color: #008000; font-weight: bold">import</span> <span style="color: #666666">*</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008000; font-weight: bold">as</span> <span style="color: #0000FF; font-weight: bold">plt</span>
<span style="color: #008000; font-weight: bold">import</span> <span style="color: #0000FF; font-weight: bold">os</span>

<span style="color: #408080; font-style: italic"># Where to save the figures and data files</span>
PROJECT_ROOT_DIR <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;Results&quot;</span>
FIGURE_ID <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;Results/FigureFiles&quot;</span>
DATA_ID <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;DataFiles/&quot;</span>

<span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>exists(PROJECT_ROOT_DIR):
    os<span style="color: #666666">.</span>mkdir(PROJECT_ROOT_DIR)

<span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>exists(FIGURE_ID):
    os<span style="color: #666666">.</span>makedirs(FIGURE_ID)

<span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>exists(DATA_ID):
    os<span style="color: #666666">.</span>makedirs(DATA_ID)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">image_path</span>(fig_id):
    <span style="color: #008000; font-weight: bold">return</span> os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>join(FIGURE_ID, fig_id)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">data_path</span>(dat_id):
    <span style="color: #008000; font-weight: bold">return</span> os<span style="color: #666666">.</span>path<span style="color: #666666">.</span>join(DATA_ID, dat_id)

<span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">save_fig</span>(fig_id):
    plt<span style="color: #666666">.</span>savefig(image_path(fig_id) <span style="color: #666666">+</span> <span style="color: #BA2121">&quot;.png&quot;</span>, <span style="color: #008000">format</span><span style="color: #666666">=</span><span style="color: #BA2121">&#39;png&#39;</span>)


DeltaT <span style="color: #666666">=</span> <span style="color: #666666">0.001</span>
<span style="color: #408080; font-style: italic">#set up arrays </span>
tfinal <span style="color: #666666">=</span> <span style="color: #666666">10</span> <span style="color: #408080; font-style: italic"># in years</span>
n <span style="color: #666666">=</span> ceil(tfinal<span style="color: #666666">/</span>DeltaT)
<span style="color: #408080; font-style: italic"># set up arrays for t, a, v, and x</span>
t <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(n)
v <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((n,<span style="color: #666666">2</span>))
r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((n,<span style="color: #666666">2</span>))
<span style="color: #408080; font-style: italic"># Initial conditions as compact 2-dimensional arrays</span>
r0 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array([<span style="color: #666666">1.0</span>,<span style="color: #666666">0.0</span>])
v0 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array([<span style="color: #666666">0.0</span>,<span style="color: #666666">2*</span>pi])
r[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> r0
v[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> v0
Fourpi2 <span style="color: #666666">=</span> <span style="color: #666666">4*</span>pi<span style="color: #666666">*</span>pi
<span style="color: #408080; font-style: italic"># Start integrating using Euler&#39;s method</span>
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(n<span style="color: #666666">-1</span>):
    <span style="color: #408080; font-style: italic"># Set up the acceleration</span>
    <span style="color: #408080; font-style: italic"># Here you could have defined your own function for this</span>
    rabs <span style="color: #666666">=</span> sqrt(<span style="color: #008000">sum</span>(r[i]<span style="color: #666666">*</span>r[i]))
    a <span style="color: #666666">=</span>  <span style="color: #666666">-</span>Fourpi2<span style="color: #666666">*</span>r[i]<span style="color: #666666">/</span>(rabs<span style="color: #666666">**3</span>)
    <span style="color: #408080; font-style: italic"># update velocity, time and position using Euler&#39;s forward method</span>
    v[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> v[i] <span style="color: #666666">+</span> DeltaT<span style="color: #666666">*</span>a
    r[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> r[i] <span style="color: #666666">+</span> DeltaT<span style="color: #666666">*</span>v[i]
    t[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> t[i] <span style="color: #666666">+</span> DeltaT
<span style="color: #408080; font-style: italic"># Plot position as function of time    </span>
fig, ax <span style="color: #666666">=</span> plt<span style="color: #666666">.</span>subplots()
<span style="color: #408080; font-style: italic">#ax.set_xlim(0, tfinal)</span>
ax<span style="color: #666666">.</span>set_ylabel(<span style="color: #BA2121">&#39;x[m]&#39;</span>)
ax<span style="color: #666666">.</span>set_xlabel(<span style="color: #BA2121">&#39;y[m]&#39;</span>)
ax<span style="color: #666666">.</span>plot(r[:,<span style="color: #666666">0</span>], r[:,<span style="color: #666666">1</span>])
fig<span style="color: #666666">.</span>tight_layout()
save_fig(<span style="color: #BA2121">&quot;EarthSunEuler&quot;</span>)
plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
<!-- !split -->

<h2 id="problems-with-euler-s-method" class="anchor">Problems with Euler's Method </h2>

<p>
We notice here that Euler's method doesn't give a stable orbit. It
means that we cannot trust Euler's method. In a deeper way, as we will
see in homework 5, Euler's method does not conserve energy. It is an
example of an integrator which is not
<a href="https://en.wikipedia.org/wiki/Symplectic_integrator" target="_self">symplectic</a>.

<p>
Here we present thus two methods, which with simple changes allow us to avoid these pitfalls. The simplest possible extension is the so-called Euler-Cromer method.
The changes we need to make to our code are indeed marginal here.
We need simply to replace
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>    r[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> r[i] <span style="color: #666666">+</span> DeltaT<span style="color: #666666">*</span>v[i]
</pre></div>
<p>
in the above code with the velocity at the new time \( t_{i+1} \)
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>    r[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> r[i] <span style="color: #666666">+</span> DeltaT<span style="color: #666666">*</span>v[i<span style="color: #666666">+1</span>]
</pre></div>
<p>
By this simple caveat we get stable orbits.
Below we derive the Euler-Cromer method as well as one of the most utlized algorithms for sovling the above type of problems, the so-called Velocity-Verlet method.

<p>
<!-- !split -->

<h2 id="deriving-the-euler-cromer-method" class="anchor">Deriving the Euler-Cromer Method </h2>

<p>
Let us repeat Euler's method.
We have a differential equation
$$
\begin{equation}
y'(t_i)=f(t_i,y_i)   
\label{_auto11}
\end{equation}
$$

and if we truncate at the first derivative, we have from the Taylor expansion
$$
\begin{equation}
y_{i+1}=y(t_i) + (\Delta t) f(t_i,y_i) + O(\Delta t^2), \label{eq:euler}
\end{equation}
$$

which when complemented with \( t_{i+1}=t_i+\Delta t \) forms
the algorithm for the well-known Euler method. 
Note that at every step we make an approximation error
of the order of \( O(\Delta t^2) \), however the total error is the sum over all
steps \( N=(b-a)/(\Delta t) \) for \( t\in [a,b] \), yielding thus a global error which goes like
\( NO(\Delta t^2)\approx O(\Delta t) \).

<p>
To make Euler's method more precise we can obviously
decrease \( \Delta t \) (increase \( N \)), but this can lead to loss of numerical precision.
Euler's method is not recommended for precision calculation,
although it is handy to use in order to get a first
view on how a solution may look like.

<p>
Euler's method is asymmetric in time, since it uses information about the derivative at the beginning
of the time interval. This means that we evaluate the position at \( y_1 \) using the velocity
at \( v_0 \). A simple variation is to determine \( x_{n+1} \) using the velocity at
\( v_{n+1} \), that is (in a slightly more generalized form)
$$
\begin{equation} 
y_{n+1}=y_{n}+ v_{n+1}+O(\Delta t^2)
\label{_auto12}
\end{equation}
$$

and 
$$
\begin{equation}
v_{n+1}=v_{n}+(\Delta t) a_{n}+O(\Delta t^2).
\label{_auto13}
\end{equation}
$$

The acceleration \( a_n \) is a function of \( a_n(y_n, v_n, t_n) \) and needs to be evaluated
as well. This is the Euler-Cromer method.

<p>
<b>Exercise</b>: go back to the above code with Euler's method and add the Euler-Cromer method.

<p>
<!-- !split -->

<h2 id="deriving-the-velocity-verlet-method" class="anchor">Deriving the Velocity-Verlet Method </h2>

<p>
Let us stay with \( x \) (position) and \( v \) (velocity) as the quantities we are interested in.

<p>
We have the Taylor expansion for the position given by
$$
x_{i+1} = x_i+(\Delta t)v_i+\frac{(\Delta t)^2}{2}a_i+O((\Delta t)^3).
$$

The corresponding expansion for the velocity is 
$$
v_{i+1} = v_i+(\Delta t)a_i+\frac{(\Delta t)^2}{2}v^{(2)}_i+O((\Delta t)^3).
$$

Via Newton's second law we have normally an analytical expression for the derivative of the velocity, namely
$$
a_i= \frac{d^2 x}{dt^2}\vert_{i}=\frac{d v}{dt}\vert_{i}= \frac{F(x_i,v_i,t_i)}{m}.
$$

<p>
If we add to this the corresponding expansion for the derivative of the velocity 
$$
v^{(1)}_{i+1} = a_{i+1}= a_i+(\Delta t)v^{(2)}_i+O((\Delta t)^2)=a_i+(\Delta t)v^{(2)}_i+O((\Delta t)^2), 
$$

and retain only terms up to the second derivative of the velocity since our error goes as \( O(h^3) \), we have
$$
(\Delta t)v^{(2)}_i\approx a_{i+1}-a_i.
$$

We can then rewrite the Taylor expansion for the velocity as  
$$
v_{i+1} = v_i+\frac{(\Delta t)}{2}\left( a_{i+1}+a_{i}\right)+O((\Delta t)^3).
$$

<p>
<!-- !split -->

<h2 id="the-velocity-verlet-method" class="anchor">The velocity Verlet method </h2>

<p>
Our final equations for the position and the velocity become then 
$$
x_{i+1} = x_i+(\Delta t)v_i+\frac{(\Delta t)^2}{2}a_{i}+O((\Delta t)^3),
$$

and
$$
v_{i+1} = v_i+\frac{(\Delta t)}{2}\left(a_{i+1}+a_{i}\right)+O((\Delta t)^3). 
$$

Note well that the term \( a_{i+1} \) depends on the position at \( x_{i+1} \). This means that you need to calculate 
the position at the updated time \( t_{i+1} \) before the computing the next velocity.  Note also that the derivative of the velocity at the time
\( t_i \) used in the updating of the position can be reused in the calculation of the velocity update as well.

<p>
<!-- !split -->

<h2 id="adding-the-velocity-verlet-method" class="anchor">Adding the Velocity-Verlet Method </h2>

<p>
We can now easily add the Verlet method to our original code as
<p>

<!-- code=python (!bc pycod) typeset with pygments style "default" -->
<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%;"><span></span>DeltaT <span style="color: #666666">=</span> <span style="color: #666666">0.01</span>
<span style="color: #408080; font-style: italic">#set up arrays </span>
tfinal <span style="color: #666666">=</span> <span style="color: #666666">10</span>
n <span style="color: #666666">=</span> ceil(tfinal<span style="color: #666666">/</span>DeltaT)
<span style="color: #408080; font-style: italic"># set up arrays for t, a, v, and x</span>
t <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros(n)
v <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((n,<span style="color: #666666">2</span>))
r <span style="color: #666666">=</span> np<span style="color: #666666">.</span>zeros((n,<span style="color: #666666">2</span>))
<span style="color: #408080; font-style: italic"># Initial conditions as compact 2-dimensional arrays</span>
r0 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array([<span style="color: #666666">1.0</span>,<span style="color: #666666">0.0</span>])
v0 <span style="color: #666666">=</span> np<span style="color: #666666">.</span>array([<span style="color: #666666">0.0</span>,<span style="color: #666666">2*</span>pi])
r[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> r0
v[<span style="color: #666666">0</span>] <span style="color: #666666">=</span> v0
Fourpi2 <span style="color: #666666">=</span> <span style="color: #666666">4*</span>pi<span style="color: #666666">*</span>pi
<span style="color: #408080; font-style: italic"># Start integrating using the Velocity-Verlet  method</span>
<span style="color: #008000; font-weight: bold">for</span> i <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">range</span>(n<span style="color: #666666">-1</span>):
    <span style="color: #408080; font-style: italic"># Set up forces, air resistance FD, note now that we need the norm of the vecto</span>
    <span style="color: #408080; font-style: italic"># Here you could have defined your own function for this</span>
    rabs <span style="color: #666666">=</span> sqrt(<span style="color: #008000">sum</span>(r[i]<span style="color: #666666">*</span>r[i]))
    a <span style="color: #666666">=</span>  <span style="color: #666666">-</span>Fourpi2<span style="color: #666666">*</span>r[i]<span style="color: #666666">/</span>(rabs<span style="color: #666666">**3</span>)
    <span style="color: #408080; font-style: italic"># update velocity, time and position using the Velocity-Verlet method</span>
    r[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> r[i] <span style="color: #666666">+</span> DeltaT<span style="color: #666666">*</span>v[i]<span style="color: #666666">+0.5*</span>(DeltaT<span style="color: #666666">**2</span>)<span style="color: #666666">*</span>a
    rabs <span style="color: #666666">=</span> sqrt(<span style="color: #008000">sum</span>(r[i<span style="color: #666666">+1</span>]<span style="color: #666666">*</span>r[i<span style="color: #666666">+1</span>]))
    anew <span style="color: #666666">=</span> <span style="color: #666666">-4*</span>(pi<span style="color: #666666">**2</span>)<span style="color: #666666">*</span>r[i<span style="color: #666666">+1</span>]<span style="color: #666666">/</span>(rabs<span style="color: #666666">**3</span>)
    v[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> v[i] <span style="color: #666666">+</span> <span style="color: #666666">0.5*</span>DeltaT<span style="color: #666666">*</span>(a<span style="color: #666666">+</span>anew)
    t[i<span style="color: #666666">+1</span>] <span style="color: #666666">=</span> t[i] <span style="color: #666666">+</span> DeltaT
<span style="color: #408080; font-style: italic"># Plot position as function of time    </span>
fig, ax <span style="color: #666666">=</span> plt<span style="color: #666666">.</span>subplots()
ax<span style="color: #666666">.</span>set_ylabel(<span style="color: #BA2121">&#39;x[m]&#39;</span>)
ax<span style="color: #666666">.</span>set_xlabel(<span style="color: #BA2121">&#39;y[m]&#39;</span>)
ax<span style="color: #666666">.</span>plot(r[:,<span style="color: #666666">0</span>], r[:,<span style="color: #666666">1</span>])
fig<span style="color: #666666">.</span>tight_layout()
save_fig(<span style="color: #BA2121">&quot;EarthSunVV&quot;</span>)
plt<span style="color: #666666">.</span>show()
</pre></div>
<p>
You can easily generalize the calculation of the forces by defining a function
which takes in as input the various variables. We leave this as a challenge to you.

<p>

<!-- ------------------- end of main content --------------- -->

</div>  <!-- end container -->
<!-- include javascript, jQuery *first* -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://netdna.bootstrapcdn.com/bootstrap/3.0.0/js/bootstrap.min.js"></script>

<!-- Bootstrap footer
<footer>
<a href="https://..."><img width="250" align=right src="https://..."></a>
</footer>
-->


<center style="font-size:80%">
<!-- copyright --> &copy; 1999-2021, "Morten Hjorth-Jensen":"http://mhjgit.github.io/info/doc/web/". Released under CC Attribution-NonCommercial 4.0 license
</center>


</body>
</html>
    

