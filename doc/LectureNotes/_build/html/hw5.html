
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>13. PHY321: Classical Mechanics 1 &#8212; Classical mechanics</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="12. PHY321: Classical Mechanics 1" href="hw4.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Classical mechanics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   PHY321 Classical Mechanics I, Michigan State University, Spring 2021
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  About the course
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="schedule.html">
   Teaching schedule with links to material
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="teachers.html">
   Teachers and Grading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="textbooks.html">
   Textbooks
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Introductory Material
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter1.html">
   1. Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter2.html">
   2. Classical Mechanics, Mathematics and Numerical background
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter3.html">
   3. Simple Motion problems and Reminder on Newtonâ€™s Laws
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter4.html">
   4. Work, Energy, Momentum and Conservation laws
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Advanced Topics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter5.html">
   5. Harmonic Oscillations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter6.html">
   6. Two-body problems, from the Gravitational Force to Two-body Scattering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter7.html">
   7. Non-inertial Frames, Translation and Rotating Coordinate Systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter8.html">
   8. Variational Calculus and Lagrangian Formalism
  </a>
 </li>
</ul>
<p class="caption" role="heading">
 <span class="caption-text">
  Weekly assignments, midterms and final projects with solutions
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="hw1.html">
   9. PHY321: Classical Mechanics 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hw2.html">
   10. PHY321: Classical Mechanics 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hw3.html">
   11. PHY321: Classical Mechanics 1
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="hw4.html">
   12. PHY321: Classical Mechanics 1
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   13. PHY321: Classical Mechanics 1
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/hw5.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#practicalities-about-homeworks-and-projects">
   13.1. Practicalities about  homeworks and projects
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-to-homework-5">
   13.2. Introduction to homework 5
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-1-15-pt-work-energy-theorem-and-conservation-laws">
   13.3. Exercise 1 (15 pt), Work-energy theorem and conservation laws
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exsercise-2-15pt-rocket-momentum-and-mass">
   13.4. Exsercise 2 (15pt), Rocket, Momentum and mass
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-3-10pt-more-rockets">
   13.5. Exercise 3 (10pt), More Rockets
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-4-10pt-center-of-mass">
   13.6. Exercise 4 (10pt), Center of mass
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercise-5-10pt-and-6-40pt">
   13.7. Exercise 5 (10pt) and 6 (40pt)
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#answers">
   13.8. Answers
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <!-- HTML file automatically generated from DocOnce source (https://github.com/doconce/doconce/)
doconce format html solutionhw5.do.txt  -->
<!-- dom:TITLE: PHY321: Classical Mechanics 1 --><div class="tex2jax_ignore mathjax_ignore section" id="phy321-classical-mechanics-1">
<h1><span class="section-number">13. </span>PHY321: Classical Mechanics 1<a class="headerlink" href="#phy321-classical-mechanics-1" title="Permalink to this headline">Â¶</a></h1>
<p><strong>Homework 5, due Monday  February 22</strong></p>
<p>Date: <strong>Mar 5, 2022</strong></p>
<div class="section" id="practicalities-about-homeworks-and-projects">
<h2><span class="section-number">13.1. </span>Practicalities about  homeworks and projects<a class="headerlink" href="#practicalities-about-homeworks-and-projects" title="Permalink to this headline">Â¶</a></h2>
<ol class="simple">
<li><p>You can work in groups (optimal groups are often 2-3 people) or by yourself. If you work as a group you can hand in one answer only if you wish. <strong>Remember to write your name(s)</strong>!</p></li>
<li><p>Homeworks are available Wednesday/Thursday the week before the deadline. The deadline is at the Friday lecture.</p></li>
<li><p>How do I(we)  hand in?  You can hand in the paper and pencil exercises as a hand-written document. For this homework this applies to exercises 1-5. Alternatively, you can hand in everyhting (if you are ok with typing mathematical formulae using say Latex) as a jupyter notebook at D2L. The numerical exercise(s) (exercise 6 here) should always be handed in as a jupyter notebook by the deadline at D2L.</p></li>
</ol>
</div>
<div class="section" id="introduction-to-homework-5">
<h2><span class="section-number">13.2. </span>Introduction to homework 5<a class="headerlink" href="#introduction-to-homework-5" title="Permalink to this headline">Â¶</a></h2>
<p>This weekâ€™s sets of classical pen and paper and computational
exercises are a continuation of the topics from the previous homework set. We keep dealing with simple motion problems and conservation laws; energy, momentum and angular momentum. These conservation laws are central in Physics and understanding them properly lays the foundation for understanding and analyzing more complicated physics problems.
The relevant reading background is</p>
<ol class="simple">
<li><p>chapters 3 and 4 of Taylor (there are many good examples there) and</p></li>
<li><p>chapters 10-14 of Malthe-SÃ¸renssen.</p></li>
</ol>
<p>In both textbooks there are many nice worked out examples. Malthe-SÃ¸renssenâ€™s text contains also several coding examples you may find useful.</p>
<p>The numerical homework focuses on another motion problem where you can
use the code you developed in homework 4, almost entirely. Please take
a look at the posted solution (jupyter-notebook) for homework 4. You
need only to change the forces at play.</p>
</div>
<div class="section" id="exercise-1-15-pt-work-energy-theorem-and-conservation-laws">
<h2><span class="section-number">13.3. </span>Exercise 1 (15 pt), Work-energy theorem and conservation laws<a class="headerlink" href="#exercise-1-15-pt-work-energy-theorem-and-conservation-laws" title="Permalink to this headline">Â¶</a></h2>
<p>This exercise was partly discussed during the lectures. You can also find it in the online notes from the week of February 15-19.
We will study a classical electron which moves in the <span class="math notranslate nohighlight">\(x\)</span>-direction along a surface. The force from the surface is</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F}(x)=-F_0\sin{(\frac{2\pi x}{b})}\boldsymbol{e}_x.
\]</div>
<p>The constant <span class="math notranslate nohighlight">\(b\)</span> represents the distance between atoms at the surface of the material, <span class="math notranslate nohighlight">\(F_0\)</span> is a constant and <span class="math notranslate nohighlight">\(x\)</span> is the position of the electron.</p>
<ul class="simple">
<li><p>1a (2pt) Is this a conservative force? And if so, what does that imply?</p></li>
</ul>
<p>This is indeed a conservative force since it depends only on position and its <strong>curl</strong> is zero. This means that energy is conserved and the integral over the work done by the force is independent of the path taken.</p>
<ul class="simple">
<li><p>1b (4pt) Use the work-energy theorem to find the velocity <span class="math notranslate nohighlight">\(v(x)\)</span>.</p></li>
</ul>
<p>Using the work-energy theorem we can find the work <span class="math notranslate nohighlight">\(W\)</span> done when moving an electron from a position <span class="math notranslate nohighlight">\(x_\
0\)</span> to a final position <span class="math notranslate nohighlight">\(x\)</span> through the integral</p>
<div class="math notranslate nohighlight">
\[
W=\int_{x_0}^x \boldsymbol{F}(x')dx' =  -\int_{x_0}^x F_0\sin{(\frac{2\pi x'}{b})} dx',
\]</div>
<p>which results in</p>
<div class="math notranslate nohighlight">
\[
W=\frac{F_0b}{2\pi}\left[\cos{(\frac{2\pi x}{b})}-\cos{(\frac{2\pi x_0}{b})}\right].
\]</div>
<p>Since this is related to the change in kinetic energy we have, with <span class="math notranslate nohighlight">\(v_0\)</span> being the initial velocity at a  time <span class="math notranslate nohighlight">\(t_0\)</span>,</p>
<div class="math notranslate nohighlight">
\[
v  = \pm\sqrt{\frac{2}{m}\frac{F_0b}{2\pi}\left[\cos{(\frac{2\pi x}{b})}-\cos{(\frac{2\pi x_0}{b})}\right]+v_0^2}.
\]</div>
<ul class="simple">
<li><p>1c (4pt) With the above expression for the force, find the potential energy.</p></li>
</ul>
<p>The potential energy, due to energy conservation is</p>
<div class="math notranslate nohighlight">
\[
V(x)=V(x_0)+\frac{1}{2}mv_0^2-\frac{1}{2}mv^2,
\]</div>
<p>with <span class="math notranslate nohighlight">\(v\)</span> given by the previous answer.
We can now, in order to find a more explicit expression for the potential energy at a given value <span class="math notranslate nohighlight">\(x\)</span>, define a zero level value for the potential. The potential is defined , using the work-energy theorem , as</p>
<div class="math notranslate nohighlight">
\[
V(x)=V(x_0)+\int_{x_0}^x (-F(x'))dx',
\]</div>
<p>and if you recall the definition of the indefinite integral, we can rewrite this as</p>
<div class="math notranslate nohighlight">
\[
V(x)=\int (-F(x'))dx'+C,
\]</div>
<p>where <span class="math notranslate nohighlight">\(C\)</span> is an undefined constant. The force is defined as the gradient of the potential, and in that case the undefined constant vanishes. The constant does not affect the force we derive from the potential.</p>
<p>We have then</p>
<div class="math notranslate nohighlight">
\[
V(x)=V(x_0)-\int_{x_0}^x \boldsymbol{F}(x')dx',
\]</div>
<p>which results in</p>
<div class="math notranslate nohighlight">
\[
V(x)=\frac{F_0b}{2\pi}\left[\cos{(\frac{2\pi x}{b})}-\cos{(\frac{2\pi x_0}{b})}\right]+V(x_0).
\]</div>
<p>We can now define</p>
<div class="math notranslate nohighlight">
\[
\frac{F_0b}{2\pi}\cos{(\frac{2\pi x_0}{b})}=V(x_0),
\]</div>
<p>which gives</p>
<div class="math notranslate nohighlight">
\[
V(x)=\frac{F_0b}{2\pi}\left[\cos{(\frac{2\pi x}{b})}\right].
\]</div>
<ul class="simple">
<li><p>1d (5pt) Make a plot of the potential energy and discuss the equilibrium points where the force on the electron is zero. Discuss the physical interpretation of stable and unstable equilibrium points. Use energy conservation.</p></li>
</ul>
<p>The following Python code plots the potential</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">Deltax</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays</span>
<span class="n">xinitial</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0</span>
<span class="n">xfinal</span> <span class="o">=</span> <span class="mf">2.0</span> 
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">((</span><span class="n">xfinal</span><span class="o">-</span><span class="n">xinitial</span><span class="p">)</span><span class="o">/</span><span class="n">Deltax</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xinitial</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">Deltax</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Setting values for the constants. </span>
<span class="n">F0</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> <span class="n">b</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">;</span> 
<span class="c1"># Defining the potential</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">F0</span><span class="o">*</span><span class="n">b</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">b</span><span class="p">)</span>
<span class="c1"># Plot position as function of time    </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/hw5_27_0.png" src="_images/hw5_27_0.png" />
</div>
</div>
<p>We have stable equilibrium  points for every minimum of the <span class="math notranslate nohighlight">\(\cos\)</span> function and unstable equilibrium points where it has its maximimum values. At the minimum the particle has the lowest potential energy and the largest kinetic energy whereas at the maxima it has the largest potential energy and lowest kinetic energy.</p>
</div>
<div class="section" id="exsercise-2-15pt-rocket-momentum-and-mass">
<h2><span class="section-number">13.4. </span>Exsercise 2 (15pt), Rocket, Momentum and mass<a class="headerlink" href="#exsercise-2-15pt-rocket-momentum-and-mass" title="Permalink to this headline">Â¶</a></h2>
<p>Taylor exercise 3.11.    This exercise was partly discussed during the lectures, see the notes on <a class="reference external" href="https://mhjensen.github.io/Physics321/doc/pub/energyconserv/html/energyconserv.html">Energy and Momentum etc, see the part on Momentum conservation </a>. Taylorâ€™s chapter 3.2 covers also this example.</p>
<ul class="simple">
<li><p>3.11 a and b</p></li>
</ul>
<p>Consider the rocket of mass <span class="math notranslate nohighlight">\(M\)</span> moving with velocity <span class="math notranslate nohighlight">\(v\)</span>. After a
brief instant, the velocity of the rocket is <span class="math notranslate nohighlight">\(v+\Delta v\)</span> and the mass
is <span class="math notranslate nohighlight">\(M-\Delta M\)</span>. Momentum conservation gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
Mv&amp;=&amp;(M-\Delta M)(v+\Delta v)+\Delta M(v-v_e)\\
0&amp;=&amp;-\Delta Mv+M\Delta v+\Delta M(v-v_e),\\
0&amp;=&amp;M\Delta v-\Delta Mv_e.
\end{eqnarray*}
\end{split}\]</div>
<p>In the second step we ignored the term <span class="math notranslate nohighlight">\(\Delta M\Delta v\)</span> since we
assume it is small. The last equation gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\Delta v&amp;=&amp;\frac{v_e}{M}\Delta M,\\
\nonumber
\frac{dv}{dt}&amp;=&amp;\frac{v_e}{M}\frac{dM}{dt}.
\end{eqnarray}
\end{split}\]</div>
<p>Here we let <span class="math notranslate nohighlight">\(\Delta v\rightarrow dv\)</span> and <span class="math notranslate nohighlight">\(\Delta M\rightarrow dM\)</span>.
We have also assumed that <span class="math notranslate nohighlight">\(M(t) = M_0-kt\)</span>.
Integrating the expression with lower limits <span class="math notranslate nohighlight">\(v_0=0\)</span> and <span class="math notranslate nohighlight">\(M_0\)</span>, one finds</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
v&amp;=&amp;v_e\int_{M_0}^M \frac{dM'}{M'}\\
v&amp;=&amp;v_e\ln(M/M_0)\\
&amp;=&amp;v_e\ln[(M_0-k t)/M_0].
\end{eqnarray*}
\end{split}\]</div>
<p>We have ignored gravity here. If we add gravity as the external force, we get when integrating an additional terms <span class="math notranslate nohighlight">\(-gt\)</span>, that is</p>
<div class="math notranslate nohighlight">
\[
v=v_e\ln[(M_0-k t)/M_0]-gt.
\]</div>
<ul class="simple">
<li><p>3.11c</p></li>
</ul>
<p>Inserting numbers <span class="math notranslate nohighlight">\(v_e=3000\)</span> m/s, <span class="math notranslate nohighlight">\(M_0/M=2\)</span> and <span class="math notranslate nohighlight">\(g=9.8\)</span> m/s<span class="math notranslate nohighlight">\(^{2}\)</span>, we find <span class="math notranslate nohighlight">\(v=900\)</span> m/s. With <span class="math notranslate nohighlight">\(g=0\)</span> the corresponding number is <span class="math notranslate nohighlight">\(2100\)</span> m/s, so gravity reduces the speed acquired in the first two minutes to a little less than half its weight-free value.</p>
<ul class="simple">
<li><p>3.11d</p></li>
</ul>
<p>If the thrust <span class="math notranslate nohighlight">\(\Delta Mv_e\)</span> is less than the weight <span class="math notranslate nohighlight">\(mg\)</span>, the rocket will just sit on the ground until it has shed enough mass that the thrust can overcome the weight, definitely not a good design.</p>
</div>
<div class="section" id="exercise-3-10pt-more-rockets">
<h2><span class="section-number">13.5. </span>Exercise 3 (10pt), More Rockets<a class="headerlink" href="#exercise-3-10pt-more-rockets" title="Permalink to this headline">Â¶</a></h2>
<p>Taylor exercises 3.13 (5pt) and 3.14 (5pt). This is a continuation of the previous exercise and most of the relevant background material can be found in Taylor chapter 3.2.</p>
<p>Taking the velocity from the previous exercise and integrating over time we find the height</p>
<div class="math notranslate nohighlight">
\[
y(t) = y(t_0=0)+\int_0^tv(t')dt',
\]</div>
<p>which gives</p>
<div class="math notranslate nohighlight">
\[
y(t) = v_et\ln{M_0}-v_e\int_0^t \ln{M(t')}dt'-\frac{1}{2}gt^2.
\]</div>
<p>To do the integral over time we recall that <span class="math notranslate nohighlight">\(M(t')=M_0-\Delta M t'\)</span>. We assumed that <span class="math notranslate nohighlight">\(\Delta M=k\)</span> is a constant.
We use that <span class="math notranslate nohighlight">\(M_0-M=kt\)</span> and assume that mass decreases by a constant <span class="math notranslate nohighlight">\(k\)</span> times time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>We obtain then that the integral gives</p>
<div class="math notranslate nohighlight">
\[
\int_0^t \ln{M(t')}dt' = \int_0^t \ln{(M_0-kt')}dt',
\]</div>
<p>and defining the variable <span class="math notranslate nohighlight">\(u=M_0-kt'\)</span>, with <span class="math notranslate nohighlight">\(du=-kdt'\)</span> and the new limits <span class="math notranslate nohighlight">\(M_0\)</span> when <span class="math notranslate nohighlight">\(t=0\)</span> and <span class="math notranslate nohighlight">\(M_0-kt\)</span> when time is equal to <span class="math notranslate nohighlight">\(t\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[
\int_0^t \ln{M(t')}dt' = \int_0^t \ln{(M_0-kt')}dt'=-\frac{1}{k}\int_{M_0}^{M_0-kt} \ln{(u)}du=-\frac{1}{k}\left[u\ln{(u)}-u\right]_{M_0}^{M_0-kt},
\]</div>
<p>and writing out we obtain</p>
<div class="math notranslate nohighlight">
\[
-\frac{1}{k}\left[u\ln{(u)}-u\right]_{M_0}^{M_0-kt} = \frac{1}{k}\left(M_0\ln{M_0}-M\ln{M}\right)-t,
\]</div>
<p>Mulitplying with <span class="math notranslate nohighlight">\(-v_e\)</span> we have</p>
<div class="math notranslate nohighlight">
\[
-\frac{v_e}{k}\left(M_0\ln{M_0}-M\ln{M}\right)+v_et,
\]</div>
<p>which we can rewrite as, using <span class="math notranslate nohighlight">\(M_0=M+kt\)</span>,</p>
<div class="math notranslate nohighlight">
\[
-\frac{v_e}{k}\left((M+kt)\ln{M_0}-M\ln{M}\right)+v_et=v_et-v_et\ln{M_0}-\frac{Mv_e}{k}\ln{(\frac{M_0}{M})}.
\]</div>
<p>Inserting into <span class="math notranslate nohighlight">\(y(t)\)</span> we obtain then</p>
<div class="math notranslate nohighlight">
\[
y(t) = v_et-\frac{1}{2}gt^2-\frac{Mv_e}{k}\ln{(\frac{M_0}{M})}.
\]</div>
<p>Using the numbers from the previous exercise with <span class="math notranslate nohighlight">\(t=2\)</span> min we obtain that <span class="math notranslate nohighlight">\(y\approx 40\)</span> km.</p>
<p>For exercise 3.14 (5pt) we have the equation of motion which reads <span class="math notranslate nohighlight">\(Ma=kv_e-bv\)</span> or</p>
<div class="math notranslate nohighlight">
\[
\frac{Mdv}{kv_e-bv}=dt.
\]</div>
<p>We have that <span class="math notranslate nohighlight">\(dM/dt =-k\)</span> (assumed a constant rate for mass change). We can then replace <span class="math notranslate nohighlight">\(dt\)</span> by <span class="math notranslate nohighlight">\(-dM/k\)</span> and we have</p>
<div class="math notranslate nohighlight">
\[
\frac{kdv}{kv_e-bv}=-\frac{dM}{M}.
\]</div>
<p>Integrating gives</p>
<div class="math notranslate nohighlight">
\[
v = \frac{kv_e}{b}\left[1-(\frac{M}{M_0})^{b/k}\right].
\]</div>
</div>
<div class="section" id="exercise-4-10pt-center-of-mass">
<h2><span class="section-number">13.6. </span>Exercise 4 (10pt), Center of mass<a class="headerlink" href="#exercise-4-10pt-center-of-mass" title="Permalink to this headline">Â¶</a></h2>
<p>Taylor exercise 3.20. Here Taylorâ€™s chapter 3.3 can be of use. This relation will turn out to be very useful when we discuss systems of many classical particles.</p>
<p>The definition of the center of mass for <span class="math notranslate nohighlight">\(N\)</span> objects can be written as</p>
<div class="math notranslate nohighlight">
\[
M\boldsymbol{R}=\sum_{i=1}^Nm_i\boldsymbol{r}_i,
\]</div>
<p>where <span class="math notranslate nohighlight">\(m_i\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{r}_i\)</span> are the masses and positions of object <span class="math notranslate nohighlight">\(i\)</span>, respectively.</p>
<p>Assume now that we have a collection of <span class="math notranslate nohighlight">\(N_1\)</span> objects with masses <span class="math notranslate nohighlight">\(m_{1i}\)</span> and positions <span class="math notranslate nohighlight">\(\boldsymbol{r}_{1i}\)</span>
with <span class="math notranslate nohighlight">\(i=1,\dots,N_1\)</span> and  a collection of <span class="math notranslate nohighlight">\(N_2\)</span> objects with masses <span class="math notranslate nohighlight">\(m_{2j}\)</span> and positions <span class="math notranslate nohighlight">\(\boldsymbol{r}_{2j}\)</span>
with <span class="math notranslate nohighlight">\(j=1,\dots,N_2\)</span>.</p>
<p>The total mass of the two-body system is <span class="math notranslate nohighlight">\(M=M_1+M_2=\sum_{i=1}^{N_1}m_{1i}+\sum_{j=1}^{N_2}m_{2j}\)</span>. The center of mass position <span class="math notranslate nohighlight">\(\boldsymbol{R}\)</span> of the whole system satisfies then</p>
<div class="math notranslate nohighlight">
\[
M\boldsymbol{R}=\sum_{i=1}^{N_1}m_{1i}\boldsymbol{r}_{1i}+\sum_{j=1}^{N_2}m_{2j}\boldsymbol{r}_{2j}=M_1\boldsymbol{R}_1+M_2\boldsymbol{R}_2,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{R}_1\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{R}_2\)</span> are the the center of mass positions of the two separate bodies and the second equality follows from our rewritten definition of the center of mass applied to each body separately. This is the required result.</p>
</div>
<div class="section" id="exercise-5-10pt-and-6-40pt">
<h2><span class="section-number">13.7. </span>Exercise 5 (10pt) and 6 (40pt)<a class="headerlink" href="#exercise-5-10pt-and-6-40pt" title="Permalink to this headline">Â¶</a></h2>
</div>
<div class="section" id="answers">
<h2><span class="section-number">13.8. </span>Answers<a class="headerlink" href="#answers" title="Permalink to this headline">Â¶</a></h2>
<p>We start with a simpler case first, the Earth-Sun system  in two dimensions only.  The gravitational force <span class="math notranslate nohighlight">\(F_G\)</span> on the earth from the sun is</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F}_G=-\frac{GM_{\odot}M_E}{r^3}\boldsymbol{r},
\]</div>
<p>where <span class="math notranslate nohighlight">\(G\)</span> is the gravitational constant,</p>
<div class="math notranslate nohighlight">
\[
M_E=6\times 10^{24}\mathrm{Kg},
\]</div>
<p>the mass of Earth,</p>
<div class="math notranslate nohighlight">
\[
M_{\odot}=2\times 10^{30}\mathrm{Kg},
\]</div>
<p>the mass of the Sun and</p>
<div class="math notranslate nohighlight">
\[
r=1.5\times 10^{11}\mathrm{m},
\]</div>
<p>is the distance between Earth and the Sun. The latter defines what we call an astronomical unit <strong>AU</strong>.
From Newtonâ€™s second law we have then for the <span class="math notranslate nohighlight">\(x\)</span> direction</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{dt^2}=-\frac{F_{x}}{M_E},
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2y}{dt^2}=-\frac{F_{y}}{M_E},
\]</div>
<p>for the <span class="math notranslate nohighlight">\(y\)</span> direction.</p>
<p>Here we will use  that  <span class="math notranslate nohighlight">\(x=r\cos{(\theta)}\)</span>, <span class="math notranslate nohighlight">\(y=r\sin{(\theta)}\)</span> and</p>
<div class="math notranslate nohighlight">
\[
r = \sqrt{x^2+y^2}.
\]</div>
<p>We can rewrite these equations</p>
<div class="math notranslate nohighlight">
\[
F_{x}=-\frac{GM_{\odot}M_E}{r^2}\cos{(\theta)}=-\frac{GM_{\odot}M_E}{r^3}x,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
F_{y}=-\frac{GM_{\odot}M_E}{r^2}\sin{(\theta)}=-\frac{GM_{\odot}M_E}{r^3}y,
\]</div>
<p>as four first-order coupled differential equations</p>
<div class="math notranslate nohighlight">
\[
\frac{dv_x}{dt}=-\frac{GM_{\odot}}{r^3}x,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{dx}{dt}=v_x,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{dv_y}{dt}=-\frac{GM_{\odot}}{r^3}y,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{dy}{dt}=v_y.
\]</div>
<p>The four coupled differential equations</p>
<div class="math notranslate nohighlight">
\[
\frac{dv_x}{dt}=-\frac{GM_{\odot}}{r^3}x,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{dx}{dt}=v_x,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{dv_y}{dt}=-\frac{GM_{\odot}}{r^3}y,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{dy}{dt}=v_y,
\]</div>
<p>can be turned into dimensionless equations or we can introduce astronomical units with <span class="math notranslate nohighlight">\(1\)</span> AU = <span class="math notranslate nohighlight">\(1.5\times 10^{11}\)</span>.</p>
<p>Using the equations from circular motion (with <span class="math notranslate nohighlight">\(r =1\mathrm{AU}\)</span>)</p>
<div class="math notranslate nohighlight">
\[
\frac{M_E v^2}{r} = F = \frac{GM_{\odot}M_E}{r^2},
\]</div>
<p>we have</p>
<div class="math notranslate nohighlight">
\[
GM_{\odot}=v^2r,
\]</div>
<p>and using that the velocity of Earth (assuming circular motion) is
<span class="math notranslate nohighlight">\(v = 2\pi r/\mathrm{yr}=2\pi\mathrm{AU}/\mathrm{yr}\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[
GM_{\odot}= v^2r = 4\pi^2 \frac{(\mathrm{AU})^3}{\mathrm{yr}^2}.
\]</div>
<p>The four coupled differential equations can then be discretized using Eulerâ€™s method as (with step length <span class="math notranslate nohighlight">\(h\)</span>)</p>
<div class="math notranslate nohighlight">
\[
v_{x,i+1}=v_{x,i}-h\frac{4\pi^2}{r_i^3}x_i,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
x_{i+1}=x_i+hv_{x,i},
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
v_{y,i+1}=v_{y,i}-h\frac{4\pi^2}{r_i^3}y_i,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
y_{i+1}=y_i+hv_{y,i},
\]</div>
<p>The code here implements Eulerâ€™s method for the Earth-Sun system using a more compact way of representing the vectors. Alternatively, you could have spelled out all the variables <span class="math notranslate nohighlight">\(v_x\)</span>, <span class="math notranslate nohighlight">\(v_y\)</span>, <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> as one-dimensional arrays.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Where to save the figures and data files</span>
<span class="n">PROJECT_ROOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
<span class="n">FIGURE_ID</span> <span class="o">=</span> <span class="s2">&quot;Results/FigureFiles&quot;</span>
<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s2">&quot;DataFiles/&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">,</span> <span class="n">fig_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_path</span><span class="p">(</span><span class="n">dat_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">,</span> <span class="n">dat_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>


<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># in years</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, a, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># Initial conditions as compact 2-dimensional arrays</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">Fourpi2</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span>
<span class="c1"># Start integrating using Euler&#39;s method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up the acceleration</span>
    <span class="c1"># Here you could have defined your own function for this</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="n">Fourpi2</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position using Euler&#39;s forward method</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">a</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
<span class="c1"># Plot position as function of time    </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="c1">#ax.set_xlim(0, tfinal)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x[AU]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y[AU]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;EarthSunEuler&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/hw5_115_0.png" src="_images/hw5_115_0.png" />
</div>
</div>
<p>We notice here that Eulerâ€™s method doesnâ€™t give a stable orbit with for example <span class="math notranslate nohighlight">\(\Delta t =0.01\)</span>. It
means that we cannot trust Eulerâ€™s method. Eulerâ€™s method does not conserve energy. It is an
example of an integrator which is not
<a class="reference external" href="https://en.wikipedia.org/wiki/Symplectic_integrator">symplectic</a>.</p>
<p>Here we present thus two methods, which with simple changes allow us
to avoid these pitfalls. The simplest possible extension is the
so-called Euler-Cromer method.  The changes we need to make to our
code are indeed marginal here.  We need simply to replace</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>in the above code with the velocity at the new time <span class="math notranslate nohighlight">\(t_{i+1}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>By this simple caveat we get stable orbits.  Below we derive the
Euler-Cromer method as well as one of the most utlized algorithms for
solving the above type of problems, the so-called Velocity-Verlet
method.</p>
<p>Let us repeat Eulerâ€™s method.
We have a differential equation</p>
<!-- Equation labels as ordinary links -->
<div id="_auto1"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
  y'(t_i)=f(t_i,y_i)   
\label{_auto1} \tag{1}
\end{equation}
\]</div>
<p>and if we truncate at the first derivative, we have from the Taylor expansion</p>
<!-- Equation labels as ordinary links -->
<div id="eq:euler"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
   y_{i+1}=y(t_i) + (\Delta t) f(t_i,y_i) + O(\Delta t^2), \label{eq:euler} \tag{2}
\end{equation}
\]</div>
<p>which when complemented with <span class="math notranslate nohighlight">\(t_{i+1}=t_i+\Delta t\)</span> forms
the algorithm for the well-known Euler method.
Note that at every step we make an approximation error
of the order of <span class="math notranslate nohighlight">\(O(\Delta t^2)\)</span>, however the total error is the sum over all
steps <span class="math notranslate nohighlight">\(N=(b-a)/(\Delta t)\)</span> for <span class="math notranslate nohighlight">\(t\in [a,b]\)</span>, yielding thus a global error which goes like
<span class="math notranslate nohighlight">\(NO(\Delta t^2)\approx O(\Delta t)\)</span>.</p>
<p>To make Eulerâ€™s method more precise we can obviously
decrease <span class="math notranslate nohighlight">\(\Delta t\)</span> (increase <span class="math notranslate nohighlight">\(N\)</span>), but this can lead to loss of numerical precision.
Eulerâ€™s method is not recommended for precision calculation,
although it is handy to use in order to get a first
view on how a solution may look like.</p>
<p>Eulerâ€™s method is asymmetric in time, since it uses information about the derivative at the beginning
of the time interval. This means that we evaluate the position at <span class="math notranslate nohighlight">\(y_1\)</span> using the velocity
at <span class="math notranslate nohighlight">\(v_0\)</span>. A simple variation is to determine <span class="math notranslate nohighlight">\(x_{n+1}\)</span> using the velocity at
<span class="math notranslate nohighlight">\(v_{n+1}\)</span>, that is (in a slightly more generalized form)</p>
<!-- Equation labels as ordinary links -->
<div id="_auto2"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
   y_{n+1}=y_{n}+ v_{n+1}+O(\Delta t^2)
\label{_auto2} \tag{3}
\end{equation}
\]</div>
<p>and</p>
<!-- Equation labels as ordinary links -->
<div id="_auto3"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
   v_{n+1}=v_{n}+(\Delta t) a_{n}+O(\Delta t^2).
\label{_auto3} \tag{4}
\end{equation}
\]</div>
<p>The acceleration <span class="math notranslate nohighlight">\(a_n\)</span> is a function of <span class="math notranslate nohighlight">\(a_n(y_n, v_n, t_n)\)</span> and needs to be evaluated
as well. This is the Euler-Cromer method. It is easy to change the above code and see that with the same
time step we get stable results.</p>
<p>Let us stay with <span class="math notranslate nohighlight">\(x\)</span> (position) and <span class="math notranslate nohighlight">\(v\)</span> (velocity) as the quantities we are interested in.</p>
<p>We have the Taylor expansion for the position given by</p>
<div class="math notranslate nohighlight">
\[
x_{i+1} = x_i+(\Delta t)v_i+\frac{(\Delta t)^2}{2}a_i+O((\Delta t)^3).
\]</div>
<p>The corresponding expansion for the velocity is</p>
<div class="math notranslate nohighlight">
\[
v_{i+1} = v_i+(\Delta t)a_i+\frac{(\Delta t)^2}{2}v^{(2)}_i+O((\Delta t)^3).
\]</div>
<p>Via Newtonâ€™s second law we have normally an analytical expression for the derivative of the velocity, namely</p>
<div class="math notranslate nohighlight">
\[
a_i= \frac{d^2 x}{dt^2}\vert_{i}=\frac{d v}{dt}\vert_{i}= \frac{F(x_i,v_i,t_i)}{m}.
\]</div>
<p>If we add to this the corresponding expansion for the derivative of the velocity</p>
<div class="math notranslate nohighlight">
\[
v^{(1)}_{i+1} = a_{i+1}= a_i+(\Delta t)v^{(2)}_i+O((\Delta t)^2)=a_i+(\Delta t)v^{(2)}_i+O((\Delta t)^2),
\]</div>
<p>and retain only terms up to the second derivative of the velocity since our error goes as <span class="math notranslate nohighlight">\(O(h^3)\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[
(\Delta t)v^{(2)}_i\approx a_{i+1}-a_i.
\]</div>
<p>We can then rewrite the Taylor expansion for the velocity as</p>
<div class="math notranslate nohighlight">
\[
v_{i+1} = v_i+\frac{(\Delta t)}{2}\left( a_{i+1}+a_{i}\right)+O((\Delta t)^3).
\]</div>
<p>Our final equations for the position and the velocity become then</p>
<div class="math notranslate nohighlight">
\[
x_{i+1} = x_i+(\Delta t)v_i+\frac{(\Delta t)^2}{2}a_{i}+O((\Delta t)^3),
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
v_{i+1} = v_i+\frac{(\Delta t)}{2}\left(a_{i+1}+a_{i}\right)+O((\Delta t)^3).
\]</div>
<p>Note well that the term <span class="math notranslate nohighlight">\(a_{i+1}\)</span> depends on the position at <span class="math notranslate nohighlight">\(x_{i+1}\)</span>. This means that you need to calculate
the position at the updated time <span class="math notranslate nohighlight">\(t_{i+1}\)</span> before the computing the next velocity.  Note also that the derivative of the velocity at the time
<span class="math notranslate nohighlight">\(t_i\)</span> used in the updating of the position can be reused in the calculation of the velocity update as well.</p>
<p>We can now easily add the Verlet method to our original code as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, a, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># Initial conditions as compact 2-dimensional arrays</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">Fourpi2</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up forces, air resistance FD, note now that we need the norm of the vecto</span>
    <span class="c1"># Here you could have defined your own function for this</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="n">Fourpi2</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
<span class="c1"># Plot position as function of time    </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x[AU]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y[AU]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;EarthSunVV&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/hw5_145_0.png" src="_images/hw5_145_0.png" />
</div>
</div>
<p>You can easily generalize the calculation of the forces by defining a function
which takes in as input the various variables. We leave this as a challenge to you.</p>
<p>Running the above code for various time steps we see that the Velocity-Verlet is fully stable for various time steps.</p>
<p>We can also play around with different initial conditions in order to find the escape velocity from an orbit around the sun with distance one astronomical unit, 1 AU. The theoretical value for the escape velocity, is given by</p>
<div class="math notranslate nohighlight">
\[
v = \sqrt{8\pi^2}{r},
\]</div>
<p>and with <span class="math notranslate nohighlight">\(r=1\)</span> AU, this means that the escape velocity is <span class="math notranslate nohighlight">\(2\pi\sqrt{2}\)</span> AU/yr. To obtain this we required that the kinetic energy of Earth equals the potential energy given by the gravitational force.</p>
<p>Setting</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{2}M_{\mathrm{Earth}}v^2=\frac{GM_{\odot}}{r},
\]</div>
<p>and with <span class="math notranslate nohighlight">\(GM_{\odot}=4\pi^2\)</span> we obtain the above relation for the velocity. Setting an initial velocity say equal to <span class="math notranslate nohighlight">\(9\)</span> in the above code, yields a planet (Earth) which escapes a stable orbit around the sun, as seen by running the code here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, a, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># Initial conditions as compact 2-dimensional arrays</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span>
<span class="c1"># setting initial velocity larger than escape velocity</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">9.0</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">Fourpi2</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up forces, air resistance FD, note now that we need the norm of the vecto</span>
    <span class="c1"># Here you could have defined your own function for this</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="n">Fourpi2</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
<span class="c1"># Plot position as function of time    </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x[AU]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y[AU]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;EscapeEarthSunVV&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/hw5_151_0.png" src="_images/hw5_151_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="hw4.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title"><span class="section-number">12. </span>PHY321: Classical Mechanics 1</p>
            </div>
        </a>
    </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Morten Hjorth-Jensen and Scott Pratt<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>