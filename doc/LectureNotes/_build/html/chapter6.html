
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>2. Two-body problems, from the Gravitational Force to Two-body Scattering &#8212; Classical mechanics</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3. Non-inertial Frames, Translation and Rotating Coordinate Systems" href="chapter7.html" />
    <link rel="prev" title="1. Harmonic Oscillations" href="chapter5.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Classical mechanics</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   PHY321 Classical Mechanics I, Michigan State University, Spring 2021
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  About the course
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="schedule.html">
   Teaching schedule with links to material
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="teachers.html">
   Teachers and Grading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="textbooks.html">
   Textbooks
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introductory Material
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter1.html">
   1. Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter2.html">
   2. Classical Mechanics, Mathematics and Numerical background
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter3.html">
   3. Simple Motion problems and Reminder on Newton’s Laws
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter4.html">
   4. Work, Energy, Momentum and Conservation laws
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Advanced Topics
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter5.html">
   1. Harmonic Oscillations
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   2. Two-body problems, from the Gravitational Force to Two-body Scattering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter7.html">
   3. Non-inertial Frames, Translation and Rotating Coordinate Systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter8.html">
   4. Variational Calculus and Lagrangian Formalism
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/chapter6.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-and-definitions">
   2.1. Introduction and Definitions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#center-of-mass-and-relative-coordinates">
   2.2. Center of Mass and Relative Coordinates
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conservation-of-total-linear-momentum">
     2.2.1. Conservation of total  Linear Momentum
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#kinetic-and-total-energy">
     2.2.2. Kinetic and total Energy
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conservation-of-angular-momentum">
     2.2.3. Conservation of Angular Momentum
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deriving-elliptical-orbits">
   2.3. Deriving Elliptical Orbits
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#effective-or-centrifugal-potential">
   2.4. Effective or Centrifugal Potential
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#gravitational-force-example">
     2.4.1. Gravitational force example
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#harmonic-oscillator-in-two-dimensions">
     2.4.2. Harmonic Oscillator in two dimensions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#stability-of-orbits">
   2.5. Stability of Orbits
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#code-example-with-gravitional-force">
     2.5.1. Code example with gravitional force
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#scattering-and-cross-sections">
   2.6. Scattering and Cross Sections
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solution">
     2.6.1. Solution
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rutherford-scattering">
   2.7. Rutherford Scattering
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     2.7.1. Solution
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tidal-forces">
   2.8. Tidal Forces
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   2.9. Exercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-earth-sun-system">
     2.9.1. The Earth-Sun System
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#testing-energy-conservation">
     2.9.2. Testing Energy conservation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adding-the-velocity-verlet-method">
     2.9.3. Adding the  velocity Verlet method
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-center-of-mass-and-relative-coordinates-and-reference-frames">
     2.9.4. Exercise: Center-of-Mass and Relative Coordinates and Reference Frames
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-conservation-of-energy">
     2.9.5. Exercise: Conservation of Energy
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-harmonic-oscillator-again">
     2.9.6. Exercise: Harmonic oscillator again
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-numerical-solution-of-the-harmonic-oscillator">
     2.9.7. Exercise: Numerical Solution of the Harmonic Oscillator
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-equations-for-an-ellipse">
     2.9.8. Exercise: Equations for an ellipse
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-attractive-potential">
     2.9.9. Exercise: Attractive Potential
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-inverse-square-force">
     2.9.10. Exercise: Inverse-square force
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-inverse-square-force-again">
     2.9.11. Exercise: Inverse-square force again
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-parabolic-and-hyperbolic-orbits">
     2.9.12. Exercise: Parabolic and hyperbolic orbits
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-testing-orbit-types">
     2.9.13. Exercise: Testing orbit types
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-new-reference-frame">
     2.9.14. Exercise: New reference frame
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-center-of-mass-and-relative-coordinates">
     2.9.15. Exercise: Center of mass and relative coordinates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#exercise-two-body-problems">
     2.9.16. Exercise: Two-body problems
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="two-body-problems-from-the-gravitational-force-to-two-body-scattering">
<h1><span class="section-number">2. </span>Two-body problems, from the Gravitational Force to Two-body Scattering<a class="headerlink" href="#two-body-problems-from-the-gravitational-force-to-two-body-scattering" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction-and-definitions">
<h2><span class="section-number">2.1. </span>Introduction and Definitions<a class="headerlink" href="#introduction-and-definitions" title="Permalink to this headline">¶</a></h2>
<p>Central forces are forces which are directed towards or away from a
reference point. A familiar force is the gravitional
force  with the motion of our Earth around the Sun as a classic. The Sun, being
approximately sixth order of magnitude heavier than the Earth serves
as our origin. A force like the gravitational force is a function of the
relative distance <span class="math notranslate nohighlight">\(\boldsymbol{r}=\boldsymbol{r}_1-\boldsymbol{r}_2\)</span> only, where
<span class="math notranslate nohighlight">\(\boldsymbol{r}_1\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{r}_2\)</span> are the positions relative to a defined
origin for object one and object two, respectively.</p>
<p>These forces depend on the spatial degrees of freedom only (the
positions of the interacting objects/particles). As discussed earlier, from such forces we can infer
that  the total internal energy, the total linear momentum and total angular momentum are so-called constants of the motion, that is they stay constant  over time. We say that energy, linear and anuglar momentum are conserved.</p>
<p>With a scalar potential <span class="math notranslate nohighlight">\(V(\boldsymbol{r})\)</span> we define the force as the gradient of the potential</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F}(\boldsymbol{r})=-\boldsymbol{\nabla}V(\boldsymbol{r}).
\]</div>
<p>In general these potentials depend only on the magnitude of the
relative position and we will write the potential as <span class="math notranslate nohighlight">\(V(r)\)</span> where <span class="math notranslate nohighlight">\(r\)</span>
is defined as,</p>
<div class="math notranslate nohighlight">
\[
r = |\boldsymbol{r}_1-\boldsymbol{r}_2|.
\]</div>
<p>In three dimensions our vectors are defined as (for a given object/particle <span class="math notranslate nohighlight">\(i\)</span>)</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{r}_i = x_i\boldsymbol{e}_1+y_i\boldsymbol{e}_2+z_i\boldsymbol{e}_3,
\]</div>
<p>while in two dimensions we have</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{r}_i = x_i\boldsymbol{e}_1+y_i\boldsymbol{e}_2.
\]</div>
<p>In two dimensions the radius <span class="math notranslate nohighlight">\(r\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[
r = |\boldsymbol{r}_1-\boldsymbol{r}_2|=\sqrt{(x_1-x_2)^2+(y_1-y_2)^2}.
\]</div>
<p>If we consider the gravitational potential involving two masses <span class="math notranslate nohighlight">\(1\)</span> and <span class="math notranslate nohighlight">\(2\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[
V_{12}(r)=V(r)=-\frac{Gm_1m_2}{|\boldsymbol{r}_1-\boldsymbol{r}_2|}=-\frac{Gm_1m_2}{r}.
\]</div>
<p>Calculating the gradient of this potential we obtain the force</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F}(\boldsymbol{r})=-\frac{Gm_1m_2}{|\boldsymbol{r}_1-\boldsymbol{r}_1|^2}\hat{\boldsymbol{r}}_{12}=-\frac{Gm_am_b}{r^2}\hat{\boldsymbol{r}},
\]</div>
<p>where we have the unit vector</p>
<div class="math notranslate nohighlight">
\[
\hat{\boldsymbol{r}}=\hat{\boldsymbol{r}}_{12}=\frac{\boldsymbol{r}_2-\boldsymbol{r}_1}{|\boldsymbol{r}_1-\boldsymbol{r}_2|}.
\]</div>
<p>Here <span class="math notranslate nohighlight">\(G=6.67\times 10^{-11}\)</span> Nm<span class="math notranslate nohighlight">\(^2\)</span>/kg<span class="math notranslate nohighlight">\(^2\)</span>, and <span class="math notranslate nohighlight">\(\boldsymbol{F}\)</span> is the force
on <span class="math notranslate nohighlight">\(2\)</span> due to <span class="math notranslate nohighlight">\(1\)</span>. By inspection, one can see that the force on <span class="math notranslate nohighlight">\(2\)</span>
due to <span class="math notranslate nohighlight">\(1\)</span> and the force on <span class="math notranslate nohighlight">\(1\)</span> due to <span class="math notranslate nohighlight">\(2\)</span> are equal and opposite. The
net potential energy for a large number of masses would be</p>
<div class="math notranslate nohighlight">
\[
V=\sum_{i&lt;j}V_{ij}=\frac{1}{2}\sum_{i\ne j}V_{ij}.
\]</div>
<p>In general, the central forces that we will study can be written mathematically as</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F}(\boldsymbol{r})=f(r)\hat{r},
\]</div>
<p>where <span class="math notranslate nohighlight">\(f(r)\)</span> is  a scalar function. For the above gravitational force this scalar term is
<span class="math notranslate nohighlight">\(-Gm_1m_2/r^2\)</span>.
In general we will simply write this scalar function <span class="math notranslate nohighlight">\(f(r)=\alpha/r^2\)</span> where <span class="math notranslate nohighlight">\(\alpha\)</span> is a constant that can be either negative or positive. We will also see examples of other types of potentials in the examples below.</p>
<p>Besides general expressions for the potentials/forces, we will discuss
in detail different types of motion that arise, from circular to
elliptical or hyperbolic or parabolic. By transforming to either polar
coordinates or spherical coordinates, we will be able to obtain
analytical solutions for the equations of motion and thereby obtain
new insights about the properties of a system. Where possible, we will
compare our analytical equations with numerical studies.</p>
<p>However, before we arrive at these lovely insights, we need to
introduce some mathematical manipulations and definitions. We conclude
this chapter with a discussion of two-body scattering.</p>
</div>
<div class="section" id="center-of-mass-and-relative-coordinates">
<h2><span class="section-number">2.2. </span>Center of Mass and Relative Coordinates<a class="headerlink" href="#center-of-mass-and-relative-coordinates" title="Permalink to this headline">¶</a></h2>
<p>Thus far, we have considered the trajectory as if the force is
centered around a fixed point. For two bodies interacting only with
one another, both masses circulate around the center of mass. One
might think that solutions would become more complex when both
particles move, but we will see here that the problem can be reduced
to one with a single body moving according to a fixed force by
expressing the trajectories for <span class="math notranslate nohighlight">\(\boldsymbol{r}_1\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{r}_2\)</span> into the
center-of-mass coordinate <span class="math notranslate nohighlight">\(\boldsymbol{R}\)</span> and the relative
coordinate <span class="math notranslate nohighlight">\(\boldsymbol{r}\)</span>. We define the center-of-mass (CoM) coordinate as</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{R}\equiv\frac{m_1\boldsymbol{r}_1+m_2\boldsymbol{r}_2}{m_1+m_2},
\]</div>
<p>and the relative coordinate as</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{r}\equiv\boldsymbol{r}_1-\boldsymbol{r_2}.
\]</div>
<p>We can then rewrite <span class="math notranslate nohighlight">\(\boldsymbol{r}_1\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{r}_2\)</span> in terms of the relative and CoM coordinates as</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{r}_1=\boldsymbol{R}+\frac{m_2}{M}\boldsymbol{r},
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{r}_2=\boldsymbol{R}-\frac{m_1}{M}\boldsymbol{r}.
\]</div>
<div class="section" id="conservation-of-total-linear-momentum">
<h3><span class="section-number">2.2.1. </span>Conservation of total  Linear Momentum<a class="headerlink" href="#conservation-of-total-linear-momentum" title="Permalink to this headline">¶</a></h3>
<p>In our discussions on conservative forces we defined
the total linear momentum as</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{P}=\sum_{i=1}^Nm_i\frac{d\boldsymbol{r}_i}{dt},
\]</div>
<p>where <span class="math notranslate nohighlight">\(N=2\)</span> in our case. With the above definition of the center of mass position, we see that we can rewrite the total linear momentum as (multiplying the CoM coordinate  with <span class="math notranslate nohighlight">\(M\)</span>)</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{P}=M\frac{d\boldsymbol{R}}{dt}=M\dot{\boldsymbol{R}}.
\]</div>
<p>The net force acting on the system is given by the time derivative of the linear momentum (assuming mass is time independent)
and we have</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F}^{\mathrm{net}}=\dot{\boldsymbol{P}}=M\ddot{\boldsymbol{R}}.
\]</div>
<p>The net force acting on the system is given by the sum of the forces acting on the two bodies, that is we have</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F}^{\mathrm{net}}=\boldsymbol{F}_1+\boldsymbol{F}_2=\dot{\boldsymbol{P}}=M\ddot{\boldsymbol{R}}.
\]</div>
<p>In our case the forces are given by the internal forces only. The force acting on object <span class="math notranslate nohighlight">\(1\)</span> is thus <span class="math notranslate nohighlight">\(\boldsymbol{F}_{12}\)</span> and the one acting on object <span class="math notranslate nohighlight">\(2\)</span> is <span class="math notranslate nohighlight">\(\boldsymbol{F}_{12}\)</span>. We have also defined that <span class="math notranslate nohighlight">\(\boldsymbol{F}_{12}=-\boldsymbol{F}_{21}\)</span>. This means thar we have</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F}_1+\boldsymbol{F}_2=\boldsymbol{F}_{12}+\boldsymbol{F}_{21}=0=\dot{\boldsymbol{P}}=M\ddot{\boldsymbol{R}}.
\]</div>
<p>We could alternatively had write this</p>
<div class="math notranslate nohighlight">
\[
\ddot{\boldsymbol{R}}_{\rm cm}=\frac{1}{m_1+m_2}\left\{m_1\ddot{\boldsymbol{r}}_1+m_2\ddot{\boldsymbol{r}}_2\right\}=\frac{1}{m_1+m_2}\left\{\boldsymbol{F}_{12}+\boldsymbol{F}_{21}\right\}=0.
\]</div>
<p>This has the important consequence that the CoM velocity is a constant
of the motion. And since the total linear momentum is given by the
time-derivative of the CoM coordinate times the total mass
<span class="math notranslate nohighlight">\(M=m_1+m_2\)</span>, it means that linear momentum is also conserved.
Stated differently,  the center-of-mass coordinate
<span class="math notranslate nohighlight">\(\boldsymbol{R}\)</span> moves at a fixed velocity.</p>
<p>This has also another important consequence for our forces. If we
assume that our force depends only on the relative coordinate, it
means that the gradient of the potential with respect to the center of
mass position is zero, that is</p>
<div class="math notranslate nohighlight">
\[
M\ddot{d\boldsymbol{R}}=-\boldsymbol{\nabla}_{\boldsymbol{R}}V =0!
\]</div>
<p>If we now switch to the equation of motion for the relative coordinate, we have</p>
<div class="math notranslate nohighlight">
\[
\ddot{\boldsymbol{r}}=\ddot{\boldsymbol{r}}_1-\ddot{\boldsymbol{r}}_2=\left(\frac{\boldsymbol{F}_{12}}{m_1}-\frac{\boldsymbol{F}_{21}}{m_2}\right)=\left(\frac{1}{m_1}+\frac{1}{m_2}\right)\boldsymbol{F}_{12},
\]</div>
<p>which we can rewrite in terms of the reduced mass</p>
<div class="math notranslate nohighlight">
\[
\mu=\frac{m_1m_2}{m_1+m_2},
\]</div>
<p>as</p>
<div class="math notranslate nohighlight">
\[
\mu \ddot{\boldsymbol{r}}=\boldsymbol{F}_{12}.
\]</div>
<p>This has a very important consequence for our coming analysis of the equations of motion for the two-body problem.
Since the acceleration for the CoM coordinate is zero, we can now
treat the trajectory as a one-body problem where the mass is given by
the reduced mass <span class="math notranslate nohighlight">\(\mu\)</span> plus a second trivial problem for the center of
mass. The reduced mass is especially convenient when one is
considering forces that depend only on the relative coordinate (like the Gravitational force or the electrostatic force between two charges)  because then for say the gravitational force we have</p>
<div class="math notranslate nohighlight">
\[
\mu \ddot{\boldsymbol{r}}=-\frac{Gm_1m_2}{r^2}\hat{\boldsymbol{r}}=-\frac{GM\mu}{r^2}\hat{\boldsymbol{r}},
\]</div>
<p>where we have defined <span class="math notranslate nohighlight">\(M= m_1+m_2\)</span>.  It means that the acceleration of the relative coordinate is</p>
<div class="math notranslate nohighlight">
\[
\ddot{\boldsymbol{r}}=-\frac{GM}{r^2}\hat{\boldsymbol{r}},
\]</div>
<p>and we have that for the gravitational problem, the reduced mass then falls out and the
trajectory depends only on the total mass <span class="math notranslate nohighlight">\(M\)</span>.</p>
<p>The standard strategy is to transform into the center of mass frame,
then treat the problem as one of a single particle of mass <span class="math notranslate nohighlight">\(\mu\)</span>
undergoing a force <span class="math notranslate nohighlight">\(\boldsymbol{F}_{12}\)</span>. Scattering angles, see our discussion of scattering problems below, can also be
expressed in this frame.  Before we proceed to our definition of the CoM frame we need to set up the expression for the energy in terms of the relative and CoM coordinates.</p>
</div>
<div class="section" id="kinetic-and-total-energy">
<h3><span class="section-number">2.2.2. </span>Kinetic and total Energy<a class="headerlink" href="#kinetic-and-total-energy" title="Permalink to this headline">¶</a></h3>
<p>The kinetic energy and momenta also have analogues in center-of-mass
coordinates.
We have defined the total linear momentum as</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{P}=\sum_{i=1}^Nm_i\frac{d\boldsymbol{r}_i}{dt}=M\dot{\boldsymbol{R}}.
\]</div>
<p>For the relative momentum <span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span>, we have that the time derivative of <span class="math notranslate nohighlight">\(\boldsymbol{r}\)</span> is</p>
<div class="math notranslate nohighlight">
\[
\dot{\boldsymbol{r}} =\dot{\boldsymbol{r}}_1-\dot{\boldsymbol{r}}_2,
\]</div>
<p>We know also that the momenta <span class="math notranslate nohighlight">\(\boldsymbol{p}_1=m_1\dot{\boldsymbol{r}}_1\)</span> and
<span class="math notranslate nohighlight">\(\boldsymbol{p}_2=m_2\dot{\boldsymbol{r}}_2\)</span>. Using these expressions we can rewrite</p>
<div class="math notranslate nohighlight">
\[
\dot{\boldsymbol{r}} =\frac{\boldsymbol{p}_1}{m_1}-\frac{\boldsymbol{p}_2}{m_2},
\]</div>
<p>which gives</p>
<div class="math notranslate nohighlight">
\[
\dot{\boldsymbol{r}} =\frac{m_2\boldsymbol{p}_1-m_1\boldsymbol{p}_2}{m_1m_2},
\]</div>
<p>and dividing both sides with <span class="math notranslate nohighlight">\(M\)</span> we have</p>
<div class="math notranslate nohighlight">
\[
\frac{m_1m_2}{M}\dot{\boldsymbol{r}} =\frac{m_2\boldsymbol{p}_1-m_1\boldsymbol{p}_2}{M}.
\]</div>
<p>Introducing the reduced mass <span class="math notranslate nohighlight">\(\mu=m_1m_2/M\)</span> we have finally</p>
<div class="math notranslate nohighlight">
\[
\mu\dot{\boldsymbol{r}} =\frac{m_2\boldsymbol{p}_1-m_1\boldsymbol{p}_2}{M}.
\]</div>
<p>And <span class="math notranslate nohighlight">\(\mu\dot{\boldsymbol{r}}\)</span> defines the relative momentum <span class="math notranslate nohighlight">\(\boldsymbol{q}=\mu\dot{\boldsymbol{r}}\)</span>.</p>
<p>With these definitions we can then calculate the kinetic energy in terms of the relative and CoM coordinates.</p>
<p>We have that</p>
<div class="math notranslate nohighlight">
\[
K=\frac{p_1^2}{2m_1}+\frac{p_2^2}{2m_2},
\]</div>
<p>and with <span class="math notranslate nohighlight">\(\boldsymbol{p}_1=m_1\dot{\boldsymbol{r}}_1\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{p}_2=m_2\dot{\boldsymbol{r}}_2\)</span> and using</p>
<div class="math notranslate nohighlight">
\[
\dot{\boldsymbol{r}}_1=\dot{\boldsymbol{R}}+\frac{m_2}{M}\dot{\boldsymbol{r}},
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\dot{\boldsymbol{r}}_2=\dot{\boldsymbol{R}}-\frac{m_1}{M}\dot{\boldsymbol{r}},
\]</div>
<p>we obtain after squaring the expressions for <span class="math notranslate nohighlight">\(\dot{\boldsymbol{r}}_1\)</span> and <span class="math notranslate nohighlight">\(\dot{\boldsymbol{r}}_2\)</span></p>
<div class="math notranslate nohighlight">
\[
K=\frac{(m_1+m_2)\dot{\boldsymbol{R}}^2}{2}+\frac{(m_1+m_2)m_1m_2\dot{\boldsymbol{r}}^2}{2M^2},
\]</div>
<p>which we simplify to</p>
<div class="math notranslate nohighlight">
\[
K=\frac{\dot{\boldsymbol{P}}^2}{2M}+\frac{\mu\dot{\boldsymbol{q}}^2}{2}.
\]</div>
<p>Below we will define a reference frame, the so-called CoM-frame, where
<span class="math notranslate nohighlight">\(\boldsymbol{R}=0\)</span>. This is going to simplify our equations further.</p>
</div>
<div class="section" id="conservation-of-angular-momentum">
<h3><span class="section-number">2.2.3. </span>Conservation of Angular Momentum<a class="headerlink" href="#conservation-of-angular-momentum" title="Permalink to this headline">¶</a></h3>
<p>The angular momentum (the total one) is the sum of the individual angular momenta. In our case we have two bodies only, meaning that our angular momentum is defined as</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{L} = \boldsymbol{r}_1 \times \boldsymbol{p}_1+\boldsymbol{r}_2 \times \boldsymbol{p}_2,
\]</div>
<p>and using that <span class="math notranslate nohighlight">\(m_1\dot{\boldsymbol{r}}_1=\boldsymbol{p}_1\)</span> and <span class="math notranslate nohighlight">\(m_2\dot{\boldsymbol{r}}_2=\boldsymbol{p}_2\)</span> we have</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{L} = m_1\boldsymbol{r}_1 \times \dot{\boldsymbol{r}}_1+m_2\boldsymbol{r}_2 \times \dot{\boldsymbol{r}}_2.
\]</div>
<p>We define now the CoM-Frame where we set <span class="math notranslate nohighlight">\(\boldsymbol{R}=0\)</span>. This means that the equations
for <span class="math notranslate nohighlight">\(\boldsymbol{r}_1\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{r}_2\)</span> in terms of the relative motion simplify and  we have</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{r}_1=\frac{m_2}{M}\boldsymbol{r},
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{r}_2=-\frac{m_1}{M}\boldsymbol{r}.
\]</div>
<p>resulting in</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{L} = m_1 \frac{m_2}{M}\boldsymbol{r}\times\frac{m_2}{M}\boldsymbol{r} +m_2 \frac{m_1}{M}\boldsymbol{r} \times \frac{m_1}{M}\dot{\boldsymbol{r}}.
\]</div>
<p>We see that can rewrite this equation as</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{L}=\boldsymbol{r}\times \mu\dot{\boldsymbol{r}}=\mu\boldsymbol{r}\times \dot{\boldsymbol{r}}.
\]</div>
<p>If we now use a central force, we have that</p>
<div class="math notranslate nohighlight">
\[
\mu\dot{\boldsymbol{r}}=\boldsymbol{F}(\boldsymbol{r})=f(r)\hat{\boldsymbol{r}},
\]</div>
<p>and inserting this in the equation for the angular momentum we have</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{L}=\boldsymbol{r}\times f(r)\hat{\boldsymbol{r}},
\]</div>
<p>which equals zero since we are taking the cross product of the vector
<span class="math notranslate nohighlight">\(\boldsymbol{r}\)</span> with itself.  Angular momentum is thus conserved and in
addition to the total linear momentum being conserved, we know that
energy is also conserved with forces that depend only on position and
the relative coordinate only.</p>
<p>Since angular momentum is conserved, we can idealize
the motion of our two objects as two bodies moving in a plane spanned by the
relative coordinate and the relative momentum. The angular
momentum is perpendicular to the plane spanned by these two vectors.</p>
<p>It means also, since <span class="math notranslate nohighlight">\(\boldsymbol{L}\)</span> is conserved, that we can reduce our
problem to a motion in say the <span class="math notranslate nohighlight">\(xy\)</span>-plane.  What we have done then is to
reduce a two-body problem in three-dimensions with six degrees of
freedom (the six coordinates of the two objects) to a problem defined
entirely by the relative coordinate in two dimensions.  We have thus
moved from a problem with six degrees of freedom to one with two degrees of freedom only.</p>
<p>Since we deal with central forces that depend only on the
relative coordinate, we will show below that transforming to polar
coordinates, we cna find analytical solution to
the equation of motion</p>
<div class="math notranslate nohighlight">
\[
\mu\dot{\boldsymbol{r}}=\boldsymbol{F}(\boldsymbol{r})=f(r)\hat{\boldsymbol{r}}.
\]</div>
<p>Note the boldfaced symbols for the relative position <span class="math notranslate nohighlight">\(\boldsymbol{r}\)</span>. Our vector <span class="math notranslate nohighlight">\(\boldsymbol{r}\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{r}=x\boldsymbol{e}_1+y\boldsymbol{e}_2
\]</div>
<p>and introducing polar coordinates <span class="math notranslate nohighlight">\(r\in[0,\infty)\)</span> and <span class="math notranslate nohighlight">\(\phi\in [0,2\pi]\)</span> and the transformation</p>
<div class="math notranslate nohighlight">
\[
r=\sqrt{x^2+y^2},
\]</div>
<p>and <span class="math notranslate nohighlight">\(x=r\cos\phi\)</span> and <span class="math notranslate nohighlight">\(y=r\sin\phi\)</span>, we will rewrite our equation of motion by transforming from Cartesian coordinates to Polar coordinates. By so doing, we end up with two differential equations which can be solved analytically (it depends on the form of the potential).</p>
<p>What follows now is a rewrite of these equations and the introduction of Kepler’s laws as well.</p>
</div>
</div>
<div class="section" id="deriving-elliptical-orbits">
<h2><span class="section-number">2.3. </span>Deriving Elliptical Orbits<a class="headerlink" href="#deriving-elliptical-orbits" title="Permalink to this headline">¶</a></h2>
<p>Kepler’s laws state that a gravitational orbit should be an ellipse
with the source of the gravitational field at one focus. Deriving this
is surprisingly messy. To do this, we first use angular momentum
conservation to transform the equations of motion so that it is in
terms of <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span> instead of <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(t\)</span>. The overall strategy
is to</p>
<ol class="simple">
<li><p>Find equations of motion for <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(t\)</span> with no angle (<span class="math notranslate nohighlight">\(\phi\)</span>) mentioned, i.e. <span class="math notranslate nohighlight">\(d^2r/dt^2=\cdots\)</span>. Angular momentum conservation will be used, and the equation will involve the angular momentum <span class="math notranslate nohighlight">\(L\)</span>.</p></li>
<li><p>Use angular momentum conservation to find an expression for <span class="math notranslate nohighlight">\(\dot{\phi}\)</span> in terms of <span class="math notranslate nohighlight">\(r\)</span>.</p></li>
<li><p>Use the chain rule to convert the equations of motions for <span class="math notranslate nohighlight">\(r\)</span>, an expression involving <span class="math notranslate nohighlight">\(r,\dot{r}\)</span> and <span class="math notranslate nohighlight">\(\ddot{r}\)</span>, to one involving <span class="math notranslate nohighlight">\(r,dr/d\phi\)</span> and <span class="math notranslate nohighlight">\(d^2r/d\phi^2\)</span>. This is quitecomplicated because the expressions will also involve a substitution <span class="math notranslate nohighlight">\(u=1/r\)</span> so that one finds an expression in terms of <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(\phi\)</span>.</p></li>
<li><p>Once <span class="math notranslate nohighlight">\(u(\phi)\)</span> is found, you need to show that this can be converted to the familiar form for an ellipse.</p></li>
</ol>
<p>We will now rewrite the above equation of motion (note the boldfaced vector <span class="math notranslate nohighlight">\(\boldsymbol{r}\)</span>)</p>
<div class="math notranslate nohighlight">
\[
\mu \ddot{\boldsymbol{r}}=\boldsymbol{F}(\boldsymbol{r}),
\]</div>
<p>in polar coordinates.
What follows here is a repeated application of the chain rule for derivatives.
We start with derivative for <span class="math notranslate nohighlight">\(r\)</span> as function of time in a cartesian basis</p>
<!-- Equation labels as ordinary links -->
<div id="eq:radialeqofmotion"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:radialeqofmotion} \tag{1}
\frac{d}{dt}r^2&amp;=&amp;\frac{d}{dt}(x^2+y^2)=2x\dot{x}+2y\dot{y}=2r\dot{r},\\
\nonumber
\dot{r}&amp;=&amp;\frac{x}{r}\dot{x}+\frac{y}{r}\dot{y},\\
\nonumber
\ddot{r}&amp;=&amp;\frac{x}{r}\ddot{x}+\frac{y}{r}\ddot{y}
+\frac{\dot{x}^2+\dot{y}^2}{r}
-\frac{\dot{r}^2}{r}.
\end{eqnarray}
\end{split}\]</div>
<p>Note that there are no vectors involved here.</p>
<p>Recognizing that the numerator of the third term is the velocity squared, and that it can be written in polar coordinates,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto1"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v^2=\dot{x}^2+\dot{y}^2=\dot{r}^2+r^2\dot{\phi}^2,
\label{_auto1} \tag{2}
\end{equation}
\]</div>
<p>one can write <span class="math notranslate nohighlight">\(\ddot{r}\)</span> as</p>
<!-- Equation labels as ordinary links -->
<div id="eq:radialeqofmotion2"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\label{eq:radialeqofmotion2} \tag{3}
\ddot{r}=\frac{F_x\cos\phi+F_y\sin\phi}{m}+\frac{\dot{r}^2+r^2\dot{\phi}^2}{r}-\frac{\dot{r}^2}{r}
\end{equation}
\]</div>
<div class="math notranslate nohighlight">
\[
\nonumber
=\frac{F}{m}+\frac{r^2\dot{\phi}^2}{r}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto2"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
\label{_auto2} \tag{4}
\end{equation}
\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[
m\ddot{r}=F+\frac{L^2}{mr^3}.
\]</div>
<p>This derivation used the fact that the force was radial,
<span class="math notranslate nohighlight">\(F=F_r=F_x\cos\phi+F_y\sin\phi\)</span>, and that angular momentum is
<span class="math notranslate nohighlight">\(L=mrv_{\phi}=mr^2\dot{\phi}\)</span>. The term <span class="math notranslate nohighlight">\(L^2/mr^3=mv^2/r\)</span> behaves
like an additional force. Sometimes this is referred to as a
centrifugal force, but it is not a force. Instead, it is the
consequence of considering the motion in a rotating (and therefore
accelerating) frame.</p>
<p>Now, we switch to the particular case of an attractive inverse square
force, <span class="math notranslate nohighlight">\(F=-\alpha/r^2\)</span>, and show that the trajectory, <span class="math notranslate nohighlight">\(r(\phi)\)</span>, is
an ellipse. To do this we transform derivatives w.r.t. time to
derivatives w.r.t. <span class="math notranslate nohighlight">\(\phi\)</span> using the chain rule combined with angular
momentum conservation, <span class="math notranslate nohighlight">\(\dot{\phi}=L/mr^2\)</span>.</p>
<!-- Equation labels as ordinary links -->
<div id="eq:rtotheta"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:rtotheta} \tag{5}
\dot{r}&amp;=&amp;\frac{dr}{d\phi}\dot{\phi}=\frac{dr}{d\phi}\frac{L}{mr^2},\\
\nonumber
\ddot{r}&amp;=&amp;\frac{d^2r}{d\phi^2}\dot{\phi}^2
+\frac{dr}{d\phi}\left(\frac{d}{dr}\frac{L}{mr^2}\right)\dot{r}\\
\nonumber
&amp;=&amp;\frac{d^2r}{d\phi^2}\left(\frac{L}{mr^2}\right)^2
-2\frac{dr}{d\phi}\frac{L}{mr^3}\dot{r}\\
\nonumber
&amp;=&amp;\frac{d^2r}{d\phi^2}\left(\frac{L}{mr^2}\right)^2
-\frac{2}{r}\left(\frac{dr}{d\phi}\right)^2\left(\frac{L}{mr^2}\right)^2
\end{eqnarray}
\end{split}\]</div>
<p>Equating the two expressions for <span class="math notranslate nohighlight">\(\ddot{r}\)</span> in Eq.s (<a class="reference external" href="#eq:radialeqofmotion2">3</a>) and (<a class="reference external" href="#eq:rtotheta">5</a>) eliminates all the derivatives w.r.t. time, and provides a differential equation with only derivatives w.r.t. <span class="math notranslate nohighlight">\(\phi\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:rdotdot"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\label{eq:rdotdot} \tag{6}
\frac{d^2r}{d\phi^2}\left(\frac{L}{mr^2}\right)^2
-\frac{2}{r}\left(\frac{dr}{d\phi}\right)^2\left(\frac{L}{mr^2}\right)^2
=\frac{F}{m}+\frac{L^2}{m^2r^3},
\end{equation}
\]</div>
<p>that when solved yields the trajectory, i.e. <span class="math notranslate nohighlight">\(r(\phi)\)</span>. Up to this
point the expressions work for any radial force, not just forces that
fall as <span class="math notranslate nohighlight">\(1/r^2\)</span>.</p>
<p>The trick to simplifying this differential equation for the inverse
square problems is to make a substitution, <span class="math notranslate nohighlight">\(u\equiv 1/r\)</span>, and rewrite
the differential equation for <span class="math notranslate nohighlight">\(u(\phi)\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
r&amp;=&amp;1/u,\\
\nonumber
\frac{dr}{d\phi}&amp;=&amp;-\frac{1}{u^2}\frac{du}{d\phi},\\
\nonumber
\frac{d^2r}{d\phi^2}&amp;=&amp;\frac{2}{u^3}\left(\frac{du}{d\phi}\right)^2-\frac{1}{u^2}\frac{d^2u}{d\phi^2}.
\end{eqnarray}
\end{split}\]</div>
<p>Plugging these expressions into Eq. (<a class="reference external" href="#eq:rdotdot">6</a>) gives an
expression in terms of <span class="math notranslate nohighlight">\(u\)</span>, <span class="math notranslate nohighlight">\(du/d\phi\)</span>, and <span class="math notranslate nohighlight">\(d^2u/d\phi^2\)</span>. After
some tedious algebra,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto3"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{d^2u}{d\phi^2}=-u-\frac{F m}{L^2u^2}.
\label{_auto3} \tag{7}
\end{equation}
\]</div>
<p>For the attractive inverse square law force, <span class="math notranslate nohighlight">\(F=-\alpha u^2\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto4"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{d^2u}{d\phi^2}=-u+\frac{m\alpha}{L^2}.
\label{_auto4} \tag{8}
\end{equation}
\]</div>
<p>The solution has two arbitrary constants, <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(\phi_0\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:Ctrajectory"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:Ctrajectory} \tag{9}
u&amp;=&amp;\frac{m\alpha}{L^2}+A\cos(\phi-\phi_0),\\
\nonumber
r&amp;=&amp;\frac{1}{(m\alpha/L^2)+A\cos(\phi-\phi_0)}.
\end{eqnarray}
\end{split}\]</div>
<p>The radius will be at a minimum when <span class="math notranslate nohighlight">\(\phi=\phi_0\)</span> and at a
maximum when <span class="math notranslate nohighlight">\(\phi=\phi_0+\pi\)</span>. The constant <span class="math notranslate nohighlight">\(A\)</span> is related to the
eccentricity of the orbit. When <span class="math notranslate nohighlight">\(A=0\)</span> the radius is a constant
<span class="math notranslate nohighlight">\(r=L^2/(m\alpha)\)</span>, and the motion is circular. If one solved the
expression <span class="math notranslate nohighlight">\(mv^2/r=-\alpha/r^2\)</span> for a circular orbit, using the
substitution <span class="math notranslate nohighlight">\(v=L/(mr)\)</span>, one would reproduce the expression
<span class="math notranslate nohighlight">\(r=L^2/(m\alpha)\)</span>.</p>
<p>The form describing the elliptical trajectory in
Eq. (<a class="reference external" href="#eq:Ctrajectory">9</a>) can be identified as an ellipse with one
focus being the center of the ellipse by considering the definition of
an ellipse as being the points such that the sum of the two distances
between the two foci are a constant. Making that distance <span class="math notranslate nohighlight">\(2D\)</span>, the
distance between the two foci as <span class="math notranslate nohighlight">\(2a\)</span>, and putting one focus at the
origin,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
2D&amp;=&amp;r+\sqrt{(r\cos\phi-2a)^2+r^2\sin^2\phi},\\
\nonumber
4D^2+r^2-4Dr&amp;=&amp;r^2+4a^2-4ar\cos\phi,\\
\nonumber
r&amp;=&amp;\frac{D^2-a^2}{D+a\cos\phi}=\frac{1}{D/(D^2-a^2)-a\cos\phi/(D^2-a^2)}.
\end{eqnarray}
\end{split}\]</div>
<p>By inspection, this is the same form as Eq. (<a class="reference external" href="#eq:Ctrajectory">9</a>) with <span class="math notranslate nohighlight">\(D/(D^2-a^2)=m\alpha/L^2\)</span> and <span class="math notranslate nohighlight">\(a/(D^2-a^2)=A\)</span>.</p>
<p>Let us remind ourselves about what an ellipse is before we proceed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span>

<span class="n">u</span><span class="o">=</span><span class="mf">1.</span>     <span class="c1">#x-position of the center</span>
<span class="n">v</span><span class="o">=</span><span class="mf">0.5</span>    <span class="c1">#y-position of the center</span>
<span class="n">a</span><span class="o">=</span><span class="mf">2.</span>     <span class="c1">#radius on the x-axis</span>
<span class="n">b</span><span class="o">=</span><span class="mf">1.5</span>    <span class="c1">#radius on the y-axis</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">u</span><span class="o">+</span><span class="n">a</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="p">,</span> <span class="n">v</span><span class="o">+</span><span class="n">b</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_123_0.png" src="_images/chapter6_123_0.png" />
</div>
</div>
</div>
<div class="section" id="effective-or-centrifugal-potential">
<h2><span class="section-number">2.4. </span>Effective or Centrifugal Potential<a class="headerlink" href="#effective-or-centrifugal-potential" title="Permalink to this headline">¶</a></h2>
<p>The total energy of a particle is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
E&amp;=&amp;V(r)+\frac{1}{2}mv_\phi^2+\frac{1}{2}m\dot{r}^2\\
\nonumber
&amp;=&amp;V(r)+\frac{1}{2}mr^2\dot{\phi}^2+\frac{1}{2}m\dot{r}^2\\
\nonumber
&amp;=&amp;V(r)+\frac{L^2}{2mr^2}+\frac{1}{2}m\dot{r}^2.
\end{eqnarray}
\end{split}\]</div>
<p>The second term then contributes to the energy like an additional
repulsive potential. The term is sometimes referred to as the
“centrifugal” potential, even though it is actually the kinetic energy
of the angular motion. Combined with <span class="math notranslate nohighlight">\(V(r)\)</span>, it is sometimes referred
to as the “effective” potential,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
V_{\rm eff}(r)&amp;=&amp;V(r)+\frac{L^2}{2mr^2}.
\end{eqnarray}
\]</div>
<p>Note that if one treats the effective potential like a real potential, one would expect to be able to generate an effective force,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
F_{\rm eff}&amp;=&amp;-\frac{d}{dr}V(r) -\frac{d}{dr}\frac{L^2}{2mr^2}\\
\nonumber
&amp;=&amp;F(r)+\frac{L^2}{mr^3}=F(r)+m\frac{v_\perp^2}{r},
\end{eqnarray}
\end{split}\]</div>
<p>which is indeed matches the form for <span class="math notranslate nohighlight">\(m\ddot{r}\)</span> in Eq. (<a class="reference external" href="#eq:radialeqofmotion2">3</a>), which included the <strong>centrifugal</strong> force.</p>
<p>The following code plots this effective potential for a simple choice of parameters, with a standard gravitational potential <span class="math notranslate nohighlight">\(-\alpha/r\)</span>. Here we have chosen <span class="math notranslate nohighlight">\(L=m=\alpha=1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">Deltax</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays</span>
<span class="n">xinitial</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">xfinal</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># spring constant</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># mass, you can change these</span>
<span class="n">AngMom</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#  The angular momentum</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">((</span><span class="n">xfinal</span><span class="o">-</span><span class="n">xinitial</span><span class="p">)</span><span class="o">/</span><span class="n">Deltax</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xinitial</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">Deltax</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="n">x</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Plot potential</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;r[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;V[J]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_131_0.png" src="_images/chapter6_131_0.png" />
</div>
</div>
<div class="section" id="gravitational-force-example">
<h3><span class="section-number">2.4.1. </span>Gravitational force example<a class="headerlink" href="#gravitational-force-example" title="Permalink to this headline">¶</a></h3>
<p>Using the above parameters, we can now study the evolution of the system using for example the velocity Verlet method.
This is done in the code here for an initial radius equal to the minimum of the potential well.  We seen then that the radius is always the same and corresponds to a circle (the radius is always constant).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Where to save the figures and data files</span>
<span class="n">PROJECT_ROOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
<span class="n">FIGURE_ID</span> <span class="o">=</span> <span class="s2">&quot;Results/FigureFiles&quot;</span>
<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s2">&quot;DataFiles/&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">,</span> <span class="n">fig_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_path</span><span class="p">(</span><span class="n">dat_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">,</span> <span class="n">dat_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>


<span class="c1"># Simple Gravitational Force   -alpha/r</span>
    
<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">100.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, v and r</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Constants of the model, setting all variables to one for simplicity</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">AngMom</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#  The angular momentum</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># scale mass to one</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">m</span>
<span class="n">rmin</span> <span class="o">=</span> <span class="p">(</span><span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">m</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span>
<span class="c1"># Initial conditions</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">rmin</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up acceleration</span>
    <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
    <span class="c1"># Plot position as function of time</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Velocity&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;RadialGVV&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_133_0.png" src="_images/chapter6_133_0.png" />
</div>
</div>
<p>Changing the value of the initial position to a value where the energy is positive, leads to an increasing radius with time, a so-called unbound orbit. Choosing on the other hand an initial radius that corresponds to a negative energy and different from the minimum value leads to a radius that oscillates back and forth between two values.</p>
</div>
<div class="section" id="harmonic-oscillator-in-two-dimensions">
<h3><span class="section-number">2.4.2. </span>Harmonic Oscillator in two dimensions<a class="headerlink" href="#harmonic-oscillator-in-two-dimensions" title="Permalink to this headline">¶</a></h3>
<p>Consider a particle of mass <span class="math notranslate nohighlight">\(m\)</span> in a 2-dimensional harmonic oscillator with potential</p>
<div class="math notranslate nohighlight">
\[
V=\frac{1}{2}kr^2=\frac{1}{2}k(x^2+y^2).
\]</div>
<p>If the orbit has angular momentum <span class="math notranslate nohighlight">\(L\)</span>, we can find the radius and angular velocity of the circular orbit as well as the b) the angular frequency of small radial perturbations.</p>
<p>We consider the effective potential. The radius of a circular orbit is at the minimum of the potential (where the effective force is zero).
The potential is plotted here with the parameters <span class="math notranslate nohighlight">\(k=m=0.1\)</span> and <span class="math notranslate nohighlight">\(L=1.0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">Deltax</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays</span>
<span class="n">xinitial</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">xfinal</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># spring constant</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># mass, you can change these</span>
<span class="n">AngMom</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#  The angular momentum</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">((</span><span class="n">xfinal</span><span class="o">-</span><span class="n">xinitial</span><span class="p">)</span><span class="o">/</span><span class="n">Deltax</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xinitial</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">Deltax</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Plot potential</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;r[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;V[J]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_137_0.png" src="_images/chapter6_137_0.png" />
</div>
</div>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
V_{\rm eff}&amp;=&amp;\frac{1}{2}kr^2+\frac{L^2}{2mr^2}
\end{eqnarray*}
\]</div>
<p>The effective potential looks like that of a harmonic oscillator for
large <span class="math notranslate nohighlight">\(r\)</span>, but for small <span class="math notranslate nohighlight">\(r\)</span>, the centrifugal potential repels the
particle from the origin. The combination of the two potentials has a
minimum for at some radius <span class="math notranslate nohighlight">\(r_{\rm min}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
0&amp;=&amp;kr_{\rm min}-\frac{L^2}{mr_{\rm min}^3},\\
r_{\rm min}&amp;=&amp;\left(\frac{L^2}{mk}\right)^{1/4},\\
\dot{\phi}&amp;=&amp;\frac{L}{mr_{\rm min}^2}=\sqrt{k/m}.
\end{eqnarray*}
\end{split}\]</div>
<p>For particles at <span class="math notranslate nohighlight">\(r_{\rm min}\)</span> with <span class="math notranslate nohighlight">\(\dot{r}=0\)</span>, the particle does not
accelerate and <span class="math notranslate nohighlight">\(r\)</span> stays constant, i.e. a circular orbit. The radius
of the circular orbit can be adjusted by changing the angular momentum
<span class="math notranslate nohighlight">\(L\)</span>.</p>
<p>For the above parameters this minimum is at <span class="math notranslate nohighlight">\(r_{\rm min}=1\)</span>.</p>
<p>Now consider small vibrations about <span class="math notranslate nohighlight">\(r_{\rm min}\)</span>. The effective spring constant is the curvature of the effective potential.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
k_{\rm eff}&amp;=&amp;\left.\frac{d^2}{dr^2}V_{\rm eff}(r)\right|_{r=r_{\rm min}}=k+\frac{3L^2}{mr_{\rm min}^4}\\
&amp;=&amp;4k,\\
\omega&amp;=&amp;\sqrt{k_{\rm eff}/m}=2\sqrt{k/m}=2\dot{\phi}.
\end{eqnarray*}
\end{split}\]</div>
<p>Here, the second step used the result of the last step from part
(a). Because the radius oscillates with twice the angular frequency,
the orbit has two places where <span class="math notranslate nohighlight">\(r\)</span> reaches a minimum in one
cycle. This differs from the inverse-square force where there is one
minimum in an orbit. One can show that the orbit for the harmonic
oscillator is also elliptical, but in this case the center of the
potential is at the center of the ellipse, not at one of the foci.</p>
<p>The solution is also simple to write down exactly in Cartesian coordinates. The <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> equations of motion separate,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\ddot{x}&amp;=&amp;-kx,\\
\ddot{y}&amp;=&amp;-ky.
\end{eqnarray*}
\end{split}\]</div>
<p>So the general solution can be expressed as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
x&amp;=&amp;A\cos\omega_0 t+B\sin\omega_0 t,\\
y&amp;=&amp;C\cos\omega_0 t+D\sin\omega_0 t.
\end{eqnarray*}
\end{split}\]</div>
<p>The code here finds the solution for <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> using the code we developed in homework 5 and 6 and the midterm.  Note that this code is tailored to run in Cartesian coordinates. There is thus no angular momentum dependent term.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Constants of the model</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># spring constant</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># mass, you can change these</span>
<span class="n">omega02</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">k</span><span class="o">/</span><span class="n">m</span><span class="p">)</span>  <span class="c1"># Frequency</span>
<span class="n">AngMom</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#  The angular momentum</span>
<span class="n">rmin</span> <span class="o">=</span> <span class="p">(</span><span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">k</span><span class="o">/</span><span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mf">0.25</span>
<span class="c1"># Initial conditions as compact 2-dimensional arrays</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">rmin</span><span class="o">-</span><span class="mf">0.5</span><span class="p">;</span> <span class="n">y0</span><span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">rmin</span><span class="o">*</span><span class="n">rmin</span><span class="o">-</span><span class="n">x0</span><span class="o">*</span><span class="n">x0</span><span class="p">)</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">])</span> 
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up the acceleration</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">omega02</span>  
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">omega02</span>  
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
<span class="c1"># Plot position as function of time</span>
<span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;radius squared&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x position&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y position&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;2DimHOVV&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_148_0.png" src="_images/chapter6_148_0.png" />
</div>
</div>
<p>With some work using double angle formulas, one can calculate</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
r^2&amp;=&amp;x^2+y^2\\
\nonumber
&amp;=&amp;(A^2+C^2)\cos^2(\omega_0t)+(B^2+D^2)\sin^2\omega_0t+(AB+CD)\cos(\omega_0t)\sin(\omega_0t)\\
\nonumber
&amp;=&amp;\alpha+\beta\cos 2\omega_0 t+\gamma\sin 2\omega_0 t,\\
\alpha&amp;=&amp;\frac{A^2+B^2+C^2+D^2}{2},~~\beta=\frac{A^2-B^2+C^2-D^2}{2},~~\gamma=AB+CD,\\
r^2&amp;=&amp;\alpha+(\beta^2+\gamma^2)^{1/2}\cos(2\omega_0 t-\delta),~~~\delta=\arctan(\gamma/\beta),
\end{eqnarray*}
\end{split}\]</div>
<p>and see that radius oscillates with frequency <span class="math notranslate nohighlight">\(2\omega_0\)</span>. The
factor of two comes because the oscillation <span class="math notranslate nohighlight">\(x=A\cos\omega_0t\)</span> has two
maxima for <span class="math notranslate nohighlight">\(x^2\)</span>, one at <span class="math notranslate nohighlight">\(t=0\)</span> and one a half period later.</p>
<p>The following code shows first how we can solve this problem using the radial degrees of freedom only.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, v and r</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Constants of the model</span>
<span class="n">AngMom</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#  The angular momentum</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">omega02</span> <span class="o">=</span> <span class="n">k</span><span class="o">/</span><span class="n">m</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">m</span>
<span class="n">rmin</span> <span class="o">=</span> <span class="p">(</span><span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">k</span><span class="o">/</span><span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mf">0.25</span>
<span class="c1"># Initial conditions</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">rmin</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v0</span><span class="o">*</span><span class="n">v0</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">r0</span><span class="o">*</span><span class="n">r0</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="p">(</span><span class="n">r0</span><span class="o">*</span><span class="n">r0</span><span class="p">)</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up acceleration</span>
    <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">omega02</span><span class="o">+</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>    
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">omega02</span><span class="o">+</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
    <span class="n">E</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># Plot position as function of time</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Energy&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">E</span><span class="p">)</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;RadialHOVV&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_152_0.png" src="_images/chapter6_152_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="stability-of-orbits">
<h2><span class="section-number">2.5. </span>Stability of Orbits<a class="headerlink" href="#stability-of-orbits" title="Permalink to this headline">¶</a></h2>
<p>The effective force can be extracted from the effective potential, <span class="math notranslate nohighlight">\(V_{\rm eff}\)</span>. Beginning from the equations of motion, Eq. (<a class="reference external" href="#eq:radialeqofmotion">1</a>), for <span class="math notranslate nohighlight">\(r\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
m\ddot{r}&amp;=&amp;F+\frac{L^2}{mr^3}\\
\nonumber
&amp;=&amp;F_{\rm eff}\\
\nonumber
&amp;=&amp;-\partial_rV_{\rm eff},\\
\nonumber
F_{\rm eff}&amp;=&amp;-\partial_r\left[V(r)+(L^2/2mr^2)\right].
\end{eqnarray}
\end{split}\]</div>
<p>For a circular orbit, the radius must be fixed as a function of time,
so one must be at a maximum or a minimum of the effective
potential. However, if one is at a maximum of the effective potential
the radius will be unstable. For the attractive Coulomb force the
effective potential will be dominated by the <span class="math notranslate nohighlight">\(-\alpha/r\)</span> term for
large <span class="math notranslate nohighlight">\(r\)</span> because the centrifugal part falls off more quickly, <span class="math notranslate nohighlight">\(\sim
1/r^2\)</span>. At low <span class="math notranslate nohighlight">\(r\)</span> the centrifugal piece wins and the effective
potential is repulsive. Thus, the potential must have a minimum
somewhere with negative potential. The circular orbits are then stable
to perturbation.</p>
<p>The effective potential is sketched for two cases, a <span class="math notranslate nohighlight">\(1/r\)</span> attractive
potential and a <span class="math notranslate nohighlight">\(1/r^3\)</span> attractive potential. The <span class="math notranslate nohighlight">\(1/r\)</span> case has a
stable minimum, whereas the circular orbit in the <span class="math notranslate nohighlight">\(1/r^3\)</span> case is
unstable.</p>
<p>If one considers a potential that falls as <span class="math notranslate nohighlight">\(1/r^3\)</span>, the situation is
reversed and the point where <span class="math notranslate nohighlight">\(\partial_rV\)</span> disappears will be a local
maximum rather than a local minimum. <strong>Fig to come here with code</strong></p>
<p>The repulsive centrifugal piece dominates at large <span class="math notranslate nohighlight">\(r\)</span> and the attractive
Coulomb piece wins out at small <span class="math notranslate nohighlight">\(r\)</span>. The circular orbit is then at a
maximum of the effective potential and the orbits are unstable. It is
the clear that for potentials that fall as <span class="math notranslate nohighlight">\(r^n\)</span>, that one must have
<span class="math notranslate nohighlight">\(n&gt;-2\)</span> for the orbits to be stable.</p>
<p>Consider a potential <span class="math notranslate nohighlight">\(V(r)=\beta r\)</span>. For a particle of mass <span class="math notranslate nohighlight">\(m\)</span> with
angular momentum <span class="math notranslate nohighlight">\(L\)</span>, find the angular frequency of a circular
orbit. Then find the angular frequency for small radial perturbations.</p>
<p>For the circular orbit you search for the position <span class="math notranslate nohighlight">\(r_{\rm min}\)</span> where the effective potential is minimized,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\partial_r\left\{\beta r+\frac{L^2}{2mr^2}\right\}&amp;=&amp;0,\\
\beta&amp;=&amp;\frac{L^2}{mr_{\rm min}^3},\\
r_{\rm min}&amp;=&amp;\left(\frac{L^2}{\beta m}\right)^{1/3},\\
\dot{\phi}&amp;=&amp;\frac{L}{mr_{\rm min}^2}=\frac{\beta^{2/3}}{(mL)^{1/3}}
\end{eqnarray*}
\end{split}\]</div>
<p>Now, we can find the angular frequency of small perturbations about the circular orbit. To do this we find the effective spring constant for the effective potential,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
k_{\rm eff}&amp;=&amp;\partial_r^2 \left.V_{\rm eff}\right|_{r_{\rm min}}\\
&amp;=&amp;\frac{3L^2}{mr_{\rm min}^4},\\
\omega&amp;=&amp;\sqrt{\frac{k_{\rm eff}}{m}}\\
&amp;=&amp;\frac{\beta^{2/3}}{(mL)^{1/3}}\sqrt{3}.
\end{eqnarray*}
\end{split}\]</div>
<p>If the two frequencies, <span class="math notranslate nohighlight">\(\dot{\phi}\)</span> and <span class="math notranslate nohighlight">\(\omega\)</span>, differ by an
integer factor, the orbit’s trajectory will repeat itself each time
around. This is the case for the inverse-square force,
<span class="math notranslate nohighlight">\(\omega=\dot{\phi}\)</span>, and for the harmonic oscillator,
<span class="math notranslate nohighlight">\(\omega=2\dot{\phi}\)</span>. In this case, <span class="math notranslate nohighlight">\(\omega=\sqrt{3}\dot{\phi}\)</span>,
and the angles at which the maxima and minima occur change with each
orbit.</p>
<div class="section" id="code-example-with-gravitional-force">
<h3><span class="section-number">2.5.1. </span>Code example with gravitional force<a class="headerlink" href="#code-example-with-gravitional-force" title="Permalink to this headline">¶</a></h3>
<p>The code example here is meant to illustrate how we can make a plot of the final orbit. We solve the equations in polar coordinates (the example here uses the minimum of the potential as initial value) and then we transform back to cartesian coordinates and plot <span class="math notranslate nohighlight">\(x\)</span> versus <span class="math notranslate nohighlight">\(y\)</span>. We see that we get a perfect circle when we place ourselves at the minimum of the potential energy, as expected.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simple Gravitational Force   -alpha/r</span>
    
<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">8.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, v and r</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Constants of the model, setting all variables to one for simplicity</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">AngMom</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#  The angular momentum</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># scale mass to one</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">m</span>
<span class="n">rmin</span> <span class="o">=</span> <span class="p">(</span><span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">m</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span>
<span class="c1"># Initial conditions, place yourself at the potential min</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">rmin</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1"># starts at rest</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">phi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up acceleration</span>
    <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
    <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="p">(</span><span class="n">r0</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Find cartesian coordinates for easy plot    </span>
<span class="n">x</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Angle $\cos{\phi}$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;Phasespace&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_160_0.png" src="_images/chapter6_160_0.png" />
</div>
</div>
<p>Try to change the initial value for <span class="math notranslate nohighlight">\(r\)</span> and see what kind of orbits you get.
In order to test different energies, it can be useful to look at the plot of the effective potential discussed above.</p>
<p>However, for orbits different from a circle the above code would need modifications in order to allow us to display say an ellipse. For the latter, it is much easier to run our code in cartesian coordinates, as done here. In this code we test also energy conservation and see that it is conserved to numerical precision. The code here is a simple extension of the code we developed for homework 4.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Constants of the model</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># mass, you can change these</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="c1"># Initial conditions as compact 2-dimensional arrays</span>
<span class="n">x0</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">;</span> <span class="n">y0</span><span class="o">=</span> <span class="mf">0.</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">])</span> 
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">1.0</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="n">rabs</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up the acceleration</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="n">alpha</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">E</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="n">rabs</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
<span class="c1"># Plot position as function of time</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y position&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y position&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;2DimGravity&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">E</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_162_0.png" src="_images/chapter6_162_0.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-1.5        -1.49999996 -1.49999984 -1.49999964 -1.49999935 -1.49999898
 -1.49999853 -1.49999798 -1.49999734 -1.49999659 -1.49999574 -1.49999478
 -1.49999369 -1.49999247 -1.49999112 -1.49998961 -1.49998794 -1.49998609
 -1.49998404 -1.49998178 -1.49997929 -1.49997654 -1.49997351 -1.49997017
 -1.49996649 -1.49996243 -1.49995796 -1.49995304 -1.49994762 -1.49994165
 -1.49993508 -1.49992786 -1.49991994 -1.49991127 -1.4999018  -1.49989151
 -1.49988041 -1.49986852 -1.49985595 -1.49984292 -1.49982978 -1.49981712
 -1.49980588 -1.49979754 -1.49979431 -1.49979958 -1.4998184  -1.4998583
 -1.49993028 -1.50005034 -1.50024115 -1.500534   -1.50097003 -1.50159939
 -1.50247522 -1.50363822 -1.5050881  -1.50674417 -1.50841251 -1.50979454
 -1.51056842 -1.5105255  -1.50967788 -1.5082518  -1.50657253 -1.50493047
 -1.50350752 -1.50237442 -1.50152565 -1.50091821 -1.50049876 -1.50021789
 -1.50003547 -1.49992116 -1.49985304 -1.4998157  -1.49979853 -1.49979431
 -1.49979819 -1.49980692 -1.49981835 -1.49983109 -1.49984425 -1.49985725
 -1.49986975 -1.49988156 -1.49989259 -1.49990279 -1.49991218 -1.49992077
 -1.49992862 -1.49993577 -1.49994227 -1.49994819 -1.49995356 -1.49995843
 -1.49996286 -1.49996688 -1.49997052 -1.49997383 -1.49997683 -1.49997955
 -1.49998202 -1.49998426 -1.49998628 -1.49998812 -1.49998977 -1.49999126
 -1.4999926  -1.49999381 -1.49999488 -1.49999583 -1.49999667 -1.49999741
 -1.49999804 -1.49999858 -1.49999903 -1.49999939 -1.49999966 -1.49999986
 -1.49999997 -1.5        -1.49999995 -1.49999982 -1.49999961 -1.49999932
 -1.49999894 -1.49999848 -1.49999792 -1.49999727 -1.49999651 -1.49999565
 -1.49999467 -1.49999357 -1.49999234 -1.49999097 -1.49998945 -1.49998776
 -1.49998589 -1.49998382 -1.49998154 -1.49997902 -1.49997625 -1.49997319
 -1.49996981 -1.4999661  -1.499962   -1.49995749 -1.49995252 -1.49994704
 -1.49994101 -1.49993438 -1.49992709 -1.4999191  -1.49991035 -1.4999008
 -1.49989043 -1.49987924 -1.49986728 -1.49985466 -1.49984159 -1.49982847
 -1.4998159  -1.49980488 -1.49979693 -1.49979438 -1.49980076 -1.49982132
 -1.49986388 -1.49993989 -1.50006592 -1.50026544 -1.50057068 -1.5010238
 -1.50167564 -1.50257898 -1.50377191 -1.50524791 -1.50691602 -1.50857033
 -1.50990493 -1.51060284 -1.51047421 -1.50955526 -1.50808857 -1.50640137
 -1.50477517 -1.50337982 -1.50227653 -1.50145437 -1.5008683  -1.50046492
 -1.50019563 -1.50002129 -1.49991251 -1.49984809 -1.4998132  -1.49979762
 -1.4997944  -1.49979889 -1.49980797 -1.49981959 -1.49983241 -1.49984557
 -1.49985853 -1.49987097 -1.49988271 -1.49989365 -1.49990377 -1.49991308
 -1.49992159 -1.49992937 -1.49993645 -1.4999429  -1.49994875 -1.49995407
 -1.4999589  -1.49996328 -1.49996726 -1.49997087 -1.49997414 -1.49997712
 -1.49997981 -1.49998226 -1.49998447 -1.49998648 -1.49998829 -1.49998993
 -1.4999914  -1.49999273 -1.49999392 -1.49999498 -1.49999592 -1.49999675
 -1.49999747 -1.4999981  -1.49999863 -1.49999907 -1.49999942 -1.49999969
 -1.49999987 -1.49999997 -1.5        -1.49999994 -1.49999981 -1.49999959
 -1.49999929 -1.4999989  -1.49999842 -1.49999786 -1.49999719 -1.49999643
 -1.49999556 -1.49999457 -1.49999346 -1.49999221 -1.49999083 -1.49998929
 -1.49998758 -1.49998569 -1.4999836  -1.4999813  -1.49997876 -1.49997595
 -1.49997286 -1.49996946 -1.4999657  -1.49996157 -1.49995701 -1.49995199
 -1.49994646 -1.49994037 -1.49993368 -1.49992632 -1.49991825 -1.49990942
 -1.49989979 -1.49988934 -1.49987807 -1.49986604 -1.49985336 -1.49984027
 -1.49982716 -1.4998147  -1.49980391 -1.49979638 -1.49979455 -1.49980208
 -1.49982445 -1.49986979 -1.49994999 -1.50008223 -1.50029079 -1.50060886
 -1.50107959 -1.50175446 -1.50268571 -1.50390854 -1.50540978 -1.50708783
 -1.50872493 -1.51000875 -1.51062866 -1.51041471 -1.509427   -1.50792313
 -1.50623094 -1.50462231 -1.50325515 -1.50218152 -1.5013855  -1.50082025
 -1.50043244 -1.50017432 -1.50000777 -1.4999043  -1.49984344 -1.49981089
 -1.49979682 -1.49979457 -1.49979964 -1.49980906 -1.49982085 -1.49983373
 -1.49984689 -1.49985981 -1.49987219 -1.49988385 -1.49989471 -1.49990475
 -1.49991397 -1.49992241 -1.49993011 -1.49993713 -1.49994351 -1.49994931
 -1.49995458 -1.49995936 -1.4999637  -1.49996764 -1.49997121 -1.49997446
 -1.4999774  -1.49998007 -1.49998249 -1.49998468 -1.49998667 -1.49998846
 -1.49999008 -1.49999154 -1.49999286 -1.49999403 -1.49999508 -1.49999601
 -1.49999683 -1.49999754 -1.49999816 -1.49999868 -1.49999911 -1.49999945
 -1.49999971 -1.49999988 -1.49999998 -1.5        -1.49999993 -1.49999979
 -1.49999956 -1.49999925 -1.49999886 -1.49999837 -1.4999978  -1.49999712
 -1.49999635 -1.49999546 -1.49999446 -1.49999334 -1.49999208 -1.49999068
 -1.49998912 -1.4999874  -1.49998549 -1.49998338 -1.49998105 -1.49997849
 -1.49997566 -1.49997253 -1.49996909 -1.4999653  -1.49996113 -1.49995652
 -1.49995145 -1.49994587 -1.49993973 -1.49993297 -1.49992554 -1.4999174
 -1.49990849 -1.49989878 -1.49988824 -1.49987689 -1.49986478 -1.49985205
 -1.49983894 -1.49982587 -1.49981352 -1.49980297 -1.49979589 -1.49979481
 -1.49980355 -1.49982782 -1.49987606 -1.49996062 -1.50009932 -1.50031724
 -1.50064858 -1.50113745 -1.50183589 -1.50279545 -1.50404807 -1.50557355
 -1.50725931 -1.50887594 -1.51010569 -1.51064581 -1.51034718 -1.50929344
 -1.50775585 -1.50606146 -1.504472   -1.50313352 -1.50208936 -1.50131897
 -1.50077398 -1.50040126 -1.50015393 -1.49999488 -1.49989651 -1.49983907
 -1.49980877 -1.49979615 -1.49979481 -1.49980043 -1.49981016 -1.49982211
 -1.49983506 -1.49984821 -1.49986109 -1.4998734  -1.49988498 -1.49989576
 -1.49990571 -1.49991486 -1.49992322 -1.49993085 -1.4999378  -1.49994412
 -1.49994987 -1.49995508 -1.49995982 -1.49996411 -1.49996802 -1.49997156
 -1.49997477 -1.49997768 -1.49998032 -1.49998272 -1.49998489 -1.49998686
 -1.49998863 -1.49999024 -1.49999168 -1.49999298 -1.49999414 -1.49999518
 -1.4999961  -1.4999969  -1.49999761 -1.49999821 -1.49999872 -1.49999914
 -1.49999948 -1.49999973 -1.4999999  -1.49999999 -1.49999999 -1.49999992
 -1.49999977 -1.49999953 -1.49999922 -1.49999881 -1.49999832 -1.49999773
 -1.49999705 -1.49999626 -1.49999537 -1.49999435 -1.49999322 -1.49999195
 -1.49999053 -1.49998896 -1.49998722 -1.49998529 -1.49998316 -1.49998081
 -1.49997821 -1.49997535 -1.4999722  -1.49996873 -1.4999649  -1.49996068
 -1.49995603 -1.49995092 -1.49994528 -1.49993907 -1.49993225 -1.49992475
 -1.49991654 -1.49990755 -1.49989775 -1.49988713 -1.4998757  -1.49986353
 -1.49985074 -1.49983761 -1.49982457 -1.49981235 -1.49980207 -1.49979546
 -1.49979517 -1.49980518 -1.49983142 -1.49988269 -1.49997179 -1.5001172
 -1.50034484 -1.50068989 -1.50119744 -1.50191999 -1.5029082  -1.50419046
 -1.50573905 -1.50743018 -1.50902301 -1.5101955  -1.51065423 -1.51027181
 -1.50915493 -1.50758703 -1.50589314 -1.50432432 -1.50301493 -1.502
 -1.50125473 -1.50072947 -1.50037135 -1.50013443 -1.4999826  -1.49988914
 -1.49983497 -1.49980682 -1.49979559 -1.49979512 -1.49980126 -1.49981129
 -1.49982339 -1.49983638 -1.49984953 -1.49986236 -1.4998746  -1.49988611
 -1.4998968  -1.49990667 -1.49991573 -1.49992402 -1.49993158 -1.49993847
 -1.49994473 -1.49995041 -1.49995558 -1.49996027 -1.49996453 -1.49996839
 -1.49997189 -1.49997507 -1.49997796 -1.49998058 -1.49998295 -1.4999851
 -1.49998704 -1.4999888  -1.49999039 -1.49999182 -1.4999931  -1.49999425
 -1.49999528 -1.49999618 -1.49999698 -1.49999767 -1.49999827 -1.49999877
 -1.49999918 -1.49999951 -1.49999975 -1.49999991 -1.49999999 -1.49999999
 -1.49999991 -1.49999975 -1.49999951 -1.49999918 -1.49999877 -1.49999826
 -1.49999767 -1.49999697 -1.49999618 -1.49999527 -1.49999424 -1.49999309
 -1.49999181 -1.49999038 -1.49998879 -1.49998703 -1.49998508 -1.49998293
 -1.49998056 -1.49997794 -1.49997505 -1.49997187 -1.49996836 -1.49996449
 -1.49996023 -1.49995554 -1.49995037 -1.49994468 -1.49993841 -1.49993153
 -1.49992396 -1.49991567 -1.4999066  -1.49989672 -1.49988602 -1.49987451
 -1.49986226 -1.49984943 -1.49983628 -1.49982329 -1.4998112  -1.4998012
 -1.49979509 -1.49979563 -1.49980697 -1.49983528 -1.49988969 -1.49998353
 -1.50013591 -1.50037362 -1.50073284 -1.50125961 -1.5020068  -1.50302398
 -1.50433563 -1.5059061  -1.50760012 -1.50916579 -1.5102779  -1.51065389
 -1.51018882 -1.5090118  -1.50741701 -1.5057262  -1.50417936 -1.50289938
 -1.5019134  -1.50119273 -1.50068664 -1.50034266 -1.50011579 -1.49997091
 -1.49988216 -1.49983114 -1.49980505 -1.49979514 -1.49979549 -1.49980214
 -1.49981244 -1.49982467 -1.49983771 -1.49985084 -1.49986362 -1.4998758
 -1.49988722 -1.49989783 -1.49990762 -1.4999166  -1.49992482 -1.49993231
 -1.49993912 -1.49994532 -1.49995096 -1.49995607 -1.49996072 -1.49996493
 -1.49996876 -1.49997223 -1.49997538 -1.49997824 -1.49998083 -1.49998318
 -1.4999853  -1.49998723 -1.49998897 -1.49999054 -1.49999196 -1.49999323
 -1.49999436 -1.49999537 -1.49999627 -1.49999705 -1.49999774 -1.49999832
 -1.49999881 -1.49999922 -1.49999954 -1.49999977 -1.49999992 -1.49999999
 -1.49999999 -1.4999999  -1.49999973 -1.49999948 -1.49999914 -1.49999872
 -1.49999821 -1.4999976  -1.4999969  -1.49999609 -1.49999517 -1.49999413
 -1.49999297 -1.49999167 -1.49999023 -1.49998862 -1.49998684 -1.49998488
 -1.4999827  -1.4999803  -1.49997766 -1.49997474 -1.49997153 -1.49996799
 -1.49996408 -1.49995978 -1.49995504 -1.49994982 -1.49994408 -1.49993775
 -1.49993079 -1.49992316 -1.49991479 -1.49990564 -1.49989568 -1.49988489
 -1.49987331 -1.49986099 -1.49984811 -1.49983496 -1.49982202 -1.49981008
 -1.49980037 -1.49979479 -1.4997962  -1.49980893 -1.4998394  -1.4998971
 -1.49999586 -1.50015547 -1.50040363 -1.5007775  -1.50132402 -1.50209638
 -1.50314281 -1.50448352 -1.50607451 -1.50776883 -1.50930394 -1.51035268
 -1.5106448  -1.51009845 -1.50886441 -1.50724608 -1.50556083 -1.50403719
 -1.50278686 -1.50182951 -1.50113291 -1.50064545 -1.50031516 -1.50009797
 -1.49995978 -1.49987556 -1.49982755 -1.49980343 -1.49979479 -1.49979593
 -1.49980304 -1.49981361 -1.49982597 -1.49983904 -1.49985215 -1.49986488
 -1.49987698 -1.49988833 -1.49989886 -1.49990856 -1.49991746 -1.4999256
 -1.49993302 -1.49993978 -1.49994592 -1.4999515  -1.49995656 -1.49996116
 -1.49996533 -1.49996912 -1.49997256 -1.49997568 -1.49997851 -1.49998107
 -1.4999834  -1.49998551 -1.49998741 -1.49998914 -1.49999069 -1.49999209
 -1.49999335 -1.49999447 -1.49999547 -1.49999635 -1.49999713 -1.4999978
 -1.49999838 -1.49999886 -1.49999925 -1.49999956 -1.49999979 -1.49999993
 -1.5        -1.49999998 -1.49999988 -1.49999971 -1.49999945 -1.4999991
 -1.49999867 -1.49999815 -1.49999754 -1.49999682 -1.499996   -1.49999507
 -1.49999402 -1.49999285 -1.49999153 -1.49999007 -1.49998845 -1.49998665
 -1.49998467 -1.49998247 -1.49998005 -1.49997738 -1.49997443 -1.49997119
 -1.49996761 -1.49996367 -1.49995932 -1.49995454 -1.49994927 -1.49994346
 -1.49993708 -1.49993006 -1.49992235 -1.4999139  -1.49990467 -1.49989463
 -1.49988376 -1.4998721  -1.49985972 -1.49984679 -1.49983363 -1.49982075
 -1.49980897 -1.49979958 -1.49979455 -1.49979688 -1.49981106 -1.49984379
 -1.49990491 -1.50000879 -1.50017593 -1.5004349  -1.50082389 -1.50139073
 -1.50218876 -1.50326468 -1.50463403 -1.50624407 -1.50793598 -1.5094371
 -1.5104196  -1.51062698 -1.51000097 -1.50871311 -1.50707457 -1.50539721
 -1.50389788 -1.50267736 -1.50174828 -1.50107521 -1.50060585 -1.50028879
 -1.50008095 -1.49994919 -1.49986932 -1.4998242  -1.49980197 -1.49979453
 -1.49979642 -1.49980398 -1.49981479 -1.49982726 -1.49984037 -1.49985346
 -1.49986613 -1.49987816 -1.49988943 -1.49989987 -1.49990949 -1.49991832
 -1.49992638 -1.49993373 -1.49994042 -1.4999465  -1.49995203 -1.49995705
 -1.4999616  -1.49996573 -1.49996948 -1.49997289 -1.49997598 -1.49997878
 -1.49998132 -1.49998362 -1.49998571 -1.4999876  -1.4999893  -1.49999084
 -1.49999222 -1.49999347 -1.49999458 -1.49999556 -1.49999644 -1.4999972
 -1.49999786 -1.49999843 -1.4999989  -1.49999929 -1.49999959 -1.49999981
 -1.49999994 -1.5        -1.49999997 -1.49999987 -1.49999968 -1.49999942
 -1.49999906 -1.49999862 -1.49999809 -1.49999747 -1.49999674 -1.49999591
 -1.49999497 -1.49999391 -1.49999272 -1.49999139 -1.49998992 -1.49998828
 -1.49998646 -1.49998446 -1.49998224 -1.49997979 -1.49997709 -1.49997412
 -1.49997084 -1.49996723 -1.49996325 -1.49995886 -1.49995403 -1.49994871
 -1.49994285 -1.4999364  -1.49992931 -1.49992153]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="scattering-and-cross-sections">
<h2><span class="section-number">2.6. </span>Scattering and Cross Sections<a class="headerlink" href="#scattering-and-cross-sections" title="Permalink to this headline">¶</a></h2>
<p>Scattering experiments don’t measure entire trajectories. For elastic
collisions, they measure the distribution of final scattering angles
at best. Most experiments use targets thin enough so that the number
of scatterings is typically zero or one. The cross section, <span class="math notranslate nohighlight">\(\sigma\)</span>,
describes the cross-sectional area for particles to scatter with an
individual target atom or nucleus. Cross section measurements form the
basis for MANY fields of physics. BThe cross section, and the
differential cross section, encapsulates everything measurable for a
collision where all that is measured is the final state, e.g. the
outgoing particle had momentum <span class="math notranslate nohighlight">\(\boldsymbol{p}_f\)</span>. y studying cross sections,
one can infer information about the potential interaction between the
two particles. Inferring, or constraining, the potential from the
cross section is a classic {\it inverse} problem. Collisions are
either elastic or inelastic. Elastic collisions are those for which
the two bodies are in the same internal state before and after the
collision. If the collision excites one of the participants into a
higher state, or transforms the particles into different species, or
creates additional particles, the collision is inelastic. Here, we
consider only elastic collisions.</p>
<p>For Coulomb forces, the cross section is infinite because the range of
the Coulomb force is infinite, but for interactions such as the strong
interaction in nuclear or particle physics, there is no long-range
force and cross-sections are finite. Even for Coulomb forces, the part
of the cross section that corresponds to a specific scattering angle,
<span class="math notranslate nohighlight">\(d\sigma/d\Omega\)</span>, which is a function of the scattering angle
<span class="math notranslate nohighlight">\(\phi_s\)</span> is still finite.</p>
<p>If a particle travels through a thin target, the chance the particle
scatters is <span class="math notranslate nohighlight">\(P_{\rm scatt}=\sigma dN/dA\)</span>, where <span class="math notranslate nohighlight">\(dN/dA\)</span> is the number
of scattering centers per area the particle encounters. If the density
of the target is <span class="math notranslate nohighlight">\(\rho\)</span> particles per volume, and if the thickness of
the target is <span class="math notranslate nohighlight">\(t\)</span>, the areal density (number of target scatterers per
area) is <span class="math notranslate nohighlight">\(dN/dA=\rho t\)</span>. Because one wishes to quantify the collisions
independently of the target, experimentalists measure scattering
probabilities, then divide by the areal density to obtain
cross-sections,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
\sigma=\frac{P_{\rm scatt}}{dN/dA}.
\end{eqnarray}
\]</div>
<p>Instead of merely stating that a particle collided, one can measure
the probability the particle scattered by a given angle. The
scattering angle <span class="math notranslate nohighlight">\(\phi_s\)</span> is defined so that at zero the particle is
unscattered and at <span class="math notranslate nohighlight">\(\phi_s=\pi\)</span> the particle is scattered directly
backward. Scattering angles are often described in the center-of-mass
frame, but that is a detail we will neglect for this first discussion,
where we will consider the scattering of particles moving classically
under the influence of fixed potentials <span class="math notranslate nohighlight">\(U(\boldsymbol{r})\)</span>. Because the
distribution of scattering angles can be measured, one expresses the
differential cross section,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto5"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{d^2\sigma}{d\cos\phi_s~d\phi}.
\label{_auto5} \tag{10}
\end{equation}
\]</div>
<p>Usually, the literature expresses differential cross sections as</p>
<!-- Equation labels as ordinary links -->
<div id="_auto6"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
d\sigma/d\Omega=\frac{d\sigma}{d\cos\phi d\phi}=\frac{1}{2\pi}\frac{d\sigma}{d\cos\phi},
\label{_auto6} \tag{11}
\end{equation}
\]</div>
<p>where the last equivalency is true when the scattering does not depend
on the azimuthal angle <span class="math notranslate nohighlight">\(\phi\)</span>, as is the case for spherically
symmetric potentials.</p>
<p>The differential solid angle <span class="math notranslate nohighlight">\(d\Omega\)</span> can be thought of as the area
subtended by a measurement, <span class="math notranslate nohighlight">\(dA_d\)</span>, divided by <span class="math notranslate nohighlight">\(r^2\)</span>, where <span class="math notranslate nohighlight">\(r\)</span> is the
distance to the detector,</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
dA_d=r^2 d\Omega.
\end{eqnarray}
\]</div>
<p>With this definition <span class="math notranslate nohighlight">\(d\sigma/d\Omega\)</span> is independent of the distance
from which one places the detector, or the size of the detector (as
long as it is small).</p>
<p>Differential scattering cross sections are calculated by assuming a
random distribution of impact parameters <span class="math notranslate nohighlight">\(b\)</span>. These represent the
distance in the <span class="math notranslate nohighlight">\(xy\)</span> plane for particles moving in the <span class="math notranslate nohighlight">\(z\)</span> direction
relative to the scattering center. An impact parameter <span class="math notranslate nohighlight">\(b=0\)</span> refers to
being aimed directly at the target’s center. The impact parameter
describes the transverse distance from the <span class="math notranslate nohighlight">\(z=0\)</span> axis for the
trajectory when it is still far away from the scattering center and
has not yet passed it. The differential cross section can be expressed
in terms of the impact parameter,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto7"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
d\sigma=2\pi bdb,
\label{_auto7} \tag{12}
\end{equation}
\]</div>
<p>which is the area of a thin ring of radius <span class="math notranslate nohighlight">\(b\)</span> and thickness <span class="math notranslate nohighlight">\(db\)</span>. In
classical physics, one can calculate the trajectory given the incoming
kinetic energy <span class="math notranslate nohighlight">\(E\)</span> and the impact parameter if one knows the mass and
potential. From the trajectory, one then finds the scattering angle
<span class="math notranslate nohighlight">\(\phi_s(b)\)</span>. The differential cross section is then</p>
<!-- Equation labels as ordinary links -->
<div id="_auto8"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{d\sigma}{d\Omega}=\frac{1}{2\pi}\frac{d\sigma}{d\cos\phi_s}=b\frac{db}{d\cos\phi_s}=\frac{b}{(d/db)\cos\phi_s(b)}.
\label{_auto8} \tag{13}
\end{equation}
\]</div>
<p>Typically, one would calculate <span class="math notranslate nohighlight">\(\cos\phi_s\)</span> and <span class="math notranslate nohighlight">\((d/db)\cos\phi_s\)</span>
as functions of <span class="math notranslate nohighlight">\(b\)</span>. This is sufficient to plot the differential cross
section as a function of <span class="math notranslate nohighlight">\(\phi_s\)</span>.</p>
<p>The total cross section is</p>
<!-- Equation labels as ordinary links -->
<div id="_auto9"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\sigma_{\rm tot}=\int d\Omega\frac{d\sigma}{d\Omega}=2\pi\int d\cos\phi_s~\frac{d\sigma}{d\Omega}. 
\label{_auto9} \tag{14}
\end{equation}
\]</div>
<p>Even if the total cross section is infinite, e.g. Coulomb forces, one
can still have a finite differential cross section as we will see
later on.</p>
<p>An asteroid of mass <span class="math notranslate nohighlight">\(m\)</span> and kinetic energy <span class="math notranslate nohighlight">\(E\)</span> approaches a planet of
radius <span class="math notranslate nohighlight">\(R\)</span> and mass <span class="math notranslate nohighlight">\(M\)</span>. What is the cross section for the asteroid to
impact the planet?</p>
<div class="section" id="solution">
<h3><span class="section-number">2.6.1. </span>Solution<a class="headerlink" href="#solution" title="Permalink to this headline">¶</a></h3>
<p>Calculate the maximum impact parameter, <span class="math notranslate nohighlight">\(b_{\rm max}\)</span>, for which the asteroid will hit the planet. The total cross  section for impact is <span class="math notranslate nohighlight">\(\sigma_{\rm impact}=\pi b_{\rm max}^2\)</span>. The maximum cross-section can be found with the help of angular momentum conservation. The asteroid’s incoming momentum is <span class="math notranslate nohighlight">\(p_0=\sqrt{2mE}\)</span> and the angular momentum is <span class="math notranslate nohighlight">\(L=p_0b\)</span>. If the asteroid just grazes the planet, it is moving with zero radial kinetic energy at impact. Combining energy and angular momentum conservation and having <span class="math notranslate nohighlight">\(p_f\)</span> refer to the momentum of the asteroid at a distance <span class="math notranslate nohighlight">\(R\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\frac{p_f^2}{2m}-\frac{GMm}{R}&amp;=&amp;E,\\
p_fR&amp;=&amp;p_0b_{\rm max},
\end{eqnarray*}
\end{split}\]</div>
<p>allows one to solve for <span class="math notranslate nohighlight">\(b_{\rm max}\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
b_{\rm max}&amp;=&amp;R\frac{p_f}{p_0}\\
&amp;=&amp;R\frac{\sqrt{2m(E+GMm/R)}}{\sqrt{2mE}}\\
\sigma_{\rm impact}&amp;=&amp;\pi R^2\frac{E+GMm/R}{E}.
\end{eqnarray*}
\end{split}\]</div>
</div>
</div>
<div class="section" id="rutherford-scattering">
<h2><span class="section-number">2.7. </span>Rutherford Scattering<a class="headerlink" href="#rutherford-scattering" title="Permalink to this headline">¶</a></h2>
<p>This refers to the calculation of <span class="math notranslate nohighlight">\(d\sigma/d\Omega\)</span> due to an inverse
square force, <span class="math notranslate nohighlight">\(F_{12}=\pm\alpha/r^2\)</span> for repulsive/attractive
interaction. Rutherford compared the scattering of <span class="math notranslate nohighlight">\(\alpha\)</span> particles
(<span class="math notranslate nohighlight">\(^4\)</span>He nuclei) off of a nucleus and found the scattering angle at
which the formula began to fail. This corresponded to the impact
parameter for which the trajectories would strike the nucleus. This
provided the first measure of the size of the atomic nucleus. At the
time, the distribution of the positive charge (the protons) was
considered to be just as spread out amongst the atomic volume as the
electrons. After Rutherford’s experiment, it was clear that the radius
of the nucleus tended to be roughly 4 orders of magnitude smaller than
that of the atom, which is less than the size of a football relative
to Spartan Stadium.</p>
<p>The incoming and outgoing angles of the trajectory are at
<span class="math notranslate nohighlight">\(\pm\phi'\)</span>. They are related to the scattering angle by
<span class="math notranslate nohighlight">\(2\phi'=\pi+\phi_s\)</span>.</p>
<p>In order to calculate differential cross section, we must find how the
impact parameter is related to the scattering angle. This requires
analysis of the trajectory. We consider our previous expression for
the trajectory where we derived the elliptic form for the trajectory,
Eq. (<a class="reference external" href="#eq:Ctrajectory">9</a>). For that case we considered an attractive
force with the particle’s energy being negative, i.e. it was
bound. However, the same form will work for positive energy, and
repulsive forces can be considered by simple flipping the sign of
<span class="math notranslate nohighlight">\(\alpha\)</span>. For positive energies, the trajectories will be hyperbolas,
rather than ellipses, with the asymptotes of the trajectories
representing the directions of the incoming and outgoing
tracks. Rewriting Eq. (<a class="reference external" href="#eq:Ctrajectory">9</a>),</p>
<!-- Equation labels as ordinary links -->
<div id="eq:ruthtraj"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}\label{eq:ruthtraj} \tag{15}
r=\frac{1}{\frac{m\alpha}{L^2}+A\cos\phi}.
\end{equation}
\]</div>
<p>Once <span class="math notranslate nohighlight">\(A\)</span> is large enough, which will happen when the energy is
positive, the denominator will become negative for a range of
<span class="math notranslate nohighlight">\(\phi\)</span>. This is because the scattered particle will never reach
certain angles. The asymptotic angles <span class="math notranslate nohighlight">\(\phi'\)</span> are those for which
the denominator goes to zero,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto10"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\cos\phi'=-\frac{m\alpha}{AL^2}.
\label{_auto10} \tag{16}
\end{equation}
\]</div>
<p>The trajectory’s point of closest approach is at <span class="math notranslate nohighlight">\(\phi=0\)</span> and the
two angles <span class="math notranslate nohighlight">\(\phi'\)</span>, which have this value of <span class="math notranslate nohighlight">\(\cos\phi'\)</span>, are the
angles of the incoming and outgoing particles. From
Fig (<strong>to come</strong>), one can see that the scattering angle
<span class="math notranslate nohighlight">\(\phi_s\)</span> is given by,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:sthetover2"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:sthetover2} \tag{17}
2\phi'-\pi&amp;=&amp;\phi_s,~~~\phi'=\frac{\pi}{2}+\frac{\phi_s}{2},\\
\nonumber
\sin(\phi_s/2)&amp;=&amp;-\cos\phi'\\
\nonumber
&amp;=&amp;\frac{m\alpha}{AL^2}.
\end{eqnarray}
\end{split}\]</div>
<p>Now that we have <span class="math notranslate nohighlight">\(\phi_s\)</span> in terms of <span class="math notranslate nohighlight">\(m,\alpha,L\)</span> and <span class="math notranslate nohighlight">\(A\)</span>, we wish
to re-express <span class="math notranslate nohighlight">\(L\)</span> and <span class="math notranslate nohighlight">\(A\)</span> in terms of the impact parameter <span class="math notranslate nohighlight">\(b\)</span> and the
energy <span class="math notranslate nohighlight">\(E\)</span>. This will set us up to calculate the differential cross
section, which requires knowing <span class="math notranslate nohighlight">\(db/d\phi_s\)</span>. It is easy to write
the angular momentum as</p>
<!-- Equation labels as ordinary links -->
<div id="_auto11"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
L^2=p_0^2b^2=2mEb^2.
\label{_auto11} \tag{18}
\end{equation}
\]</div>
<p>Finding <span class="math notranslate nohighlight">\(A\)</span> is more complicated. To accomplish this we realize that
the point of closest approach occurs at <span class="math notranslate nohighlight">\(\phi=0\)</span>, so from
Eq. (<a class="reference external" href="#eq:ruthtraj">15</a>)</p>
<!-- Equation labels as ordinary links -->
<div id="eq:rminofA"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:rminofA} \tag{19}
\frac{1}{r_{\rm min}}&amp;=&amp;\frac{m\alpha}{L^2}+A,\\
\nonumber
A&amp;=&amp;\frac{1}{r_{\rm min}}-\frac{m\alpha}{L^2}.
\end{eqnarray}
\end{split}\]</div>
<p>Next, <span class="math notranslate nohighlight">\(r_{\rm min}\)</span> can be found in terms of the energy because at the
point of closest approach the kinetic energy is due purely to the
motion perpendicular to <span class="math notranslate nohighlight">\(\hat{r}\)</span> and</p>
<!-- Equation labels as ordinary links -->
<div id="_auto12"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
E=-\frac{\alpha}{r_{\rm min}}+\frac{L^2}{2mr_{\rm min}^2}.
\label{_auto12} \tag{20}
\end{equation}
\]</div>
<p>One can solve the quadratic equation for <span class="math notranslate nohighlight">\(1/r_{\rm min}\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto13"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{1}{r_{\rm min}}=\frac{m\alpha}{L^2}+\sqrt{(m\alpha/L^2)^2+2mE/L^2}.
\label{_auto13} \tag{21}
\end{equation}
\]</div>
<p>We can plug the expression for <span class="math notranslate nohighlight">\(r_{\rm min}\)</span> into the expression for <span class="math notranslate nohighlight">\(A\)</span>, Eq. (<a class="reference external" href="#eq:rminofA">19</a>),</p>
<!-- Equation labels as ordinary links -->
<div id="_auto14"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
A=\sqrt{(m\alpha/L^2)^2+2mE/L^2}=\sqrt{(\alpha^2/(4E^2b^4)+1/b^2}
\label{_auto14} \tag{22}
\end{equation}
\]</div>
<p>Finally, we insert the expression for <span class="math notranslate nohighlight">\(A\)</span> into that for the scattering angle, Eq. (<a class="reference external" href="#eq:sthetover2">17</a>),</p>
<!-- Equation labels as ordinary links -->
<div id="eq:scattangle"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:scattangle} \tag{23}
\sin(\phi_s/2)&amp;=&amp;\frac{m\alpha}{AL^2}\\
\nonumber
&amp;=&amp;\frac{a}{\sqrt{a^2+b^2}}, ~~a\equiv \frac{\alpha}{2E}
\end{eqnarray}
\end{split}\]</div>
<p>The differential cross section can now be found by differentiating the
expression for <span class="math notranslate nohighlight">\(\phi_s\)</span> with <span class="math notranslate nohighlight">\(b\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:rutherford"></div>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\label{eq:rutherford} \tag{24}
\frac{1}{2}\cos(\phi_s/2)d\phi_s&amp;=&amp;\frac{ab~db}{(a^2+b^2)^{3/2}}=\frac{bdb}{a^2}\sin^3(\phi_s/2),\\
\nonumber
d\sigma&amp;=&amp;2\pi bdb=\frac{\pi a^2}{\sin^3(\phi_s/2)}\cos(\phi_s/2)d\phi_s\\
\nonumber
&amp;=&amp;\frac{\pi a^2}{2\sin^4(\phi_s/2)}\sin\phi_s d\phi_s\\
\nonumber
\frac{d\sigma}{d\cos\phi_s}&amp;=&amp;\frac{\pi a^2}{2\sin^4(\phi_s/2)},\\
\nonumber
\frac{d\sigma}{d\Omega}&amp;=&amp;\frac{a^2}{4\sin^4(\phi_s/2)}.
\end{eqnarray}
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(a= \alpha/2E\)</span>. This the Rutherford formula for the differential
cross section. It diverges as <span class="math notranslate nohighlight">\(\phi_s\rightarrow 0\)</span> because
scatterings with arbitrarily large impact parameters still scatter to
arbitrarily small scattering angles. The expression for
<span class="math notranslate nohighlight">\(d\sigma/d\Omega\)</span> is the same whether the interaction is positive or
negative.</p>
<p>Consider a particle of mass <span class="math notranslate nohighlight">\(m\)</span> and charge <span class="math notranslate nohighlight">\(z\)</span> with kinetic energy <span class="math notranslate nohighlight">\(E\)</span>
(Let it be the center-of-mass energy) incident on a heavy nucleus of
mass <span class="math notranslate nohighlight">\(M\)</span> and charge <span class="math notranslate nohighlight">\(Z\)</span> and radius <span class="math notranslate nohighlight">\(R\)</span>. Find the angle at which the
Rutherford scattering formula breaks down.</p>
<div class="section" id="id1">
<h3><span class="section-number">2.7.1. </span>Solution<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Let <span class="math notranslate nohighlight">\(\alpha=Zze^2/(4\pi\epsilon_0)\)</span>. The scattering angle in Eq. (<a class="reference external" href="#eq:scattangle">23</a>) is</p>
<div class="math notranslate nohighlight">
\[
\sin(\phi_s/2)=\frac{a}{\sqrt{a^2+b^2}}, ~~a\equiv \frac{\alpha}{2E}.
\]</div>
<p>The impact parameter <span class="math notranslate nohighlight">\(b\)</span> for which the point of closest approach
equals <span class="math notranslate nohighlight">\(R\)</span> can be found by using angular momentum conservation,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
p_0b&amp;=&amp;b\sqrt{2mE}=Rp_f=R\sqrt{2m(E-\alpha/R)},\\
b&amp;=&amp;R\frac{\sqrt{2m(E-\alpha/R)}}{\sqrt{2mE}}\\
&amp;=&amp;R\sqrt{1-\frac{\alpha}{ER}}.
\end{eqnarray*}
\end{split}\]</div>
<p>Putting these together</p>
<div class="math notranslate nohighlight">
\[
\phi_s=2\sin^{-1}\left\{
\frac{a}{\sqrt{a^2+R^2(1-\alpha/(RE))}}
\right\},~~~a=\frac{\alpha}{2E}.
\]</div>
<p>It was from this departure of the experimentally measured
<span class="math notranslate nohighlight">\(d\sigma/d\Omega\)</span> from the Rutherford formula that allowed Rutherford
to infer the radius of the gold nucleus, <span class="math notranslate nohighlight">\(R\)</span>.</p>
<p>Just like electrodynamics, one can define “fields”, which for a small
additional mass <span class="math notranslate nohighlight">\(m\)</span> are the force per mass and the additional
potential energy per mass. The {\it gravitational field} related to
the force has dimensions of force per mass, or acceleration, and can
be labeled <span class="math notranslate nohighlight">\(\boldsymbol{g}(\boldsymbol{r})\)</span>. The potential energy per mass has
dimensions of energy per mass. This is analogous to the
electromagnetic potential, which is the potential energy per charge,
and the electric field which is the force per charge.</p>
<p>Because the field <span class="math notranslate nohighlight">\(\boldsymbol{g}\)</span> obeys the same inverse square law for a
point mass as the electric field does for a point charge, the
gravitational field also satisfies a version of Gauss’s law,</p>
<!-- Equation labels as ordinary links -->
<div id="eq:GravGauss"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\label{eq:GravGauss} \tag{25}
\oint d\boldsymbol{A}\cdot\boldsymbol{g}=-4\pi GM_{\rm inside}.
\end{equation}
\]</div>
<p>Here, <span class="math notranslate nohighlight">\(M_{\rm inside}\)</span> is the net mass inside a closed area.</p>
<p>Gauss’s law can be understood by considering a nozzle that sprays
paint in all directions uniformly from a point source. Let <span class="math notranslate nohighlight">\(B\)</span> be the
number of gallons per minute of paint leaving the nozzle. If the
nozzle is at the center of a sphere of radius <span class="math notranslate nohighlight">\(r\)</span>, the paint per
square meter per minute that is deposited on some part of the sphere
is</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
F(r)&amp;=&amp;\frac{B}{4\pi r^2}.
\end{eqnarray}
\]</div>
<p>Now, let <span class="math notranslate nohighlight">\(F\)</span> also be assigned a direction, so that it becomes a vector
pointing along the direction of the flying paint. For any surface that
surrounds the nozzle, not necessarily a sphere, one can state that</p>
<!-- Equation labels as ordinary links -->
<div id="eq:paint"></div>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
\label{eq:paint} \tag{26}
\oint \boldsymbol{dA}\cdot\boldsymbol{F}&amp;=&amp;B,
\end{eqnarray}
\]</div>
<p>regardless of the shape of the surface. This follows because the rate
at which paint is deposited on the surface should equal the rate at
which it leaves the nozzle. The dot product ensures that only the
component of <span class="math notranslate nohighlight">\(\boldsymbol{F}\)</span> into the surface contributes to the deposition
of paint. Similarly, if <span class="math notranslate nohighlight">\(\boldsymbol{F}\)</span> is any radial inverse-square forces,
that falls as <span class="math notranslate nohighlight">\(B/(4\pi r^2)\)</span>, then one can apply
Eq. (<a class="reference external" href="#eq:paint">26</a>). For gravitational fields, <span class="math notranslate nohighlight">\(B/(4\pi)\)</span> is replaced
by <span class="math notranslate nohighlight">\(GM\)</span>, and one quickly “derives” Gauss’s law for gravity,
Eq. (<a class="reference external" href="#eq:GravGauss">25</a>).</p>
<p>Consider Earth to have its mass <span class="math notranslate nohighlight">\(M\)</span> uniformly distributed in a sphere
of radius <span class="math notranslate nohighlight">\(R\)</span>. Find the magnitude of the gravitational acceleration as
a function of the radius <span class="math notranslate nohighlight">\(r\)</span> in terms of the acceleration of gravity
at the surface <span class="math notranslate nohighlight">\(g(R)\)</span>. Assume <span class="math notranslate nohighlight">\(r&lt;R\)</span>, i.e. you are inside the surface.</p>
<p>{\bf Solution}: Take the ratio of Eq. (<a class="reference external" href="#eq:GravGauss">25</a>) for two radii, <span class="math notranslate nohighlight">\(R\)</span> and <span class="math notranslate nohighlight">\(r&lt;R\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\frac{4\pi r^2 g(r)}{4\pi R^2 g(R)}&amp;=&amp;\frac{4\pi GM_{\rm inside~r}}{4\pi GM_{\rm inside~R}}\\
\nonumber
&amp;=&amp;\frac{r^3}{R^3}\\
\nonumber
g(r)&amp;=&amp;g(R)\frac{r}{R}~.
\end{eqnarray*}
\end{split}\]</div>
<p>The potential energy per mass is similar conceptually to the voltage, or electric potential energy per charge, that was studied in electromagnetism, if <span class="math notranslate nohighlight">\(V\equiv U/m\)</span>, <span class="math notranslate nohighlight">\(\boldsymbol{g}=-\nabla V\)</span>.</p>
</div>
</div>
<div class="section" id="tidal-forces">
<h2><span class="section-number">2.8. </span>Tidal Forces<a class="headerlink" href="#tidal-forces" title="Permalink to this headline">¶</a></h2>
<p>Consider a spherical planet of radius <span class="math notranslate nohighlight">\(r\)</span> a distance <span class="math notranslate nohighlight">\(D\)</span> from another
body of mass <span class="math notranslate nohighlight">\(M\)</span>. The magnitude of the force due to <span class="math notranslate nohighlight">\(M\)</span> on an small
object of mass <span class="math notranslate nohighlight">\(\delta m\)</span> on surface of the planet can be calculated
by performing a Taylor expansion about the center of the spherical
planet.</p>
<!-- Equation labels as ordinary links -->
<div id="_auto15"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
F=-\frac{GM\delta m}{D^2}+2\frac{GM\delta m}{D^3}\Delta D+\cdots
\label{_auto15} \tag{27}
\end{equation}
\]</div>
<p>If the <span class="math notranslate nohighlight">\(z\)</span> direction points toward the large object, <span class="math notranslate nohighlight">\(\Delta D\)</span> can be
referred to as <span class="math notranslate nohighlight">\(z\)</span>. In the accelerating frame of an observer at the
center of the planet,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto16"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\delta m\frac{d^2 z}{dt^2}=F-\delta ma'+{\rm other~forces~acting~on~} \delta m,
\label{_auto16} \tag{28}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(a'\)</span> is the acceleration of the observer. Because <span class="math notranslate nohighlight">\(\delta ma'\)</span>
equals the gravitational force on <span class="math notranslate nohighlight">\(\delta m\)</span> if it were located at the
planet’s center, one can write</p>
<!-- Equation labels as ordinary links -->
<div id="_auto17"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
m\frac{d^2z}{dt^2}=2\frac{GM\delta m}{D^3}z+{\rm other~forces~acting~on~}\delta m.
\label{_auto17} \tag{29}
\end{equation}
\]</div>
<p>Here the other forces could represent the forces acting on <span class="math notranslate nohighlight">\(\delta m\)</span>
from the spherical planet such as the gravitational force or the
contact force with the surface. If <span class="math notranslate nohighlight">\(\phi\)</span> is the angle w.r.t. the
<span class="math notranslate nohighlight">\(z\)</span> axis, the effective force acting on <span class="math notranslate nohighlight">\(\delta m\)</span> is</p>
<!-- Equation labels as ordinary links -->
<div id="_auto18"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
F_{\rm eff}\approx 2\frac{GM\delta m}{D^3}r\cos\phi\hat{z}+{\rm other~forces~acting~on~}\delta m.
\label{_auto18} \tag{30}
\end{equation}
\]</div>
<p>This first force is the “tidal” force. It pulls objects outward from the center of the object. If the object were covered with water, it would distort the objects shape so that the shape would be elliptical, stretched out along the axis pointing toward the large mass <span class="math notranslate nohighlight">\(M\)</span>. The force is always along (either parallel or antiparallel to) the <span class="math notranslate nohighlight">\(\hat{z}\)</span> direction.</p>
<p>Consider the Earth to be a sphere of radius <span class="math notranslate nohighlight">\(R\)</span> covered with water,
with the gravitational acceleration at the surface noted by <span class="math notranslate nohighlight">\(g\)</span>. Now
assume that a distant body provides an additional constant
gravitational acceleration <span class="math notranslate nohighlight">\(\boldsymbol{a}\)</span> pointed along the <span class="math notranslate nohighlight">\(z\)</span> axis. Find
the distortion of the radius as a function of <span class="math notranslate nohighlight">\(\phi\)</span>. Ignore
planetary rotation and assume <span class="math notranslate nohighlight">\(a&lt;&lt;g\)</span>.</p>
<p>{\bf Solution}: Because Earth would then accelerate with <span class="math notranslate nohighlight">\(a\)</span>, the
field <span class="math notranslate nohighlight">\(a\)</span> would seem invisible in the accelerating frame. A tidal
force would only appear if <span class="math notranslate nohighlight">\(a\)</span> depended on position, i.e. <span class="math notranslate nohighlight">\(\nabla
\boldsymbol{a}\ne 0\)</span>.</p>
<p>Now consider that the field is no longer constant, but that instead <span class="math notranslate nohighlight">\(a=-kz\)</span> with <span class="math notranslate nohighlight">\(|kR|&lt;&lt;g\)</span>.</p>
<p>{\bf Solution}: The surface of the planet needs to be at constant
potential (if the planet is not accelerating). The force per mass,
<span class="math notranslate nohighlight">\(-kz\)</span> is like a spring, and the potential per mass is
<span class="math notranslate nohighlight">\(kz^2/2\)</span>. Otherwise water would move to a point of lower
potential. Thus, the potential energy for a sample mass <span class="math notranslate nohighlight">\(\delta m\)</span> is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
V(R)+\delta m gh(\phi)-\frac{\delta m}{2}kr^2\cos^2\phi={\rm Constant}\\
V(R)+\delta mgh(\phi)-\frac{\delta m}{2}kR^2\cos^2\phi-\delta m kRh(\phi)\cos^2\phi-\frac{\delta m}{2}kh^2(\phi)\cos^2\phi={\rm Constant}.
\end{eqnarray*}
\end{split}\]</div>
<p>Here, the potential due to the external field is <span class="math notranslate nohighlight">\((1/2)kz^2\)</span> so that <span class="math notranslate nohighlight">\(-\nabla U=-kz\)</span>. One now needs to solve for <span class="math notranslate nohighlight">\(h(\phi)\)</span>. Absorbing all the constant terms from both sides of the equation into one constant <span class="math notranslate nohighlight">\(C\)</span>, and because both <span class="math notranslate nohighlight">\(h\)</span> and <span class="math notranslate nohighlight">\(kR\)</span> are small, we can through away terms of order <span class="math notranslate nohighlight">\(h^2\)</span> or <span class="math notranslate nohighlight">\(kRh\)</span>. This gives</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
gh(\phi)-\frac{1}{2}kR^2\cos^2\phi&amp;=&amp;C,\\
h(\phi)&amp;=&amp;\frac{C}{g}+\frac{1}{2g}kR^2\cos^2\phi,\\
h(\phi)&amp;=&amp;\frac{1}{2g}kR^2(\cos^2\phi-1/3).
\end{eqnarray*}
\end{split}\]</div>
<p>The term with the factor of <span class="math notranslate nohighlight">\(1/3\)</span> replaced the constant and was chosen so that the average height of the water would be zero.</p>
<p>The Sun’s mass is <span class="math notranslate nohighlight">\(27\times 10^6\)</span> the Moon’s mass, but the Sun is 390 times further away from Earth as the Sun. What is ratio of the tidal force of the Sun to that of the Moon.</p>
<p>{\bf Solution}: The gravitational force due to an object <span class="math notranslate nohighlight">\(M\)</span> a distance <span class="math notranslate nohighlight">\(D\)</span> away goes as <span class="math notranslate nohighlight">\(M/D^2\)</span>, but the tidal force is only the difference of that force over a distance <span class="math notranslate nohighlight">\(R\)</span>,</p>
<div class="math notranslate nohighlight">
\[
F_{\rm tidal}\propto \frac{M}{D^3}R.
\]</div>
<p>Therefore the ratio of force is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\frac{F_{\rm Sun's~tidal~force}}{F_{\rm Moon's~tidal~force}}
&amp;=&amp;\frac{M_{\rm sun}/D_{\rm sun}^3}{M_{\rm moon}/D_{\rm moon}^3}\\
&amp;=&amp;\frac{27\times 10^6}{390^3}=0.46.
\end{eqnarray*}
\end{split}\]</div>
<p>The Moon more strongly affects tides than the Sun.</p>
</div>
<div class="section" id="exercises">
<h2><span class="section-number">2.9. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-earth-sun-system">
<h3><span class="section-number">2.9.1. </span>The Earth-Sun System<a class="headerlink" href="#the-earth-sun-system" title="Permalink to this headline">¶</a></h3>
<p>We start with a simpler case first, the Earth-Sun system  in two dimensions only.  The gravitational force <span class="math notranslate nohighlight">\(F_G\)</span> on the earth from the sun is</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F}_G=-\frac{GM_{\odot}M_E}{r^3}\boldsymbol{r},
\]</div>
<p>where <span class="math notranslate nohighlight">\(G\)</span> is the gravitational constant,</p>
<div class="math notranslate nohighlight">
\[
M_E=6\times 10^{24}\mathrm{Kg},
\]</div>
<p>the mass of Earth,</p>
<div class="math notranslate nohighlight">
\[
M_{\odot}=2\times 10^{30}\mathrm{Kg},
\]</div>
<p>the mass of the Sun and</p>
<div class="math notranslate nohighlight">
\[
r=1.5\times 10^{11}\mathrm{m},
\]</div>
<p>is the distance between Earth and the Sun. The latter defines what we call an astronomical unit <strong>AU</strong>.
From Newton’s second law we have then for the <span class="math notranslate nohighlight">\(x\)</span> direction</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2x}{dt^2}=-\frac{F_{x}}{M_E},
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2y}{dt^2}=-\frac{F_{y}}{M_E},
\]</div>
<p>for the <span class="math notranslate nohighlight">\(y\)</span> direction.</p>
<p>Here we will use  that  <span class="math notranslate nohighlight">\(x=r\cos{(\theta)}\)</span>, <span class="math notranslate nohighlight">\(y=r\sin{(\theta)}\)</span> and</p>
<div class="math notranslate nohighlight">
\[
r = \sqrt{x^2+y^2}.
\]</div>
<p>We can rewrite these equations</p>
<div class="math notranslate nohighlight">
\[
F_{x}=-\frac{GM_{\odot}M_E}{r^2}\cos{(\theta)}=-\frac{GM_{\odot}M_E}{r^3}x,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
F_{y}=-\frac{GM_{\odot}M_E}{r^2}\sin{(\theta)}=-\frac{GM_{\odot}M_E}{r^3}y,
\]</div>
<p>as four first-order coupled differential equations</p>
<div class="math notranslate nohighlight">
\[
\frac{dv_x}{dt}=-\frac{GM_{\odot}}{r^3}x,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{dx}{dt}=v_x,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{dv_y}{dt}=-\frac{GM_{\odot}}{r^3}y,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{dy}{dt}=v_y.
\]</div>
<p>The four coupled differential equations</p>
<div class="math notranslate nohighlight">
\[
\frac{dv_x}{dt}=-\frac{GM_{\odot}}{r^3}x,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{dx}{dt}=v_x,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{dv_y}{dt}=-\frac{GM_{\odot}}{r^3}y,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{dy}{dt}=v_y,
\]</div>
<p>can be turned into dimensionless equations or we can introduce astronomical units with <span class="math notranslate nohighlight">\(1\)</span> AU = <span class="math notranslate nohighlight">\(1.5\times 10^{11}\)</span>.</p>
<p>Using the equations from circular motion (with <span class="math notranslate nohighlight">\(r =1\mathrm{AU}\)</span>)</p>
<div class="math notranslate nohighlight">
\[
\frac{M_E v^2}{r} = F = \frac{GM_{\odot}M_E}{r^2},
\]</div>
<p>we have</p>
<div class="math notranslate nohighlight">
\[
GM_{\odot}=v^2r,
\]</div>
<p>and using that the velocity of Earth (assuming circular motion) is
<span class="math notranslate nohighlight">\(v = 2\pi r/\mathrm{yr}=2\pi\mathrm{AU}/\mathrm{yr}\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[
GM_{\odot}= v^2r = 4\pi^2 \frac{(\mathrm{AU})^3}{\mathrm{yr}^2}.
\]</div>
<p>The four coupled differential equations can then be discretized using Euler’s method as (with step length <span class="math notranslate nohighlight">\(h\)</span>)</p>
<div class="math notranslate nohighlight">
\[
v_{x,i+1}=v_{x,i}-h\frac{4\pi^2}{r_i^3}x_i,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
x_{i+1}=x_i+hv_{x,i},
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
v_{y,i+1}=v_{y,i}-h\frac{4\pi^2}{r_i^3}y_i,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
y_{i+1}=y_i+hv_{y,i},
\]</div>
<p>The code here implements Euler’s method for the Earth-Sun system using a more compact way of representing the vectors. Alternatively, you could have spelled out all the variables <span class="math notranslate nohighlight">\(v_x\)</span>, <span class="math notranslate nohighlight">\(v_y\)</span>, <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> as one-dimensional arrays.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Where to save the figures and data files</span>
<span class="n">PROJECT_ROOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
<span class="n">FIGURE_ID</span> <span class="o">=</span> <span class="s2">&quot;Results/FigureFiles&quot;</span>
<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s2">&quot;DataFiles/&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">,</span> <span class="n">fig_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_path</span><span class="p">(</span><span class="n">dat_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">,</span> <span class="n">dat_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>


<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># in years</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, a, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># Initial conditions as compact 2-dimensional arrays</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">Fourpi2</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span>
<span class="c1"># Start integrating using Euler&#39;s method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up the acceleration</span>
    <span class="c1"># Here you could have defined your own function for this</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="n">Fourpi2</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position using Euler&#39;s forward method</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">a</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
<span class="c1"># Plot position as function of time    </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="c1">#ax.set_xlim(0, tfinal)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x[AU]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y[AU]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;EarthSunEuler&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_280_0.png" src="_images/chapter6_280_0.png" />
</div>
</div>
<p>We notice here that Euler’s method doesn’t give a stable orbit with for example <span class="math notranslate nohighlight">\(\Delta t =0.01\)</span>. It
means that we cannot trust Euler’s method. Euler’s method does not conserve energy. It is an
example of an integrator which is not
<a class="reference external" href="https://en.wikipedia.org/wiki/Symplectic_integrator">symplectic</a>.</p>
<p>Here we present thus two methods, which with simple changes allow us
to avoid these pitfalls. The simplest possible extension is the
so-called Euler-Cromer method.  The changes we need to make to our
code are indeed marginal here.  We need simply to replace</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>in the above code with the velocity at the new time <span class="math notranslate nohighlight">\(t_{i+1}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>By this simple caveat we get stable orbits.  Below we derive the
Euler-Cromer method as well as one of the most utlized algorithms for
solving the above type of problems, the so-called Velocity-Verlet
method.</p>
<p>Let us repeat Euler’s method.
We have a differential equation</p>
<!-- Equation labels as ordinary links -->
<div id="_auto19"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
  y'(t_i)=f(t_i,y_i)   
\label{_auto19} \tag{31}
\end{equation}
\]</div>
<p>and if we truncate at the first derivative, we have from the Taylor expansion</p>
<!-- Equation labels as ordinary links -->
<div id="eq:euler"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
   y_{i+1}=y(t_i) + (\Delta t) f(t_i,y_i) + O(\Delta t^2), \label{eq:euler} \tag{32}
\end{equation}
\]</div>
<p>which when complemented with <span class="math notranslate nohighlight">\(t_{i+1}=t_i+\Delta t\)</span> forms
the algorithm for the well-known Euler method.
Note that at every step we make an approximation error
of the order of <span class="math notranslate nohighlight">\(O(\Delta t^2)\)</span>, however the total error is the sum over all
steps <span class="math notranslate nohighlight">\(N=(b-a)/(\Delta t)\)</span> for <span class="math notranslate nohighlight">\(t\in [a,b]\)</span>, yielding thus a global error which goes like
<span class="math notranslate nohighlight">\(NO(\Delta t^2)\approx O(\Delta t)\)</span>.</p>
<p>To make Euler’s method more precise we can obviously
decrease <span class="math notranslate nohighlight">\(\Delta t\)</span> (increase <span class="math notranslate nohighlight">\(N\)</span>), but this can lead to loss of numerical precision.
Euler’s method is not recommended for precision calculation,
although it is handy to use in order to get a first
view on how a solution may look like.</p>
<p>Euler’s method is asymmetric in time, since it uses information about the derivative at the beginning
of the time interval. This means that we evaluate the position at <span class="math notranslate nohighlight">\(y_1\)</span> using the velocity
at <span class="math notranslate nohighlight">\(v_0\)</span>. A simple variation is to determine <span class="math notranslate nohighlight">\(x_{n+1}\)</span> using the velocity at
<span class="math notranslate nohighlight">\(v_{n+1}\)</span>, that is (in a slightly more generalized form)</p>
<!-- Equation labels as ordinary links -->
<div id="_auto20"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
   y_{n+1}=y_{n}+ v_{n+1}+O(\Delta t^2)
\label{_auto20} \tag{33}
\end{equation}
\]</div>
<p>and</p>
<!-- Equation labels as ordinary links -->
<div id="_auto21"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
   v_{n+1}=v_{n}+(\Delta t) a_{n}+O(\Delta t^2).
\label{_auto21} \tag{34}
\end{equation}
\]</div>
<p>The acceleration <span class="math notranslate nohighlight">\(a_n\)</span> is a function of <span class="math notranslate nohighlight">\(a_n(y_n, v_n, t_n)\)</span> and needs to be evaluated
as well. This is the Euler-Cromer method. It is easy to change the above code and see that with the same
time step we get stable results.</p>
<p>Let us stay with <span class="math notranslate nohighlight">\(x\)</span> (position) and <span class="math notranslate nohighlight">\(v\)</span> (velocity) as the quantities we are interested in.</p>
<p>We have the Taylor expansion for the position given by</p>
<div class="math notranslate nohighlight">
\[
x_{i+1} = x_i+(\Delta t)v_i+\frac{(\Delta t)^2}{2}a_i+O((\Delta t)^3).
\]</div>
<p>The corresponding expansion for the velocity is</p>
<div class="math notranslate nohighlight">
\[
v_{i+1} = v_i+(\Delta t)a_i+\frac{(\Delta t)^2}{2}v^{(2)}_i+O((\Delta t)^3).
\]</div>
<p>Via Newton’s second law we have normally an analytical expression for the derivative of the velocity, namely</p>
<div class="math notranslate nohighlight">
\[
a_i= \frac{d^2 x}{dt^2}\vert_{i}=\frac{d v}{dt}\vert_{i}= \frac{F(x_i,v_i,t_i)}{m}.
\]</div>
<p>If we add to this the corresponding expansion for the derivative of the velocity</p>
<div class="math notranslate nohighlight">
\[
v^{(1)}_{i+1} = a_{i+1}= a_i+(\Delta t)v^{(2)}_i+O((\Delta t)^2)=a_i+(\Delta t)v^{(2)}_i+O((\Delta t)^2),
\]</div>
<p>and retain only terms up to the second derivative of the velocity since our error goes as <span class="math notranslate nohighlight">\(O(h^3)\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[
(\Delta t)v^{(2)}_i\approx a_{i+1}-a_i.
\]</div>
<p>We can then rewrite the Taylor expansion for the velocity as</p>
<div class="math notranslate nohighlight">
\[
v_{i+1} = v_i+\frac{(\Delta t)}{2}\left( a_{i+1}+a_{i}\right)+O((\Delta t)^3).
\]</div>
<p>Our final equations for the position and the velocity become then</p>
<div class="math notranslate nohighlight">
\[
x_{i+1} = x_i+(\Delta t)v_i+\frac{(\Delta t)^2}{2}a_{i}+O((\Delta t)^3),
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
v_{i+1} = v_i+\frac{(\Delta t)}{2}\left(a_{i+1}+a_{i}\right)+O((\Delta t)^3).
\]</div>
<p>Note well that the term <span class="math notranslate nohighlight">\(a_{i+1}\)</span> depends on the position at <span class="math notranslate nohighlight">\(x_{i+1}\)</span>. This means that you need to calculate
the position at the updated time <span class="math notranslate nohighlight">\(t_{i+1}\)</span> before the computing the next velocity.  Note also that the derivative of the velocity at the time
<span class="math notranslate nohighlight">\(t_i\)</span> used in the updating of the position can be reused in the calculation of the velocity update as well.</p>
<p>We can now easily add the Verlet method to our original code as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, a, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># Initial conditions as compact 2-dimensional arrays</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">Fourpi2</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up forces, air resistance FD, note now that we need the norm of the vecto</span>
    <span class="c1"># Here you could have defined your own function for this</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="n">Fourpi2</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
<span class="c1"># Plot position as function of time    </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x[AU]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y[AU]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;EarthSunVV&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_310_0.png" src="_images/chapter6_310_0.png" />
</div>
</div>
<p>You can easily generalize the calculation of the forces by defining a function
which takes in as input the various variables. We leave this as a challenge to you.</p>
<p>Running the above code for various time steps we see that the Velocity-Verlet is fully stable for various time steps.</p>
<p>We can also play around with different initial conditions in order to find the escape velocity from an orbit around the sun with distance one astronomical unit, 1 AU. The theoretical value for the escape velocity, is given by</p>
<div class="math notranslate nohighlight">
\[
v = \sqrt{8\pi^2}{r},
\]</div>
<p>and with <span class="math notranslate nohighlight">\(r=1\)</span> AU, this means that the escape velocity is <span class="math notranslate nohighlight">\(2\pi\sqrt{2}\)</span> AU/yr. To obtain this we required that the kinetic energy of Earth equals the potential energy given by the gravitational force.</p>
<p>Setting</p>
<div class="math notranslate nohighlight">
\[
\frac{1}{2}M_{\mathrm{Earth}}v^2=\frac{GM_{\odot}}{r},
\]</div>
<p>and with <span class="math notranslate nohighlight">\(GM_{\odot}=4\pi^2\)</span> we obtain the above relation for the velocity. Setting an initial velocity say equal to <span class="math notranslate nohighlight">\(9\)</span> in the above code, yields a planet (Earth) which escapes a stable orbit around the sun, as seen by running the code here.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, a, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># Initial conditions as compact 2-dimensional arrays</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span>
<span class="c1"># setting initial velocity larger than escape velocity</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">9.0</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">Fourpi2</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up forces, air resistance FD, note now that we need the norm of the vecto</span>
    <span class="c1"># Here you could have defined your own function for this</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="n">Fourpi2</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
<span class="c1"># Plot position as function of time    </span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x[AU]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y[AU]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;EscapeEarthSunVV&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_316_0.png" src="_images/chapter6_316_0.png" />
</div>
</div>
</div>
<div class="section" id="testing-energy-conservation">
<h3><span class="section-number">2.9.2. </span>Testing Energy conservation<a class="headerlink" href="#testing-energy-conservation" title="Permalink to this headline">¶</a></h3>
<p>The code here implements Euler’s method for the Earth-Sun system using
a more compact way of representing the vectors. Alternatively, you
could have spelled out all the variables <span class="math notranslate nohighlight">\(v_x\)</span>, <span class="math notranslate nohighlight">\(v_y\)</span>, <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> as
one-dimensional arrays.  It tests conservation of potential and
kinetic energy as functions of time, in addition to the total energy,
again as function of time</p>
<p><strong>Note</strong>: in all codes we have used scaled equations so that the gravitational constant times the mass of the sum is given by <span class="math notranslate nohighlight">\(4\pi^2\)</span> and the mass of the earth is set to <strong>one</strong> in the calculations of kinetic and potential energies. Else, we would get very large results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Where to save the figures and data files</span>
<span class="n">PROJECT_ROOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
<span class="n">FIGURE_ID</span> <span class="o">=</span> <span class="s2">&quot;Results/FigureFiles&quot;</span>
<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s2">&quot;DataFiles/&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">,</span> <span class="n">fig_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_path</span><span class="p">(</span><span class="n">dat_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">,</span> <span class="n">dat_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>

<span class="c1"># Initial values, time step, positions and velocites</span>

<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.0001</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># in years</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, a, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># setting up the kinetic, potential and total energy, note only functions of time</span>
<span class="n">EKinetic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">EPotential</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">ETotal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># Initial conditions as compact 2-dimensional arrays</span>


<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">Fourpi2</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span>
<span class="c1"># Setting up variables for the calculation of energies</span>
<span class="c1">#  distance that defines rabs in potential energy</span>
<span class="n">rabs0</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="c1">#  Initial kinetic energy. Note that we skip the mass of the Earth here, that is MassEarth=1 in all codes</span>
<span class="n">EKinetic</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">v0</span><span class="o">*</span><span class="n">v0</span><span class="p">)</span>
<span class="c1">#  Initial potential energy  (note negative sign, why?)</span>
<span class="n">EPotential</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="n">rabs0</span>
<span class="c1">#  Initial total energy </span>
<span class="n">ETotal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">EPotential</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">EKinetic</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># Start integrating using Euler&#39;s method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up the acceleration</span>
    <span class="c1"># Here you could have defined your own function for this</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="n">Fourpi2</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update Energies, velocity, time and position using Euler&#39;s forward method</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">a</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
    <span class="n">EKinetic</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">EPotential</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">ETotal</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">EPotential</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">EKinetic</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># Plot energies as functions of time    </span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">EKinetic</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tfinal</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Kinetic energy&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">EPotential</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Potential Energy&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ETotal</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [yr]&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Total Energy&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;EarthSunEuler&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_318_0.png" src="_images/chapter6_318_0.png" />
</div>
</div>
<p>We see very clearly that Euler’s method does not conserve energy!! Try to reduce the time step <span class="math notranslate nohighlight">\(\Delta t\)</span>. What do you see?</p>
<p>With the Euler-Cromer method, the only thing we need is to update the
position at a time <span class="math notranslate nohighlight">\(t+1\)</span> with the update velocity from the same
time. Thus, the change in the code is extremely simply, and <strong>energy is
suddenly conserved</strong>. Note that the error runs like <span class="math notranslate nohighlight">\(O(\Delta t)\)</span> and
this is why we see the larger oscillations. But within this
oscillating energy envelope, we see that the energies swing between a
max and a min value and never exceed these values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Where to save the figures and data files</span>
<span class="n">PROJECT_ROOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
<span class="n">FIGURE_ID</span> <span class="o">=</span> <span class="s2">&quot;Results/FigureFiles&quot;</span>
<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s2">&quot;DataFiles/&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">,</span> <span class="n">fig_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_path</span><span class="p">(</span><span class="n">dat_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">,</span> <span class="n">dat_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>

<span class="c1"># Initial values, time step, positions and velocites</span>

<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.0001</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># in years</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, a, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>

<span class="c1"># setting up the kinetic, potential and total energy, note only functions of time</span>
<span class="n">EKinetic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">EPotential</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">ETotal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># Initial conditions as compact 2-dimensional arrays</span>


<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">Fourpi2</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span>
<span class="c1"># Setting up variables for the calculation of energies</span>
<span class="c1">#  distance that defines rabs in potential energy</span>
<span class="n">rabs0</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="c1">#  Initial kinetic energy. Note that we skip the mass of the Earth here, that is MassEarth=1 in all codes</span>
<span class="n">EKinetic</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">v0</span><span class="o">*</span><span class="n">v0</span><span class="p">)</span>
<span class="c1">#  Initial potential energy </span>
<span class="n">EPotential</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="n">rabs0</span>
<span class="c1">#  Initial total energy </span>
<span class="n">ETotal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">EPotential</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">EKinetic</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># Start integrating using Euler&#39;s method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up the acceleration</span>
    <span class="c1"># Here you could have defined your own function for this</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="n">Fourpi2</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position using Euler&#39;s forward method</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">a</span>
<span class="c1">#   Only change when we add the Euler-Cromer method    </span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
    <span class="n">EKinetic</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">EPotential</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">ETotal</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">EPotential</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">EKinetic</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># Plot energies as functions of time    </span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">EKinetic</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tfinal</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Kinetic energy&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">EPotential</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Potential Energy&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ETotal</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [yr]&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Total Energy&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;EarthSunEulerCromer&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_320_0.png" src="_images/chapter6_320_0.png" />
</div>
</div>
</div>
<div class="section" id="adding-the-velocity-verlet-method">
<h3><span class="section-number">2.9.3. </span>Adding the  velocity Verlet method<a class="headerlink" href="#adding-the-velocity-verlet-method" title="Permalink to this headline">¶</a></h3>
<p>Our final equations for the position and the velocity become then</p>
<div class="math notranslate nohighlight">
\[
x_{i+1} = x_i+(\Delta t)v_i+\frac{(\Delta t)^2}{2}a_{i}+O((\Delta t)^3),
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
v_{i+1} = v_i+\frac{(\Delta t)}{2}\left(a_{i+1}+a_{i}\right)+O((\Delta t)^3).
\]</div>
<p>Note well that the term <span class="math notranslate nohighlight">\(a_{i+1}\)</span> depends on the position at <span class="math notranslate nohighlight">\(x_{i+1}\)</span>. This means that you need to calculate
the position at the updated time <span class="math notranslate nohighlight">\(t_{i+1}\)</span> before the computing the next velocity.  Note also that the derivative of the velocity at the time
<span class="math notranslate nohighlight">\(t_i\)</span> used in the updating of the position can be reused in the calculation of the velocity update as well.</p>
<p>We can now easily add the Verlet method to our original code as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, a, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># Initial conditions as compact 2-dimensional arrays</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">Fourpi2</span> <span class="o">=</span> <span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span>

<span class="c1"># setting up the kinetic, potential and total energy, note only functions of time</span>
<span class="n">EKinetic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">EPotential</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">ETotal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

<span class="c1"># Setting up variables for the calculation of energies</span>
<span class="c1">#  distance that defines rabs in potential energy</span>
<span class="n">rabs0</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="c1">#  Initial kinetic energy. Note that we skip the mass of the Earth here, that is MassEarth=1 in all codes</span>
<span class="n">EKinetic</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">v0</span><span class="o">*</span><span class="n">v0</span><span class="p">)</span>
<span class="c1">#  Initial potential energy </span>
<span class="n">EPotential</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="n">rabs0</span>
<span class="c1">#  Initial total energy </span>
<span class="n">ETotal</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">EPotential</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">EKinetic</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up forces, air resistance FD, note now that we need the norm of the vecto</span>
    <span class="c1"># Here you could have defined your own function for this</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="n">Fourpi2</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">rabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="p">(</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">rabs</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
    <span class="n">EKinetic</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">EPotential</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
    <span class="n">ETotal</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">EPotential</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">EKinetic</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
<span class="c1"># Plot energies as functions of time    </span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">EKinetic</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tfinal</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Kinetic energy&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">EPotential</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Potential Energy&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ETotal</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time [yr]&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Total Energy&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;EarthSunVelocityVerlet&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_326_0.png" src="_images/chapter6_326_0.png" />
</div>
</div>
<p>And we see that due to the smaller truncation error that energy conservation is improved as a function of time.
Try out different time steps <span class="math notranslate nohighlight">\(\Delta t\)</span> and see if the results improve or worsen.</p>
</div>
<div class="section" id="exercise-center-of-mass-and-relative-coordinates-and-reference-frames">
<h3><span class="section-number">2.9.4. </span>Exercise: Center-of-Mass and Relative Coordinates and Reference Frames<a class="headerlink" href="#exercise-center-of-mass-and-relative-coordinates-and-reference-frames" title="Permalink to this headline">¶</a></h3>
<p>We define the two-body center-of-mass coordinate and relative coordinate by expressing the trajectories for
<span class="math notranslate nohighlight">\(\boldsymbol{r}_1\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{r}_2\)</span> into the center-of-mass coordinate
<span class="math notranslate nohighlight">\(\boldsymbol{R}_{\rm cm}\)</span></p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{R}_{\rm cm}\equiv\frac{m_1\boldsymbol{r}_1+m_2\boldsymbol{r}_2}{m_1+m_2},
\]</div>
<p>and the relative coordinate</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{r}\equiv\boldsymbol{r}_1-\boldsymbol{r_2}.
\]</div>
<p>Here, we assume the two particles interact only with one another, so <span class="math notranslate nohighlight">\(\boldsymbol{F}_{12}=-\boldsymbol{F}_{21}\)</span> (where <span class="math notranslate nohighlight">\(\boldsymbol{F}_{ij}\)</span> is the force on <span class="math notranslate nohighlight">\(i\)</span> due to <span class="math notranslate nohighlight">\(j\)</span>.</p>
<ul class="simple">
<li><p>2a (5pt) Show that the equations of motion then become <span class="math notranslate nohighlight">\(\ddot{\boldsymbol{R}}_{\rm cm}=0\)</span> and <span class="math notranslate nohighlight">\(\mu\ddot{\boldsymbol{r}}=\boldsymbol{F}_{12}\)</span>, with the reduced mass <span class="math notranslate nohighlight">\(\mu=m_1m_2/(m_1+m_2)\)</span>.</p></li>
</ul>
<p>The first expression simply states that the center of mass coordinate <span class="math notranslate nohighlight">\(\boldsymbol{R}_{\rm cm}\)</span> moves at a fixed velocity. The second expression can be rewritten in terms of the reduced mass <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
<p>Let us first start with some basic definitions. We have the center of mass coordinate <span class="math notranslate nohighlight">\(\boldsymbol{R}\)</span> defined as (for two particles)</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{R}=\frac{m_1\boldsymbol{r}_1+m_2\boldsymbol{r}_2}{M},
\]</div>
<p>where <span class="math notranslate nohighlight">\(m_1\)</span> and <span class="math notranslate nohighlight">\(m_2\)</span> are the masses of the two objects and <span class="math notranslate nohighlight">\(\boldsymbol{r}_1\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{r}_2\)</span> their respective positions defined according to a chosen origin. Here <span class="math notranslate nohighlight">\(M=m_1+m_2\)</span> is the total mass.</p>
<p>The relative position is defined as</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{r} =\boldsymbol{r}_1-\boldsymbol{r}_2,
\]</div>
<p>and we then define <span class="math notranslate nohighlight">\(\boldsymbol{r}_1\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{r}_2\)</span> in terms of the relative and center of mass positions as</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{r}_1=\boldsymbol{R}+\frac{m_2}{M}\boldsymbol{r},
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{r}_2=\boldsymbol{R}-\frac{m_1}{M}\boldsymbol{r},
\]</div>
<p>The total linear momentum is then defined as</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{P}=\sum_{i=1}^Nm_i\frac{\boldsymbol{r}_i}{dt},
\]</div>
<p>where <span class="math notranslate nohighlight">\(N=2\)</span> in our case. With the above definition of the center of mass position, we see that we can rewrite the total linear momentum as (multiplying the center of mass position with <span class="math notranslate nohighlight">\(M\)</span>)</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{P}=M\frac{d\boldsymbol{R}}{dt}=M\dot{\boldsymbol{R}}.
\]</div>
<p>This result is also an answer to a part of exercise 2b, see below.</p>
<p>The net force acting on the system is given by the time derivative of the linear momentum (assuming mass is time independent)
and we have</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F}^{\mathrm{net}}=\dot{\boldsymbol{P}}=M\ddot{\boldsymbol{R}}.
\]</div>
<p>The net force acting on the system is given by the sum of the forces acting on the two object, that is we have</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F}^{\mathrm{net}}=\boldsymbol{F}_1+\boldsymbol{F}_2=\dot{\boldsymbol{P}}=M\ddot{\boldsymbol{R}}.
\]</div>
<p>In our case the forces are given by the internal forces only. The force acting on object <span class="math notranslate nohighlight">\(1\)</span> is thus <span class="math notranslate nohighlight">\(\boldsymbol{F}_{12}\)</span> and the one acting on object <span class="math notranslate nohighlight">\(2\)</span> is <span class="math notranslate nohighlight">\(\boldsymbol{F}_{12}\)</span>. We have also defined that <span class="math notranslate nohighlight">\(\boldsymbol{F}_{12}=-\boldsymbol{F}_{21}\)</span>. This means thar we have</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F}_1+\boldsymbol{F}_2=\boldsymbol{F}_{12}+\boldsymbol{F}_{21}=0=\dot{\boldsymbol{P}}=M\ddot{\boldsymbol{R}},
\]</div>
<p>which is what we wanted to show. The center of mass velocity is thus a constant of the motion. We could also define the so-called center of mass reference frame where we simply set <span class="math notranslate nohighlight">\(\boldsymbol{R}=0\)</span>.</p>
<p>This has also another important consequence for our forces. If we assume that our force depends only on the positions, it means that the gradient of the potential with respect to the center of mass position is zero, that is</p>
<div class="math notranslate nohighlight">
\[
M\ddot{d\boldsymbol{R}}=-\boldsymbol{\nabla}_{\boldsymbol{R}}V =0!
\]</div>
<p>An alternative way is</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\ddot{\boldsymbol{R}}_{\rm cm}&amp;=&amp;\frac{1}{m_1+m_2}\left\{m_1\ddot{\boldsymbol{r}}_1+m_2\ddot{\boldsymbol{r}}_2\right\}\\
\nonumber
&amp;=&amp;\frac{1}{m_1+m_2}\left\{\boldsymbol{F}_{12}+\boldsymbol{F}_{21}\right\}=0.\\
\ddot{\boldsymbol{r}}&amp;=&amp;\ddot{\boldsymbol{r}}_1-\ddot{\boldsymbol{r}}_2=\left(\frac{\boldsymbol{F}_{12}}{m_1}-\frac{\boldsymbol{F}_{21}}{m_2}\right)\\
\nonumber
&amp;=&amp;\left(\frac{1}{m_1}+\frac{1}{m_2}\right)\boldsymbol{F}_{12}.
\end{eqnarray}
\end{split}\]</div>
<p>The first expression simply states that the center of mass coordinate
<span class="math notranslate nohighlight">\(\boldsymbol{R}_{\rm cm}\)</span> moves at a fixed velocity. The second expression
can be rewritten in terms of the reduced mass <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\mu \ddot{\boldsymbol{r}}&amp;=&amp;\boldsymbol{F}_{12},\\
\frac{1}{\mu}&amp;=&amp;\frac{1}{m_1}+\frac{1}{m_2},~~~~\mu=\frac{m_1m_2}{m_1+m_2}.
\end{eqnarray}
\end{split}\]</div>
<p>Thus, one can treat the trajectory as a one-body problem where the
reduced mass is <span class="math notranslate nohighlight">\(\mu\)</span>, and a second trivial problem for the center of
mass. The reduced mass is especially convenient when one is
considering gravitational problems, as we have seen during the lectures of weeks 11-13.</p>
<ul class="simple">
<li><p>2b (5pt) Show that the linear momenta for the center-of-mass <span class="math notranslate nohighlight">\(\boldsymbol{P}\)</span> motion and the relative motion <span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span> are given by <span class="math notranslate nohighlight">\(\boldsymbol{P}=M\dot{\boldsymbol{R}}_{\rm cm}\)</span> with <span class="math notranslate nohighlight">\(M=m_1+m_2\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{q}=\mu\dot{\boldsymbol{r}}\)</span>.  The linear momentum of the relative motion is defined <span class="math notranslate nohighlight">\(\boldsymbol{q} = (m_2\boldsymbol{p}_1-m_1\boldsymbol{p}_2)/(m_1+m_2)\)</span>.</p></li>
</ul>
<p>In 2a we showed, as an intermediate step that the total linear momentum is given by</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{P}=\sum_{i=1}^Nm_i\frac{d\boldsymbol{r}_i}{dt}=M\dot{\boldsymbol{R}}.
\]</div>
<p>For the relative momentum <span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span>, we have that the time derivative of <span class="math notranslate nohighlight">\(\boldsymbol{r}\)</span> is</p>
<div class="math notranslate nohighlight">
\[
\dot{\boldsymbol{r}} =\dot{\boldsymbol{r}}_1-\dot{\boldsymbol{r}}_2,
\]</div>
<p>We now also that the momenta <span class="math notranslate nohighlight">\(\boldsymbol{p}_1=m_1\dot{\boldsymbol{r}}_1\)</span> and
<span class="math notranslate nohighlight">\(\boldsymbol{p}_2=m_2\dot{\boldsymbol{r}}_2\)</span>. Using these expressions we can rewrite</p>
<div class="math notranslate nohighlight">
\[
\dot{\boldsymbol{r}} =\frac{\boldsymbol{p}_1}{m_1}-\frac{\boldsymbol{p}_2}{m_2},
\]</div>
<p>which we can rewrite as</p>
<div class="math notranslate nohighlight">
\[
\dot{\boldsymbol{r}} =\frac{m_2\boldsymbol{p}_1-m_1\boldsymbol{p}_2}{m_1m_2},
\]</div>
<p>and dividing both sides with <span class="math notranslate nohighlight">\(M\)</span> we have</p>
<div class="math notranslate nohighlight">
\[
\frac{m_1m_2}{M}\dot{\boldsymbol{r}} =\frac{m_2\boldsymbol{p}_1-m_1\boldsymbol{p}_2}{M}.
\]</div>
<p>Introducing the reduced mass <span class="math notranslate nohighlight">\(\mu=m_1m_2/M\)</span> we have finally</p>
<div class="math notranslate nohighlight">
\[
\mu\dot{\boldsymbol{r}} =\frac{m_2\boldsymbol{p}_1-m_1\boldsymbol{p}_2}{M}.
\]</div>
<p>And <span class="math notranslate nohighlight">\(\mu\dot{\boldsymbol{r}}\)</span> defines the relative momentum <span class="math notranslate nohighlight">\(\boldsymbol{q}=\mu\dot{\boldsymbol{r}}\)</span>.</p>
<p>When we introduce the Lagrangian formalism we will see that it is much easier to derive these equations.</p>
<ul class="simple">
<li><p>2c (5pt) Show then that the  kinetic energy for two objects can then be written as</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
K=\frac{P^2}{2M}+\frac{q^2}{2\mu}.
\]</div>
<p>Here we just need to use our definitions of kinetic energy in terms of the coordinates <span class="math notranslate nohighlight">\(\boldsymbol{r}_1\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{r}_2\)</span>.</p>
<p>We have that</p>
<div class="math notranslate nohighlight">
\[
K=\frac{p_1^2}{2m_1}+\frac{p_2^2}{2m_2},
\]</div>
<p>and with <span class="math notranslate nohighlight">\(\boldsymbol{p}_1=m_1\dot{\boldsymbol{r}}_1\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{p}_2=m_2\dot{\boldsymbol{r}}_2\)</span> and using</p>
<div class="math notranslate nohighlight">
\[
\dot{\boldsymbol{r}}_1=\dot{\boldsymbol{R}}+\frac{m_2}{M}\dot{\boldsymbol{r}},
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\dot{\boldsymbol{r}}_2=\dot{\boldsymbol{R}}-\frac{m_1}{M}\dot{\boldsymbol{r}},
\]</div>
<p>we obtain (after squaring the expressions for <span class="math notranslate nohighlight">\(\dot{\boldsymbol{r}}_1\)</span> and <span class="math notranslate nohighlight">\(\dot{\boldsymbol{r}}_2\)</span>) we have</p>
<div class="math notranslate nohighlight">
\[
K=\frac{(m_1+m_2)\dot{\boldsymbol{R}}^2}{2}+\frac{(m_1+m_2)m_1m_2\dot{\boldsymbol{r}}^2}{2M^2},
\]</div>
<p>which we simplify to</p>
<div class="math notranslate nohighlight">
\[
K=\frac{\dot{\boldsymbol{P}}^2}{2M}+\frac{\mu\dot{\boldsymbol{q}}^2}{2},
\]</div>
<p>which is what we wanted to show.</p>
<ul class="simple">
<li><p>2d (5pt) Show that the total angular momentum for two-particles in the center-of-mass frame <span class="math notranslate nohighlight">\(\boldsymbol{R}=0\)</span>, is given by</p></li>
</ul>
<div class="math notranslate nohighlight">
\[
\boldsymbol{L}=\boldsymbol{r}\times \mu\dot{\boldsymbol{r}}.
\]</div>
<p>Here we need again that</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{r} =\boldsymbol{r}_1-\boldsymbol{r}_2,
\]</div>
<p>and we then define <span class="math notranslate nohighlight">\(\boldsymbol{r}_1\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{r}_2\)</span> in terms of the relative and center of mass positions with <span class="math notranslate nohighlight">\(\boldsymbol{R}=0\)</span></p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{r}_1=\frac{m_2}{M}\boldsymbol{r},
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{r}_2=-\frac{m_1}{M}\boldsymbol{r},
\]</div>
<p>The angular momentum (the total one) is the sum of the individual angular momenta (see homework 4) and we have</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{L} = \boldsymbol{r}_1 \times \boldsymbol{p}_1+\boldsymbol{r}_2 \times \boldsymbol{p}_2,
\]</div>
<p>and using that <span class="math notranslate nohighlight">\(m_1\dot{\boldsymbol{r}}_1=\boldsymbol{p}_1\)</span> and <span class="math notranslate nohighlight">\(m_2\dot{\boldsymbol{r}}_2=\boldsymbol{p}_2\)</span> we have</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{L} = m_1\boldsymbol{r}_1 \times \dot{\boldsymbol{r}}_1+m_2\boldsymbol{r}_2 \times \dot{\boldsymbol{r}}_2.
\]</div>
<p>Inserting the equations for <span class="math notranslate nohighlight">\(\boldsymbol{r}_1\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{r}_2\)</span> in terms of the relative motion, we have</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{L} = m_1 \frac{m_2}{M}\boldsymbol{r}\times\frac{m_2}{M}\boldsymbol{r} +m_2 \frac{m_1}{M}\boldsymbol{r} \times \frac{m_1}{M}\dot{\boldsymbol{r}}.
\]</div>
<p>We see that can rewrite this equation as</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{L}=\boldsymbol{r}\times \mu\dot{\boldsymbol{r}},
\]</div>
<p>which is what we wanted to derive.</p>
</div>
<div class="section" id="exercise-conservation-of-energy">
<h3><span class="section-number">2.9.5. </span>Exercise: Conservation of Energy<a class="headerlink" href="#exercise-conservation-of-energy" title="Permalink to this headline">¶</a></h3>
<p>The equations of motion in the center-of-mass frame in two dimensions with <span class="math notranslate nohighlight">\(x=r\cos{(\phi)}\)</span> and <span class="math notranslate nohighlight">\(y=r\sin{(\phi)}\)</span> and
<span class="math notranslate nohighlight">\(r\in [0,\infty)\)</span>, <span class="math notranslate nohighlight">\(\phi\in [0,2\pi]\)</span> and <span class="math notranslate nohighlight">\(r=\sqrt{x^2+y^2}\)</span> are given by</p>
<div class="math notranslate nohighlight">
\[
\mu \ddot{r}=-\frac{dV(r)}{dr}+\mu r\dot{\phi}^2,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\dot{\phi}=\frac{L}{\mu r^2}.
\]</div>
<p>Here <span class="math notranslate nohighlight">\(V(r)\)</span> is any central force which depends only on the relative coordinate.</p>
<ul class="simple">
<li><p>1a (5pt) Show that you can rewrite the radial equation in terms of an effective potential <span class="math notranslate nohighlight">\(V_{\mathrm{eff}}(r)=V(r)+L^2/(2\mu r^2)\)</span>.</p></li>
</ul>
<p>Here we use that</p>
<div class="math notranslate nohighlight">
\[
\dot{\phi}=\frac{L}{\mu r^2}.
\]</div>
<p>and rewrite the above equation of motion as</p>
<div class="math notranslate nohighlight">
\[
\mu \ddot{r}=-\frac{dV(r)}{dr}+\frac{L^2}{\mu r^3}.
\]</div>
<p>If we now define an effective potential</p>
<div class="math notranslate nohighlight">
\[
V_{\mathrm{eff}}=V(r)+\frac{L^2}{2\mu r^2},
\]</div>
<p>we can rewrite our equation of motion in terms of</p>
<div class="math notranslate nohighlight">
\[
\mu \ddot{r}=-\frac{dV_{\mathrm{eff}}(r)}{dr}=-\frac{dV(r)}{dr}+\frac{L^2}{\mu r^3}.
\]</div>
<p>The addition due to the angular momentum comes from the kinetic energy
when we rewrote it in terms of polar coordinates. It introduces a
so-called centrifugal barrier due to the angular momentum. This
centrifugal barrier pushes the object farther away from the origin.</p>
<p>Alternatively,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto22"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
-\frac{dV_{\text{eff}}(r)}{dr} = \mu \ddot{r}  =-\frac{dV(r)}{dr}+\mu\dot{\phi}^2r
\label{_auto22} \tag{35}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto23"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
-\frac{dV_{\text{eff}}(r)}{dr}  = -\frac{dV(r)}{dr}+\mu\left( \frac{L}{\mu r^2}\right) ^2r
\label{_auto23} \tag{36}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto24"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
 = -\frac{dV(r)}{dr}+\mu\frac{L^2}{\mu}r^{-3}
\label{_auto24} \tag{37}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto25"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
 = -\frac{d\left(  V(r)+\frac{1}{2} \frac{L^2}{\mu r^2}\right) }{dr}.
\label{_auto25} \tag{38}
\end{equation}
\]</div>
<p>Integrating we obtain</p>
<!-- Equation labels as ordinary links -->
<div id="_auto26"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
V_{\text{eff}}(r) = V(r) + \frac{L^2}{2\mu r^2} + C
\label{_auto26} \tag{39}
\end{equation}
\]</div>
<p>Imposing  the extra condition that <span class="math notranslate nohighlight">\(V_{\text{eff}}(r\rightarrow \infty) = V(r\rightarrow \infty)\)</span>,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto27"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
V_{\text{eff}}(r) = V(r) + \frac{L^2}{2\mu r^2}
\label{_auto27} \tag{40}
\end{equation}
\]</div>
<p>Write out the final differential equation for the radial degrees of freedom when we specify that <span class="math notranslate nohighlight">\(V(r)=-\alpha/r\)</span>.  Plot the effective potential. You can choose values for <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(L\)</span> and discuss (see Taylor section 8.4 and example 8.2) the physics of the system for two energies, one larger than zero and one smaller than zero. This is similar to what you did in the first midterm, except that the potential is different.</p>
<p>We insert now the explicit potential form <span class="math notranslate nohighlight">\(V(r)=-\alpha/r\)</span>. This gives us the following equation of motion</p>
<div class="math notranslate nohighlight">
\[
\mu \ddot{r}=-\frac{dV_{\mathrm{eff}}(r)}{dr}=-\frac{d(-\alpha/r)}{dr}+\frac{L^2}{\mu r^3}=-\frac{\alpha}{r^2}+\frac{L^2}{\mu r^3}.
\]</div>
<p>The following code plots this effective potential for a simple choice of parameters, with a standard gravitational potential <span class="math notranslate nohighlight">\(-\alpha/r\)</span>. Here we have chosen <span class="math notranslate nohighlight">\(L=m=\alpha=1\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">Deltax</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays</span>
<span class="n">xinitial</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">xfinal</span> <span class="o">=</span> <span class="mf">5.0</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># spring constant</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># mass, you can change these</span>
<span class="n">AngMom</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#  The angular momentum</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">((</span><span class="n">xfinal</span><span class="o">-</span><span class="n">xinitial</span><span class="p">)</span><span class="o">/</span><span class="n">Deltax</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xinitial</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">Deltax</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="n">x</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Plot potential</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;r[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;V[J]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_419_0.png" src="_images/chapter6_419_0.png" />
</div>
</div>
<p>If we select a potential energy below zero (and not necessarily one
which corresponds to the minimum point), the object will oscillate
between two values of <span class="math notranslate nohighlight">\(r\)</span>, a value <span class="math notranslate nohighlight">\(r_{\mathrm{min}}\)</span> and a value
<span class="math notranslate nohighlight">\(r_{\mathrm{max}}\)</span>. We can assume that for example the kinetic energy
is zero at these two points. The object will thus oscillate back and
forth between these two points. As we will see in connection with the
solution of the equations of motion, this case corresponds to
elliptical orbits. If we select <span class="math notranslate nohighlight">\(r\)</span> equal to the minimum of the
potential and use initial conditions for the velocity that correspond
to circular motion, the object will have a constant value of <span class="math notranslate nohighlight">\(r\)</span> given
by the value at the minimum and the orbit is a circle.</p>
<p>If we select a potential energy larger than zero, then, since the
kinetic energy is always larger or equal to zero, the object will move
away from the origin. See also the discussion in Taylor, sections 8.4-8.6.</p>
</div>
<div class="section" id="exercise-harmonic-oscillator-again">
<h3><span class="section-number">2.9.6. </span>Exercise: Harmonic oscillator again<a class="headerlink" href="#exercise-harmonic-oscillator-again" title="Permalink to this headline">¶</a></h3>
<p>Consider a particle of mass <span class="math notranslate nohighlight">\(m\)</span> in a <span class="math notranslate nohighlight">\(2\)</span>-dimensional harmonic oscillator with potential</p>
<div class="math notranslate nohighlight">
\[
V(r)=\frac{1}{2}kr^2=\frac{1}{2}k(x^2+y^2).
\]</div>
<p>We assume the orbit has a final non-zero angular momentum <span class="math notranslate nohighlight">\(L\)</span>.  The
effective potential looks like that of a harmonic oscillator for large
<span class="math notranslate nohighlight">\(r\)</span>, but for small <span class="math notranslate nohighlight">\(r\)</span>, the centrifugal potential repels the particle
from the origin. The combination of the two potentials has a minimum
for at some radius <span class="math notranslate nohighlight">\(r_{\rm min}\)</span>.</p>
<p>Set up the effective potential and plot it. Find <span class="math notranslate nohighlight">\(r_{\rm min}\)</span> and <span class="math notranslate nohighlight">\(\dot{\phi}\)</span>. Show that the latter is given by <span class="math notranslate nohighlight">\(\dot{\phi}=\sqrt{k/m}\)</span>.  At <span class="math notranslate nohighlight">\(r_{\rm min}\)</span> the particle does not accelerate and <span class="math notranslate nohighlight">\(r\)</span> stays constant and the motion is circular. With fixed <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(m\)</span>, which parameter can we adjust to change the value of <span class="math notranslate nohighlight">\(r\)</span> at <span class="math notranslate nohighlight">\(r_{\rm min}\)</span>?</p>
<p>We consider the effective potential. The radius of a circular orbit is at the minimum of the potential (where the effective force is zero).
The potential is plotted here with the parameters <span class="math notranslate nohighlight">\(k=m=1.0\)</span> and <span class="math notranslate nohighlight">\(L=1.0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">Deltax</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays</span>
<span class="n">xinitial</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">xfinal</span> <span class="o">=</span> <span class="mf">3.0</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># spring constant</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># mass, you can change these</span>
<span class="n">AngMom</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#  The angular momentum</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">((</span><span class="n">xfinal</span><span class="o">-</span><span class="n">xinitial</span><span class="p">)</span><span class="o">/</span><span class="n">Deltax</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">xinitial</span><span class="o">+</span><span class="n">i</span><span class="o">*</span><span class="n">Deltax</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">x</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Plot potential</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;r[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;V[J]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_423_0.png" src="_images/chapter6_423_0.png" />
</div>
</div>
<p>We have an effective potential</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray*}
V_{\rm eff}&amp;=&amp;\frac{1}{2}kr^2+\frac{L^2}{2mr^2}
\end{eqnarray*}
\]</div>
<p>The effective potential looks like that of a harmonic oscillator for
large <span class="math notranslate nohighlight">\(r\)</span>, but for small <span class="math notranslate nohighlight">\(r\)</span>, the centrifugal potential repels the
particle from the origin. The combination of the two potentials has a
minimum for at some radius <span class="math notranslate nohighlight">\(r_{\rm min}\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
0&amp;=&amp;kr_{\rm min}-\frac{L^2}{mr_{\rm min}^3},\\
r_{\rm min}&amp;=&amp;\left(\frac{L^2}{mk}\right)^{1/4},\\
\dot{\theta}&amp;=&amp;\frac{L}{mr_{\rm min}^2}=\sqrt{k/m}.
\end{eqnarray*}
\end{split}\]</div>
<p>For particles at <span class="math notranslate nohighlight">\(r_{\rm min}\)</span> with <span class="math notranslate nohighlight">\(\dot{r}=0\)</span>, the particle does not
accelerate and <span class="math notranslate nohighlight">\(r\)</span> stays constant, i.e. a circular orbit. The radius
of the circular orbit can be adjusted by changing the angular momentum
<span class="math notranslate nohighlight">\(L\)</span>.</p>
<p>For the above parameters this minimum is at <span class="math notranslate nohighlight">\(r_{\rm min}=1\)</span>.</p>
<p>Now consider small vibrations about <span class="math notranslate nohighlight">\(r_{\rm min}\)</span>. The effective spring constant is the curvature of the effective potential.  Use the curvature at <span class="math notranslate nohighlight">\(r_{\rm min}\)</span> to find the effective spring constant (hint, look at  exercise 4 in homework 6) <span class="math notranslate nohighlight">\(k_{\mathrm{eff}}\)</span>. Show also that <span class="math notranslate nohighlight">\(\omega=\sqrt{k_{\mathrm{eff}}/m}=2\dot{\phi}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
k_{\rm eff}&amp;=&amp;\left.\frac{d^2}{dr^2}V_{\rm eff}(r)\right|_{r=r_{\rm min}}=k+\frac{3L^2}{mr_{\rm min}^4}\\
&amp;=&amp;4k,\\
\omega&amp;=&amp;\sqrt{k_{\rm eff}/m}=2\sqrt{k/m}=2\dot{\theta}.
\end{eqnarray*}
\end{split}\]</div>
<p>Because the radius oscillates with twice the angular frequency,
the orbit has two places where <span class="math notranslate nohighlight">\(r\)</span> reaches a minimum in one
cycle. This differs from the inverse-square force where there is one
minimum in an orbit. One can show that the orbit for the harmonic
oscillator is also elliptical, but in this case the center of the
potential is at the center of the ellipse, not at one of the foci.</p>
<p>The solution to the equations of motion in Cartesian coordinates is simple. The <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> equations of motion separate, and we have <span class="math notranslate nohighlight">\(\ddot{x}=-kx/m\)</span> and <span class="math notranslate nohighlight">\(\ddot{y}=-ky/m\)</span>. The harmonic oscillator is indeed a system where the degrees of freedom separate and we can find analytical solutions. Define a natural frequency <span class="math notranslate nohighlight">\(\omega_0=\sqrt{k/m}\)</span> and show that (where <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(B\)</span>, <span class="math notranslate nohighlight">\(C\)</span> and <span class="math notranslate nohighlight">\(D\)</span> are arbitrary constants defined by the initial conditions)</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
x&amp;=&amp;A\cos\omega_0 t+B\sin\omega_0 t,\\
y&amp;=&amp;C\cos\omega_0 t+D\sin\omega_0 t.
\end{eqnarray*}
\end{split}\]</div>
<p>The solution is also simple to write down exactly in Cartesian coordinates. The <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> equations of motion separate,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
\ddot{x}&amp;=&amp;-kx,\\
\ddot{y}&amp;=&amp;-ky.
\end{eqnarray*}
\end{split}\]</div>
<p>We know from our studies of the harmonic oscillator that the general solution can be expressed as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray*}
x&amp;=&amp;A\cos\omega_0 t+B\sin\omega_0 t,\\
y&amp;=&amp;C\cos\omega_0 t+D\sin\omega_0 t.
\end{eqnarray*}
\end{split}\]</div>
<p>With the solutions for <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(r^2=x^2+y^2\)</span> and the definitions <span class="math notranslate nohighlight">\(\alpha=\frac{A^2+B^2+C^2+D^2}{2}\)</span>, <span class="math notranslate nohighlight">\(\beta=\frac{A^2-B^2+C^2-D^2}{2}\)</span> and <span class="math notranslate nohighlight">\(\gamma=AB+CD\)</span>, show that</p>
<div class="math notranslate nohighlight">
\[
r^2=\alpha+(\beta^2+\gamma^2)^{1/2}\cos(2\omega_0 t-\delta),
\]</div>
<p>with</p>
<div class="math notranslate nohighlight">
\[
\delta=\arctan(\gamma/\beta).
\]</div>
<p>We start with <span class="math notranslate nohighlight">\(r^2 &amp; = x^2+y^2\)</span> and square the above analytical solutions and   after some <strong>exciting algebraic manipulations</strong> we arrive at</p>
<!-- Equation labels as ordinary links -->
<div id="_auto28"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
r^2  = x^2+y^2
\label{_auto28} \tag{41}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto29"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}  
 = \left(  A\cos\omega_0 t+B\sin\omega_0 t\right) ^2 + \left(  C\cos\omega_0 t+D\sin\omega_0 t\right) ^2
\label{_auto29} \tag{42}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto30"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}  
 = A^2\cos^2\omega_0 t+B^2\sin^2\omega_0 t + 2AB\sin\omega_0 t \cos\omega_0 t + C^2\cos^2\omega_0 t+D^2\sin^2\omega_0 t + 2CD\sin\omega_0 t \cos\omega_0 t
\label{_auto30} \tag{43}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto31"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
 = (A^2+C^2)\cos^2\omega_0 t + (B^2+D^2)\sin^2\omega_0 t + 2(AC + BD)\sin\omega_0 t \cos\omega_0 t
\label{_auto31} \tag{44}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto32"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
 = (B^2+D^2) + (A^2+C^2-B^2-D^2)\cos^2\omega_0 t + 2(AC + BD)2\sin2\omega_0 t
\label{_auto32} \tag{45}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto33"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
 = (B^2+D^2) + (A^2+C^2-B^2-D^2)\frac{1+\cos{2\omega_0 t}}{2} + 2(AC + BD)\frac{1}{2}\sin2\omega_0 t
\label{_auto33} \tag{46}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto34"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
 = \frac{2B^2+2D^2+A^2+C^2-B^2-D^2}{2} + (A^2+C^2-B^2-D^2)\frac{\cos{2\omega_0 t}}{2} + (AC + BD)\sin2\omega_0 t
\label{_auto34} \tag{47}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto35"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
 = \frac{B^2+D^2+A^2+C^2}{2} + \frac{A^2+C^2-B^2-D^2}{2}\cos{2\omega_0 t} + (AC + BD)\sin2\omega_0 t
\label{_auto35} \tag{48}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto36"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
 = \alpha + \beta\cos{2\omega_0 t} + \gamma\sin2\omega_0 t
\label{_auto36} \tag{49}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto37"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
 = \alpha + \sqrt{\beta^2+\gamma^2}\left( \frac{\beta}{\sqrt{\beta^2+\gamma^2}}\cos{2\omega_0 t} + \frac{\gamma}{\sqrt{\beta^2+\gamma^2}}\sin2\omega_0 t\right) 
\label{_auto37} \tag{50}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto38"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
 = \alpha + \sqrt{\beta^2+\gamma^2}\left( \cos{\delta}\cos{2\omega_0 t} + \sin{\delta}\sin2\omega_0 t\right) 
\label{_auto38} \tag{51}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto39"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
 = \alpha + \sqrt{\beta^2+\gamma^2}\cos{\left( 2\omega_0 t - \delta\right) },
\label{_auto39} \tag{52}
\end{equation}
\]</div>
<p>which is what we wanted to show.</p>
</div>
<div class="section" id="exercise-numerical-solution-of-the-harmonic-oscillator">
<h3><span class="section-number">2.9.7. </span>Exercise: Numerical Solution of the Harmonic Oscillator<a class="headerlink" href="#exercise-numerical-solution-of-the-harmonic-oscillator" title="Permalink to this headline">¶</a></h3>
<p>Using the code we developed in homeworks 5 and/or 6 for the Earth-Sun system, we can solve the above harmonic oscillator problem in two dimensions using our code from this homework. We need however to change the acceleration from the gravitational force to the one given by the harmonic oscillator potential.</p>
<ul class="simple">
<li><p>3a (20pt) Use for example the  code in the exercise set to set up the acceleration and use the initial conditions fixed by for example <span class="math notranslate nohighlight">\(r_{\rm min}\)</span> from exercise 2. Which value should the initial velocity take if you place yourself at <span class="math notranslate nohighlight">\(r_{\rm min}\)</span> and you require a circular motion? Hint: see the first midterm, part 2. There you used the centripetal acceleration.</p></li>
</ul>
<p>Instead of solving the equations in the cartesian frame we will now rewrite the above code in terms of the radial degrees of freedom only. Our differential equation is now</p>
<div class="math notranslate nohighlight">
\[
\mu \ddot{r}=-\frac{dV(r)}{dr}+\mu\dot{\phi}^2,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\dot{\phi}=\frac{L}{\mu r^2}.
\]</div>
<ul class="simple">
<li><p>3b (20pt) We will use <span class="math notranslate nohighlight">\(r_{\rm min}\)</span> to fix a value of <span class="math notranslate nohighlight">\(L\)</span>, as seen in exercise 2. This fixes also <span class="math notranslate nohighlight">\(\dot{\phi}\)</span>. Write a code which now implements the radial equation for <span class="math notranslate nohighlight">\(r\)</span> using the same <span class="math notranslate nohighlight">\(r_{\rm min}\)</span> as you did in 3a. Compare the results with those from 3a with the same initial conditions. Do they agree? Use only one set of initial conditions.</p></li>
</ul>
<p>The code here finds the solution for <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> using the code we
developed in homework 5 and 6 and the midterm.  Note that this code is
tailored to run in Cartesian coordinates. There is thus no angular
momentum dependent term.</p>
<p>Here we have chosen initial conditions that
correspond to the minimum of the effective potential
<span class="math notranslate nohighlight">\(r_{\mathrm{min}}\)</span>. We have chosen <span class="math notranslate nohighlight">\(x_0=r_{\mathrm{min}}\)</span> and
<span class="math notranslate nohighlight">\(y_0=0\)</span>. Similarly, we use the centripetal acceleration to determine
the initial velocity so that we have a circular motion (see back to the
last question of the midterm). This means that we set the centripetal
acceleration <span class="math notranslate nohighlight">\(v^2/r\)</span> equal to the force from the harmonic oscillator <span class="math notranslate nohighlight">\(-k\boldsymbol{r}\)</span>. Taking the
magnitude of <span class="math notranslate nohighlight">\(\boldsymbol{r}\)</span> we have then
<span class="math notranslate nohighlight">\(v^2/r=k/mr\)</span>, which gives <span class="math notranslate nohighlight">\(v=\pm\omega_0r\)</span>.</p>
<p>Since the code here solves the equations of motion in cartesian
coordinates and the harmonic oscillator potential leads to forces in
the <span class="math notranslate nohighlight">\(x\)</span>- and <span class="math notranslate nohighlight">\(y\)</span>-directions that are decoupled, we have to select the initial velocities and positions so that we don’t get that for example <span class="math notranslate nohighlight">\(y(t)=0\)</span>.</p>
<p>We set <span class="math notranslate nohighlight">\(x_0\)</span> to be different from zero and <span class="math notranslate nohighlight">\(v_{y0}\)</span> to be different from zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Where to save the figures and data files</span>
<span class="n">PROJECT_ROOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
<span class="n">FIGURE_ID</span> <span class="o">=</span> <span class="s2">&quot;Results/FigureFiles&quot;</span>
<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s2">&quot;DataFiles/&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">,</span> <span class="n">fig_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_path</span><span class="p">(</span><span class="n">dat_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">,</span> <span class="n">dat_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>

<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Constants of the model</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># spring constant</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>   <span class="c1"># mass, you can change these</span>
<span class="n">omega02</span> <span class="o">=</span> <span class="n">k</span><span class="o">/</span><span class="n">m</span>  <span class="c1"># Frequency</span>
<span class="n">AngMom</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#  The angular momentum</span>
<span class="c1"># Potential minimum</span>
<span class="n">rmin</span> <span class="o">=</span> <span class="p">(</span><span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">k</span><span class="o">/</span><span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mf">0.25</span>
<span class="c1"># Initial conditions as compact 2-dimensional arrays, x0=rmin and y0 = 0</span>
<span class="n">x0</span> <span class="o">=</span> <span class="n">rmin</span><span class="p">;</span> <span class="n">y0</span><span class="o">=</span> <span class="mf">0.0</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x0</span><span class="p">,</span><span class="n">y0</span><span class="p">])</span>
<span class="n">vy0</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">omega02</span><span class="p">)</span><span class="o">*</span><span class="n">rmin</span><span class="p">;</span> <span class="n">vx0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">vx0</span><span class="p">,</span><span class="n">vy0</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up the acceleration</span>
    <span class="n">a</span> <span class="o">=</span>  <span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">omega02</span>  
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">omega02</span>  
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
<span class="c1"># Plot position as function of time</span>
<span class="n">radius</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;radius squared&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x position&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y position&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;2DimHOVV&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_458_0.png" src="_images/chapter6_458_0.png" />
</div>
</div>
<p>We see that the radius (to within a given error), we obtain a constant radius.</p>
<p>The following code shows first how we can solve this problem using the radial degrees of freedom only.
Here we need to add the explicit centrifugal barrier.  Note that the variable <span class="math notranslate nohighlight">\(r\)</span> depends only on time. There is no <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> directions
since we have transformed the equations to polar coordinates.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">10.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, v and r</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Constants of the model</span>
<span class="n">AngMom</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#  The angular momentum</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">omega02</span> <span class="o">=</span> <span class="n">k</span><span class="o">/</span><span class="n">m</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">m</span>
<span class="n">rmin</span> <span class="o">=</span> <span class="p">(</span><span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">k</span><span class="o">/</span><span class="n">m</span><span class="p">)</span><span class="o">**</span><span class="mf">0.25</span>
<span class="c1"># Initial conditions</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">rmin</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="n">E</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v0</span><span class="o">*</span><span class="n">v0</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">r0</span><span class="o">*</span><span class="n">r0</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="p">(</span><span class="n">r0</span><span class="o">*</span><span class="n">r0</span><span class="p">)</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up acceleration</span>
    <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">omega02</span><span class="o">+</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>    
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">omega02</span><span class="o">+</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
    <span class="n">E</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">m</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">k</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="n">c2</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="c1"># Plot position as function of time</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Energy&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">E</span><span class="p">)</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;RadialHOVV&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_460_0.png" src="_images/chapter6_460_0.png" />
</div>
</div>
</div>
<div class="section" id="exercise-equations-for-an-ellipse">
<h3><span class="section-number">2.9.8. </span>Exercise: Equations for an ellipse<a class="headerlink" href="#exercise-equations-for-an-ellipse" title="Permalink to this headline">¶</a></h3>
<p>Consider an ellipse defined by the sum of the distances from the two foci being <span class="math notranslate nohighlight">\(2D\)</span>, which expressed in a Cartesian coordinates with the middle of the ellipse being at the origin becomes</p>
<div class="math notranslate nohighlight">
\[
\sqrt{(x-a)^2+y^2}+\sqrt{(x+a)^2+y^2}=2D.
\]</div>
<p>Here the two foci are at <span class="math notranslate nohighlight">\((a,0)\)</span> and <span class="math notranslate nohighlight">\((-a,0)\)</span>. Show that this form is can be written as</p>
<div class="math notranslate nohighlight">
\[
\frac{x^2}{D^2}+\frac{y^2}{D^2-a^2}=1.
\]</div>
<p>We start by squaring the two sides and, again,  after some <strong>exciting algebraic manipulations</strong> we arrive at</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\sqrt{(x-a)^2+y^2}+\sqrt{(x+a)^2+y^2} =2D
\\ (x-a)^2 + y^2 + (x+a)^2 + y^2 + 2\sqrt{(x-a)^2 + y^2}\sqrt{(x+a)^2+y^2}  = 4D^2
\\ 2y^2 + 2x^2 + 2a^2 + 2\sqrt{(x-a)^2(x+a)^2 + y^4 + y^2[(x-a)^2+(x+a)^2]}  = 4D^2
\\ y^2 + x^2 + a^2 + \sqrt{(x^2-a^2)^2 + y^4 + y^2(2x^2+2a^2)}  = 2D^2
\\ \sqrt{(x^2-a^2)^2 + y^4 + y^2(2x^2+2a^2)}  = 2D^2 -( y^2 + x^2 + a^2 )
\\ (x^2-a^2)^2 + y^4 + y^2(2x^2+2a^2)  = 4D^4 + y^4 + x^4 + a^4 - 4D^2( y^2 + x^2 + a^2 ) + 2(y^2x^2+y^2a^2+x^2a^2)
\\ x^4-2x^2a^2+a^4 + y^4 + 2y^2x^2+2y^2a^2  = 4D^4 + y^4 + x^4 + a^4 - 4D^2y^2 -4D^2 x^2 -4D^2 a^2 + 2y^2x^2+2y^2a^2+2x^2a^2
\\ 4D^4 - 4D^2y^2 -4D^2 x^2 -4D^2 a^2 +4x^2a^2 = 0
\\ D^4 - D^2y^2 -D^2 x^2 -D^2 a^2 +x^2a^2 = 0
\\ D^2(D^2-a^2) - x^2(D^2-a^2) = D^2y^2
\\ D^2 - x^2 = \frac{D^2y^2}{D^2-a^2}
\\ 1 - \frac{x^2}{D^2} = \frac{y^2}{D^2-a^2}
\\ \frac{x^2}{D^2} + \frac{y^2}{D^2-a^2} = 1,
\end{split}\]</div>
<p>where the last line is indeed the equation for an ellipse.</p>
</div>
<div class="section" id="exercise-attractive-potential">
<h3><span class="section-number">2.9.9. </span>Exercise: Attractive Potential<a class="headerlink" href="#exercise-attractive-potential" title="Permalink to this headline">¶</a></h3>
<p>Consider a particle in an attractive potential</p>
<div class="math notranslate nohighlight">
\[
U(r)=-\alpha/r.
\]</div>
<p>The quantity <span class="math notranslate nohighlight">\(r\)</span> is the absolute value of the relative position. We
will use the reduced mass <span class="math notranslate nohighlight">\(\mu\)</span> and the angular momentum <span class="math notranslate nohighlight">\(L\)</span>, as
discussed during the lectures. With the transformation of a two-body
problem to the center-of-mass frame, the actual equations look like an
<em>effective</em> one-body problem. The energy of the system is <span class="math notranslate nohighlight">\(E\)</span> and the
minimum of the effective potential is <span class="math notranslate nohighlight">\(r_{\rm min}\)</span>.</p>
<p>The analytical solution to the radial equation of motion is</p>
<div class="math notranslate nohighlight">
\[
r(\phi) = \frac{1}{\frac{\mu\alpha}{L^2}+A\cos{(\phi)}}.
\]</div>
<p>Find the value of <span class="math notranslate nohighlight">\(A\)</span>. Hint: Use the fact that at <span class="math notranslate nohighlight">\(r_{\rm min}\)</span>
there is no radial kinetic energy and <span class="math notranslate nohighlight">\(E=-\alpha/r_{\rm min}+L^2/2mr_{\rm min}^2\)</span>.</p>
<p>At  <span class="math notranslate nohighlight">\(r_{\mathrm{min}}\)</span>  and <span class="math notranslate nohighlight">\(r_{\mathrm{max}}\)</span> , all the kinetic energy is stored in the velocity in the direction perpendicular to <span class="math notranslate nohighlight">\(r\)</span>  since the radial velocity is set to zero . We can calculate using angular momentum and from there, find  𝐴  in terms of the energy  <span class="math notranslate nohighlight">\(E\)</span>  which is constant. But first, we need to find <span class="math notranslate nohighlight">\(r_{\mathrm{min}}\)</span>  from the conservation of energy (noting that the radial velocity <span class="math notranslate nohighlight">\(\ddot{r}\)</span> at the mininum is zero):</p>
<div class="math notranslate nohighlight">
\[\begin{split}
E = U(r) + \frac{1}{2} \mu(\ddot{r}^2 + (r\ddot{\phi})^2)
\\
E = \frac{-\alpha}{r_{\min}} + \frac{1}{2} \mu\left( \frac{L}{\mu r_{\min}}\right) ^2
\\
E r_{\min}^2 - \frac{1}{2}\mu\left( \frac{L}{\mu}\right) ^2 + \alpha r_{\min} = 0
\\
r_{\min}^2 + \frac{\alpha}{E} r_{\min} - \frac{L^2}{2E\mu} = 0
\\
r_{\min} = - \frac{\alpha}{2E} \pm \frac{1}{2} \sqrt{\frac{\alpha^2}{E^2} + 2\frac{L^2}{E\mu}}
\end{split}\]</div>
<p>Since we’re looking for the minimum, the  ±  sign must be negative (then  𝑟min  will not be negative since  𝐸&lt;0 ). Therefore, we have</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\frac{1}{\frac{\mu\alpha}{L^2}+A} = -\frac{\alpha}{2E} - \frac{1}{2} \sqrt{\frac{\alpha^2}{E^2} + 2\frac{L^2}{E\mu}}
\\
A = - \frac{\mu\alpha}{L^2} - \frac{2E}{\alpha + \sqrt{\alpha^2 + 2\frac{L^2E}{\mu}}}
\end{split}\]</div>
</div>
<div class="section" id="exercise-inverse-square-force">
<h3><span class="section-number">2.9.10. </span>Exercise: Inverse-square force<a class="headerlink" href="#exercise-inverse-square-force" title="Permalink to this headline">¶</a></h3>
<p>Consider again the same effective potential as in the previous exercise. This leads to an attractive inverse-square-law force, <span class="math notranslate nohighlight">\(F=-\alpha/r^2\)</span>. Consider a particle of mass <span class="math notranslate nohighlight">\(m\)</span> with angular momentum <span class="math notranslate nohighlight">\(L\)</span>. Taylor sections 8.4-8.7 are relevant background material.  See also the harmonic oscillator potential from hw8. The equation of motion for the radial degrees of freedom is (see also hw8) in the center-of-mass frame in two dimensions with <span class="math notranslate nohighlight">\(x=r\cos{(\phi)}\)</span> and <span class="math notranslate nohighlight">\(y=r\sin{(\phi)}\)</span> and
<span class="math notranslate nohighlight">\(r\in [0,\infty)\)</span>, <span class="math notranslate nohighlight">\(\phi\in [0,2\pi]\)</span> and <span class="math notranslate nohighlight">\(r=\sqrt{x^2+y^2}\)</span> are given by</p>
<div class="math notranslate nohighlight">
\[
\ddot{r}=-\frac{1}{m}\frac{dV(r)}{dr}+r\dot{\phi}^2,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\dot{\phi}=\frac{L}{m r^2}.
\]</div>
<p>Here <span class="math notranslate nohighlight">\(V(r)\)</span> is any central force which depends only on the relative coordinate.</p>
<p>Find the radius of a circular orbit by solving for the position of the minimum of the effective potential.</p>
<!-- Equation labels as ordinary links -->
<div id="_auto40"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{1}{m}\frac{dV(r)}{dr}  = r\dot{\phi}^2
\label{_auto40} \tag{53}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto41"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}  \frac{1}{m}\left( -\frac{-\alpha}{r^2}\right)   = r \frac{L^2}{m^2r^4}
\label{_auto41} \tag{54}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto42"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}  \frac{\alpha}{mr^2}  = \frac{L^2}{m^2r^3}
\label{_auto42} \tag{55}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto43"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}  r  = \frac{L^2}{m\alpha}
\label{_auto43} \tag{56}
\end{equation}
\]</div>
<p>At the minimum, the radial velocity is zero and it is only the <a class="reference external" href="https://en.wikipedia.org/wiki/Centripetal_force">centripetal velocity</a> which is nonzero. This implies that <span class="math notranslate nohighlight">\(\ddot{r}=0\)</span>.  What is the angular frequency, <span class="math notranslate nohighlight">\(\dot{\theta}\)</span>, of the orbit? Solve this by setting <span class="math notranslate nohighlight">\(\ddot{r}=0=F/m+\dot{\theta}^2r\)</span>.</p>
<!-- Equation labels as ordinary links -->
<div id="_auto44"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\dot{\theta}^2 r  = - \frac{F}{m}
\label{_auto44} \tag{57}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto45"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}  \dot{\theta}^2 r  = - \frac{-\frac{\alpha}{r^2}}{m}
\label{_auto45} \tag{58}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto46"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}  \dot{\theta}^2  = \frac{\alpha}{mr^3}
\label{_auto46} \tag{59}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto47"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}  \dot{\theta}  = \pm \sqrt{\frac{\alpha}{mr^3}}
\label{_auto47} \tag{60}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto48"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}  \dot{\theta}  = \pm \sqrt{\frac{\alpha}{m\frac{L^6}{m^3\alpha^3}}}
\label{_auto48} \tag{61}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto49"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}  \dot{\theta}  = \pm \sqrt{\frac{\alpha^4m^2}{L^6}}
\label{_auto49} \tag{62}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto50"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}  \dot{\theta}  = \pm \frac{\alpha^2m}{L^3}
\label{_auto50} \tag{63}
\end{equation}
\]</div>
<p>Find the effective spring constant for the particle at the minimum.</p>
<p>We have shown in class that from the taylor expansion, we have</p>
<div class="math notranslate nohighlight">
\[
k = \frac{d^2V_{\text{eff}}}{dr^2}
\]</div>
<p>Therefore, all we have to do is find the second derivative of <span class="math notranslate nohighlight">\(V_{\text{eff}}\)</span> around the minimum point of <span class="math notranslate nohighlight">\(V_{\text{eff}}\)</span> where <span class="math notranslate nohighlight">\(\dot{r} = \ddot{r} = 0\)</span>.</p>
<!-- Equation labels as ordinary links -->
<div id="_auto51"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
k  = \frac{d^2V_{\text{eff}}}{dr^2}
\label{_auto51} \tag{64}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto52"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = \frac{d^2\left( -\frac{\alpha}{r} + \frac{1}{2} \frac{L^2}{mr^2}\right) }{dr^2}
\label{_auto52} \tag{65}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto53"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = -\frac{2\alpha}{r^3} + \frac{3L^2}{mr^4}
\label{_auto53} \tag{66}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto54"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = -\frac{2\alpha}{\frac{L^6}{m^3\alpha^3}} + \frac{3L^2}{m\frac{L^8}{m^4\alpha^4}}
\label{_auto54} \tag{67}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto55"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = -\frac{2m^3\alpha^4}{L^6} + \frac{3m^3\alpha^4}{L^6}
\label{_auto55} \tag{68}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto56"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = \frac{m^3\alpha^4}{L^6}
\label{_auto56} \tag{69}
\end{equation}
\]</div>
<p>What is the angular frequency for small vibrations about the minimum? How does this compare with the answer to (3b)?</p>
<p>For small deviations <span class="math notranslate nohighlight">\(\delta r\)</span> of <span class="math notranslate nohighlight">\(r\)</span>,</p>
<div class="math notranslate nohighlight">
\[
m\frac{d^2\left(  \delta r \right) }{dt^2} = -k \delta r
\]</div>
<p>The solution of this differential equation is of the form</p>
<div class="math notranslate nohighlight">
\[
\delta r = A \cos(\omega t + \phi)
\]</div>
<p>where</p>
<!-- Equation labels as ordinary links -->
<div id="_auto57"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\omega =  \sqrt{\frac{k}{m}}
\label{_auto57} \tag{70}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto58"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = \sqrt{\frac{m^2\alpha^4}{L^6}} 
\label{_auto58} \tag{71}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto59"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = \frac{m\alpha^2}{L^3}
\label{_auto59} \tag{72}
\end{equation}
\]</div>
<p>This is in fact equal to the expression for <span class="math notranslate nohighlight">\(\dot{\theta}\)</span>. This means that small perturbations oscillate in sync with the orbit and this traces out an ellipse with a very small eccentricity, a very nice physical result.</p>
</div>
<div class="section" id="exercise-inverse-square-force-again">
<h3><span class="section-number">2.9.11. </span>Exercise: Inverse-square force again<a class="headerlink" href="#exercise-inverse-square-force-again" title="Permalink to this headline">¶</a></h3>
<p>Consider again a  particle of mass <span class="math notranslate nohighlight">\(m\)</span> in the same attractive potential, <span class="math notranslate nohighlight">\(U(r)=-\alpha/r\)</span>, with angular momentum <span class="math notranslate nohighlight">\(L\)</span> with just the right energy so that</p>
<div class="math notranslate nohighlight">
\[
A=m\alpha/L^2
\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> comes from the expression</p>
<div class="math notranslate nohighlight">
\[
r=\frac{1}{(m\alpha/L^2)+A\cos{(\phi)}}.
\]</div>
<p>The trajectory can then be rewritten as</p>
<div class="math notranslate nohighlight">
\[
r=\frac{2r_0}{1+\cos\theta},~~~r_0=\frac{L^2}{2m\alpha}.
\]</div>
<p>Show that for this case the total energy <span class="math notranslate nohighlight">\(E\)</span> approaches zero.</p>
<!-- Equation labels as ordinary links -->
<div id="_auto60"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
E  = - \frac{\alpha}{r} + \frac{1}{2} m \left(  (\dot{\theta}r)^2+\dot{r}^2\right) 
\label{_auto60} \tag{73}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto61"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = - \frac{\alpha}{r} + \frac{1}{2} m \left[  \left( \frac{L}{mr^2}r\right) ^2+\left( \frac{dr}{d\theta}\dot{\theta}\right) ^2\right] 
\label{_auto61} \tag{74}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto62"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = - \frac{\alpha}{2r_0}(1+\cos\theta) + \frac{1}{2} m \left[  \left( \frac{L(1+\cos\theta)}{2mr_0}\right) ^2+\left( 2r_0\frac{-1}{(1+\cos\theta)^2}(-\sin\theta)\frac{L}{mr^2}\right) ^2\right] 
\label{_auto62} \tag{75}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto63"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = - \frac{\alpha}{2r_0}(1+\cos\theta) + \frac{1}{2} m \left[  \left( \frac{L(1+\cos\theta)}{2mr_0}\right) ^2+\left( 2r_0\frac{-1}{(1+\cos\theta)^2}(-\sin\theta)\frac{L(1+\cos\theta)^2}{4mr_0^2}\right) ^2\right] 
\label{_auto63} \tag{76}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto64"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = - \frac{\alpha}{2r_0}(1+\cos\theta) + 
\frac{1}{2} m \left[  \left( \frac{L(1+\cos\theta)}{2mr_0}\right) ^2+\left( \sin\theta\frac{L}{2mr_0}\right) ^2\right] 
\label{_auto64} \tag{77}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto65"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = - \frac{\alpha}{2r_0}(1+\cos\theta) + 
\frac{1}{2} m \left[  \left( \frac{L(1+\cos\theta)}{2mr_0}\right) ^2+\left( \sin\theta\frac{L}{2mr_0}\right) ^2\right] 
\label{_auto65} \tag{78}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto66"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = - \frac{\alpha}{2r_0}(1+\cos\theta) + 
\frac{1}{2} m \frac{L^2}{4m^2r_0^2} \left[  \left( 1+\cos\theta\right) ^2+\left( \sin\theta\right) ^2\right] 
\label{_auto66} \tag{79}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto67"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = - \frac{\alpha}{2r_0}(1+\cos\theta) + 
\frac{1}{2} \frac{L^2}{4mr_0^2} \left(  1 + \cos^2\theta + 2\cos \theta + \sin^2\theta\right) 
\label{_auto67} \tag{80}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto68"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = - \frac{\alpha}{2r_0}(1+\cos\theta) + 
\frac{1}{2} \frac{L^2}{4mr_0^2} \left(  2 + 2\cos \theta \right) 
\label{_auto68} \tag{81}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto69"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = (1+\cos\theta) \left( - \frac{\alpha}{2r_0} + \frac{L^2}{4mr_0^2}\right) 
\label{_auto69} \tag{82}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto70"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = (1+\cos\theta) \left( - \frac{\alpha}{2\frac{L^2}{2m\alpha}} + \frac{L^2}{4m\frac{L^4}{4m^2\alpha^2}}\right) 
\label{_auto70} \tag{83}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto71"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = (1+\cos\theta) \left( - \frac{m\alpha^2}{L^2} + \frac{m\alpha^2}{L^2}\right) 
\label{_auto71} \tag{84}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto72"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = 0
\label{_auto72} \tag{85}
\end{equation}
\]</div>
<p>With zero energy <span class="math notranslate nohighlight">\(E=0\)</span>, write this trajectory in a more recognizable parabolic form, that is express <span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(R\)</span> in terms of <span class="math notranslate nohighlight">\(r_0\)</span> using</p>
<div class="math notranslate nohighlight">
\[
x=x_0-\frac{y^2}{R}.
\]</div>
<p>We have that</p>
<!-- Equation labels as ordinary links -->
<div id="_auto73"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x  = r \cos\theta
\label{_auto73} \tag{86}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto74"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation} 
y  = r \sin \theta.
\label{_auto74} \tag{87}
\end{equation}
\]</div>
<p>Using the general solution with eccintricity <span class="math notranslate nohighlight">\(\epsilon=1\)</span>, we have</p>
<div class="math notranslate nohighlight">
\[
r(\theta)=\frac{c}{1+\cos\theta},
\]</div>
<p>and multiplying both sides with <span class="math notranslate nohighlight">\(1+\cos\theta\)</span> and using that <span class="math notranslate nohighlight">\(x=r\cos\theta\)</span>,</p>
<div class="math notranslate nohighlight">
\[
r = c -x,
\]</div>
<p>and using that <span class="math notranslate nohighlight">\(r^2=x^2+y^2\)</span>, we square both sides</p>
<div class="math notranslate nohighlight">
\[
r^2 = x^2+y^2=c^2 +x^2-2cx,
\]</div>
<p>leading to</p>
<div class="math notranslate nohighlight">
\[
y^2=c^2-2cx,
\]</div>
<p>and using that we defined</p>
<div class="math notranslate nohighlight">
\[
c=2r_0=\frac{L^2}{m\alpha},
\]</div>
<p>we divide by <span class="math notranslate nohighlight">\(2c\)</span>
and we get the final answer</p>
<div class="math notranslate nohighlight">
\[
x = r_0 - \frac{y^2}{4r_0}
\]</div>
</div>
<div class="section" id="exercise-parabolic-and-hyperbolic-orbits">
<h3><span class="section-number">2.9.12. </span>Exercise: Parabolic and hyperbolic orbits<a class="headerlink" href="#exercise-parabolic-and-hyperbolic-orbits" title="Permalink to this headline">¶</a></h3>
<p>The solution to the radial function for an inverse-square-law force, see for example Taylor equation (8.59) or the equation above, is</p>
<div class="math notranslate nohighlight">
\[
r(\phi) = \frac{c}{1+\epsilon\cos{(\phi)}}.
\]</div>
<p>For <span class="math notranslate nohighlight">\(\epsilon=1\)</span> (or the energy <span class="math notranslate nohighlight">\(E=0\)</span>) the orbit reduces to a parabola as we saw in the previous exercise,
while for <span class="math notranslate nohighlight">\(\epsilon &gt; 1\)</span> (or energy positive) the orbit becomes a hyperbola. The equation for a hyperbola in Cartesian coordinates is</p>
<div class="math notranslate nohighlight">
\[
\frac{(x-\delta)^2}{\alpha^2}-\frac{y^2}{\beta^2}=1.
\]</div>
<p>For a hyperbola, identify the constants <span class="math notranslate nohighlight">\(\alpha\)</span>, <span class="math notranslate nohighlight">\(\beta\)</span> and <span class="math notranslate nohighlight">\(\delta\)</span> in terms of the constants <span class="math notranslate nohighlight">\(c\)</span> and <span class="math notranslate nohighlight">\(\epsilon\)</span> for <span class="math notranslate nohighlight">\(r(\phi)\)</span>.</p>
<!-- Equation labels as ordinary links -->
<div id="_auto75"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
x  = r\cos\phi
\label{_auto75} \tag{88}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto76"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = \frac{c\cos\phi}{1+\epsilon\cos\phi}
\label{_auto76} \tag{89}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto77"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
y  = r\sin\phi 
\label{_auto77} \tag{90}
\end{equation}
\]</div>
<!-- Equation labels as ordinary links -->
<div id="_auto78"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}   = \frac{c\sin\phi}{1+\epsilon\cos\phi}
\label{_auto78} \tag{91}
\end{equation}
\]</div>
<p>Here <span class="math notranslate nohighlight">\(\epsilon&gt;1\)</span>.  We use our equation for <span class="math notranslate nohighlight">\(r\)</span>, multiply with the denominator <span class="math notranslate nohighlight">\(1+\epsilon\cos\phi\)</span> on both sides and have</p>
<div class="math notranslate nohighlight">
\[
r(1+\epsilon\cos\phi)=c,
\]</div>
<p>use <span class="math notranslate nohighlight">\(x=r\cos\phi\)</span> and square and use that <span class="math notranslate nohighlight">\(r^2=x^2+y^2\)</span> and we have</p>
<div class="math notranslate nohighlight">
\[
r^2=x^2+y^2=c^2+\epsilon^2x^2-2cx\epsilon,
\]</div>
<p>and reorder</p>
<div class="math notranslate nohighlight">
\[
x^2(\epsilon^2-1)-y^2-2cx\epsilon= -c^2.
\]</div>
<p>We complete the square in <span class="math notranslate nohighlight">\(x\)</span> by adding and subtracting on both sides <span class="math notranslate nohighlight">\(\epsilon^2c^2/(\epsilon^2-1)\)</span>
and we obtain</p>
<div class="math notranslate nohighlight">
\[
(\epsilon^2-1)(x-\delta)^2-y^2= -c^2+\frac{\epsilon^2c^2}{\epsilon^2-1}.
\]</div>
<p>Here we have defined</p>
<div class="math notranslate nohighlight">
\[
\delta = \frac{c\epsilon}{\epsilon^2-1},
\]</div>
<p>and introducing the constants</p>
<div class="math notranslate nohighlight">
\[
\alpha = \frac{c}{\epsilon^2-1},
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\beta = \frac{c}{\sqrt{\epsilon^2-1}},
\]</div>
<p>we can rewrite the above equation as</p>
<div class="math notranslate nohighlight">
\[
\frac{(x-\delta)^2}{\alpha^2}-\frac{y^2}{\beta^2}=1,
\]</div>
<p>which is nothing but the equation for a hyperbola.</p>
</div>
<div class="section" id="exercise-testing-orbit-types">
<h3><span class="section-number">2.9.13. </span>Exercise: Testing orbit types<a class="headerlink" href="#exercise-testing-orbit-types" title="Permalink to this headline">¶</a></h3>
<p>In this exercise we can use the program for <span class="math notranslate nohighlight">\(r(\phi)\)</span> we developed in hw8. We will use an inverse-square-law force as in the previous four exercises. The aim is to see that the orbits we get for <span class="math notranslate nohighlight">\(E&lt;0\)</span> become ellipses (or circles), parabola for <span class="math notranslate nohighlight">\(E=0\)</span> and hyperbola for <span class="math notranslate nohighlight">\(E&gt;0\)</span>.  An example code is shown here.</p>
<p>Here we have defined the constants <span class="math notranslate nohighlight">\(L=m=\alpha=1\)</span>. Feel free to set new values. <strong>You need also to set the initial conditions</strong> in order to study the different types of orbits. It may be useful to plot the potential here and find the values for the initial conditions that fit <span class="math notranslate nohighlight">\(E&lt;0\)</span>, <span class="math notranslate nohighlight">\(E=0\)</span> and <span class="math notranslate nohighlight">\(E&gt;0\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># Simple Gravitational Force   -alpha/r</span>
    
<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">100.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, v and r</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Constants of the model, setting all variables to one for simplicity</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="n">AngMom</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1">#  The angular momentum</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># scale mass to one</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">m</span>
<span class="c1"># You need to specify the initial conditions</span>
<span class="c1"># Here we have chosen the conditions which lead to circular orbit and thereby a constant r</span>
<span class="n">r0</span> <span class="o">=</span> <span class="p">(</span><span class="n">AngMom</span><span class="o">*</span><span class="n">AngMom</span><span class="o">/</span><span class="n">m</span><span class="o">/</span><span class="n">alpha</span><span class="p">)</span>
<span class="n">v0</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="c1"># Start integrating using the Velocity-Verlet  method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up acceleration</span>
    <span class="n">a</span> <span class="o">=</span> <span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="c1"># update velocity, time and position using the Velocity-Verlet method</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">DeltaT</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">a</span>
    <span class="n">anew</span> <span class="o">=</span> <span class="o">-</span><span class="n">alpha</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">c1</span><span class="o">/</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">DeltaT</span><span class="o">*</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">anew</span><span class="p">)</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
    <span class="c1"># Plot position as function of time</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;radius&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">r</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Velocity&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">v</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/chapter6_572_0.png" src="_images/chapter6_572_0.png" />
</div>
</div>
<p>Run your code and study and discuss the situations where you have
elliptical, parabolic and hyperbolic orbits. Discuss the physics of
these cases. The results from the four previous exercises 4 may be useful
here.  In the code here we have chosen initial conditions which correspond to circular motion.
This corresponds to</p>
<div class="math notranslate nohighlight">
\[
r_{\mathrm{min}} = \frac{L^2}{m\alpha}.
\]</div>
<p>Note well that the velocity is now the radial velocity. If we want to
study the angular velocity we would need to add the equations for this
quantity. The solution to exercises 1-4 give you the minimum <span class="math notranslate nohighlight">\(r\)</span>
values needed to find the elliptical, parabolic and hyperbolic
orbits. For elliptical orbits you should have <span class="math notranslate nohighlight">\(\frac{L^2}{2m\alpha} &lt;
r_{\mathrm{min}} &lt;\frac{L^2}{m\alpha}\)</span>. For parabolic orbits
<span class="math notranslate nohighlight">\(r_{\mathrm{min}} =\frac{L^2}{m\alpha}\)</span> and for hyperbolic orbits we
have <span class="math notranslate nohighlight">\(0&lt;r_{\mathrm{min}} &lt;\frac{L^2}{m\alpha}\)</span>. Try out these
different initial conditions in order to test these different types of
motion.</p>
</div>
<div class="section" id="exercise-new-reference-frame">
<h3><span class="section-number">2.9.14. </span>Exercise: New reference frame<a class="headerlink" href="#exercise-new-reference-frame" title="Permalink to this headline">¶</a></h3>
<p>Show that if one transforms to a reference frame where the total
momentum is zero, <span class="math notranslate nohighlight">\(\boldsymbol{p}_1=-\boldsymbol{p}_2\)</span>, that the relative momentum
<span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span> corresponds to either <span class="math notranslate nohighlight">\(\boldsymbol{p}_1\)</span> or <span class="math notranslate nohighlight">\(-\boldsymbol{p}_2\)</span>. This
means that in this frame the magnitude of <span class="math notranslate nohighlight">\(\boldsymbol{q}\)</span> is one half the
magnitude of <span class="math notranslate nohighlight">\(\boldsymbol{p}_1-\boldsymbol{p}_2\)</span>.</p>
</div>
<div class="section" id="exercise-center-of-mass-and-relative-coordinates">
<h3><span class="section-number">2.9.15. </span>Exercise: Center of mass and relative coordinates<a class="headerlink" href="#exercise-center-of-mass-and-relative-coordinates" title="Permalink to this headline">¶</a></h3>
<p>Given the center of mass and relative coordinates <span class="math notranslate nohighlight">\(\boldsymbol{R}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{r}\)</span>, respectively, for
particles of mass <span class="math notranslate nohighlight">\(m_1\)</span> and <span class="math notranslate nohighlight">\(m_2\)</span>, find the coordinates <span class="math notranslate nohighlight">\(\boldsymbol{r}_1\)</span>
and <span class="math notranslate nohighlight">\(\boldsymbol{r}_2\)</span> in terms of the masses, <span class="math notranslate nohighlight">\(\boldsymbol{R}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{r}\)</span>.</p>
</div>
<div class="section" id="exercise-two-body-problems">
<h3><span class="section-number">2.9.16. </span>Exercise: Two-body problems<a class="headerlink" href="#exercise-two-body-problems" title="Permalink to this headline">¶</a></h3>
<p>Consider a particle of mass <span class="math notranslate nohighlight">\(m\)</span> moving in a potential</p>
<div class="math notranslate nohighlight">
\[
V(r)=\alpha\ln(r/\alpha),
\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha\)</span> is a constant.</p>
<ul class="simple">
<li><p>(a) If the particle is moving in a circular orbit of radius <span class="math notranslate nohighlight">\(R\)</span>, find the angular frequency <span class="math notranslate nohighlight">\(\dot{\theta}\)</span>. Solve this by setting <span class="math notranslate nohighlight">\(F=-m\dot{\theta}^2r\)</span> (force and acceleration point inward).</p></li>
<li><p>(b) Express the angular momentum <span class="math notranslate nohighlight">\(L\)</span> in terms of the constant <span class="math notranslate nohighlight">\(\alpha\)</span>, the mass <span class="math notranslate nohighlight">\(m\)</span> and the radius <span class="math notranslate nohighlight">\(R\)</span>. Also express <span class="math notranslate nohighlight">\(R\)</span> in terms of <span class="math notranslate nohighlight">\(L\)</span>, <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(m\)</span>.</p></li>
<li><p>(c) Sketch the effective radial potential, <span class="math notranslate nohighlight">\(V_{\rm eff}(r)\)</span>, for a particle with angular momentum <span class="math notranslate nohighlight">\(L\)</span>. (No longer necessarily moving in a circular orbit.)</p></li>
<li><p>(d) Find the position of the minimum of <span class="math notranslate nohighlight">\(V_{\rm eff}\)</span> in terms of <span class="math notranslate nohighlight">\(L\)</span>, <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(m\)</span>, then compare to the result of (b).</p></li>
<li><p>(e)  What is the effective spring constant for a particle at the minimum of <span class="math notranslate nohighlight">\(V_{\rm eff}\)</span>? Express your answer in terms of <span class="math notranslate nohighlight">\(L\)</span>, <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span>.</p></li>
<li><p>(f)   What is the angular frequency, <span class="math notranslate nohighlight">\(\omega\)</span>, for small oscillations of <span class="math notranslate nohighlight">\(r\)</span> about the <span class="math notranslate nohighlight">\(R_{\rm min}\)</span>?  Express your answer in terms of <span class="math notranslate nohighlight">\(\dot{\theta}\)</span> from part (3a).</p></li>
</ul>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="chapter5.html" title="previous page"><span class="section-number">1. </span>Harmonic Oscillations</a>
    <a class='right-next' id="next-link" href="chapter7.html" title="next page"><span class="section-number">3. </span>Non-inertial Frames, Translation and Rotating Coordinate Systems</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Morten Hjorth-Jensen and Scott Pratt<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>