
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3. Simple Motion problems and Reminder on Newton’s Laws &#8212; Classical mechanics</title>
    
  <link rel="stylesheet" href="_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.e7340bb3dbd8dde6db86f25597f54a1b.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.7d483ff0a819d6edff12ce0b1ead3928.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4. Work, Energy, Momentum and Conservation laws" href="chapter4.html" />
    <link rel="prev" title="2. Classical Mechanics, Mathematics and Numerical background" href="chapter2.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Classical mechanics</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   PHY321 Classical Mechanics I, Michigan State University, Spring 2021
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  About the course
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="schedule.html">
   Teaching schedule with links to material
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="teachers.html">
   Teachers and Grading
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="textbooks.html">
   Textbooks
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Introductory Material
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter1.html">
   1. Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter2.html">
   2. Classical Mechanics, Mathematics and Numerical background
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   3. Simple Motion problems and Reminder on Newton’s Laws
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter4.html">
   4. Work, Energy, Momentum and Conservation laws
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Advanced Topics
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="chapter5.html">
   1. Harmonic Oscillations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter6.html">
   2. Two-body problems and Gravitational Forces
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter7.html">
   3. Non-inertial Frames, Translation and Rotating Coordinate Systems
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="chapter8.html">
   4. Variational Calculus and Lagrangian Formalism
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/chapter3.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->


            <!-- Full screen (wrap in <a> to have style consistency -->
            <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                    data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                    title="Fullscreen mode"><i
                        class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i>
            Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-steps-of-scientific-investigations">
   3.1. Basic Steps of Scientific Investigations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#identifying-our-system">
     3.1.1. Identifying our System
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#defining-a-model">
     3.1.2. Defining a Model
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#solving-the-equations">
     3.1.3. Solving the Equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analyze">
     3.1.4. Analyze
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#newton-s-laws">
   3.2. Newton’s Laws
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#then-the-first-law">
     3.2.1. Then the First Law
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#and-finally-the-third-law">
     3.2.2. And finally the Third Law
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#falling-baseball-in-one-dimension">
   3.3. Falling baseball in one dimension
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compact-equations">
     3.3.1. Compact equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#integrating-our-equations">
     3.3.2. Integrating our equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computing-the-averages">
     3.3.3. Computing the averages
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#including-air-resistance-in-our-model">
   3.4. Including Air Resistance in our model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#our-first-attempt-at-solving-differential-equations">
   3.5. Our first attempt at solving differential equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#discretizing-our-equations">
     3.5.1. Discretizing our equations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#simple-extension-the-euler-cromer-method">
     3.5.2. Simple extension, the Euler-Cromer method
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#air-resistance-in-one-dimension">
   3.6. Air Resistance in One Dimension
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ways-of-solving-these-equations">
   3.7. Ways of solving these equations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#differential-equations-contn">
   3.8. Differential Equations, contn
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#motion-in-a-magnetic-field">
   3.9. Motion in a Magnetic Field
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summarizing-the-various-motion-problems">
   3.10. Summarizing the various motion problems
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exercises">
   3.11. Exercises
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#electron-moving-into-an-electric-field">
     3.11.1. Electron moving into an electric field
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#drag-force">
     3.11.2. Drag force
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#falling-object">
     3.11.3. Falling object
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#motion-of-a-cyclist">
     3.11.4. Motion of a cyclist
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#falling-ball-and-preparing-for-the-numerical-exercise">
     3.11.5. Falling ball and preparing for the numerical exercise
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numerical-elements-solving-the-previous-exercise-numerically-and-adding-the-bouncing-from-the-floor">
     3.11.6. Numerical elements, solving the previous exercise  numerically and adding the bouncing from the floor
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="simple-motion-problems-and-reminder-on-newton-s-laws">
<h1><span class="section-number">3. </span>Simple Motion problems and Reminder on Newton’s Laws<a class="headerlink" href="#simple-motion-problems-and-reminder-on-newton-s-laws" title="Permalink to this headline">¶</a></h1>
<div class="section" id="basic-steps-of-scientific-investigations">
<h2><span class="section-number">3.1. </span>Basic Steps of Scientific Investigations<a class="headerlink" href="#basic-steps-of-scientific-investigations" title="Permalink to this headline">¶</a></h2>
<p>An overarching aim in this course is to give you a deeper
understanding of the scientific method. The problems we study will all
involve cases where we can apply classical mechanics. In our previous
material we already assumed that we had a model for the motion of an
object.  Alternatively we could have data from experiment (like Usain
Bolt’s 100m world record run in 2008).  Or we could have performed
ourselves an experiment and we want to understand which forces are at
play and whether these forces can be understood in terms of
fundamental forces.</p>
<p>Our first step consists in identifying the problem. What we sketch
here may include a mix of experiment and theoretical simulations, or
just experiment or only theory.</p>
<div class="section" id="identifying-our-system">
<h3><span class="section-number">3.1.1. </span>Identifying our System<a class="headerlink" href="#identifying-our-system" title="Permalink to this headline">¶</a></h3>
<p>Here we can ask questions like</p>
<ol class="simple">
<li><p>What kind of object is moving</p></li>
<li><p>What kind of data do we have</p></li>
<li><p>How do we measure position, velocity, acceleration etc</p></li>
<li><p>Which initial conditions influence our system</p></li>
<li><p>Other aspects which allow us to identify the system</p></li>
</ol>
</div>
<div class="section" id="defining-a-model">
<h3><span class="section-number">3.1.2. </span>Defining a Model<a class="headerlink" href="#defining-a-model" title="Permalink to this headline">¶</a></h3>
<p>With our eventual data and observations we would now like to develop a
model for the system. In the end we want obviously to be able to
understand which forces are at play and how they influence our
specific system. That is, can we extract some deeper insights about a
system?</p>
<p>We need then to</p>
<ol class="simple">
<li><p>Find the forces that act on our system</p></li>
<li><p>Introduce models for the forces</p></li>
<li><p>Identify the equations which can govern the system (Newton’s second law for example)</p></li>
<li><p>More elements we deem important for defining our model</p></li>
</ol>
</div>
<div class="section" id="solving-the-equations">
<h3><span class="section-number">3.1.3. </span>Solving the Equations<a class="headerlink" href="#solving-the-equations" title="Permalink to this headline">¶</a></h3>
<p>With the model at hand, we can then solve the equations. In classical mechanics we normally end up  with solving sets of coupled ordinary differential equations or partial differential equations.</p>
<ol class="simple">
<li><p>Using Newton’s second law we have equations of the type <span class="math notranslate nohighlight">\(\boldsymbol{F}=m\boldsymbol{a}=md\boldsymbol{v}/dt\)</span></p></li>
<li><p>We need to  define the initial conditions (typically the initial velocity and position as functions of time) and/or initial conditions and boundary conditions</p></li>
<li><p>The solution of the equations give us then the position, the velocity and other time-dependent quantities which may specify the motion of a given object.</p></li>
</ol>
<p>We are not yet done. With our lovely solvers, we need to start thinking.</p>
</div>
<div class="section" id="analyze">
<h3><span class="section-number">3.1.4. </span>Analyze<a class="headerlink" href="#analyze" title="Permalink to this headline">¶</a></h3>
<p>Now it is time to ask the big questions. What do our results mean? Can we give a simple interpretation in terms of fundamental laws?  What do our results mean? Are they correct?
Thus, typical questions we may ask are</p>
<ol class="simple">
<li><p>Are our results for say <span class="math notranslate nohighlight">\(\boldsymbol{r}(t)\)</span> valid?  Do we trust what we did?  Can you validate and verify the correctness of your results?</p></li>
<li><p>Evaluate the answers and their implications</p></li>
<li><p>Compare with experimental data if possible. Does our model make sense?</p></li>
<li><p>and obviously many other questions.</p></li>
</ol>
<p>The analysis stage feeds back to the first stage. It may happen that
the data we had were not good enough, there could be large statistical
uncertainties. We may need to collect more data or perhaps we did a
sloppy job in identifying the degrees of freedom.</p>
<p>All these steps are essential elements in a scientific
enquiry. Hopefully, through a mix of numerical simulations, analytical
calculations and experiments we may gain a deeper insight about the
physics of a specific system.</p>
</div>
</div>
<div class="section" id="newton-s-laws">
<h2><span class="section-number">3.2. </span>Newton’s Laws<a class="headerlink" href="#newton-s-laws" title="Permalink to this headline">¶</a></h2>
<p>Let us now remind ourselves of Newton’s laws, since these are the laws of motion we will study in this course.</p>
<p>When analyzing a physical system we normally start with distinguishing between the object we are studying (we will label this in more general terms as our <strong>system</strong>) and how this system interacts with the environment (which often means everything else!)</p>
<p>In our investigations we will thus analyze a specific physics problem in terms of the system and the environment.
In doing so we need to identify the forces that act on the system and assume that the
forces acting on the system must have a source, an identifiable cause in
the environment.</p>
<p>A force acting on for example a falling object must be related to an interaction with something in the environment.
This also means that we do not consider internal forces. The latter are forces between
one part of the object and another part. In this course we will mainly focus on external forces.</p>
<p>Forces are either contact forces or long-range forces.</p>
<p>Contact forces, as evident from the name, are forces that occur at the contact between
the system and the environment. Well-known long-range forces are the gravitional force and the electromagnetic force.</p>
<p>In order to set up the forces which act on an object, the following steps may be useful</p>
<ol class="simple">
<li><p>Divide the problem into system and environment.</p></li>
<li><p>Draw a figure of the object and everything in contact with the object.</p></li>
<li><p>Draw a closed curve around the system.</p></li>
<li><p>Find contact points—these are the points where contact forces may act.</p></li>
<li><p>Give names and symbols to all the contact forces.</p></li>
<li><p>Identify the long-range forces.</p></li>
<li><p>Make a drawing of the object. Draw the forces as arrows, vectors, starting from where the force is acting. The direction of the vector(s) indicates the (positive) direction of the force. Try to make the length of the arrow indicate the relative magnitude of the forces.</p></li>
<li><p>Draw in the axes of the coordinate system. It is often convenient to make one axis parallel to the direction of motion. When you choose the direction of the axis you also choose the positive direction for the axis.</p></li>
</ol>
<p>Newton’s second law of motion: The force <span class="math notranslate nohighlight">\(\boldsymbol{F}\)</span> on an object of inertial mass <span class="math notranslate nohighlight">\(m\)</span>
is related to the acceleration a of the object through</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F} = m\boldsymbol{a},
\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{a}\)</span> is the acceleration.</p>
<p>Newton’s laws of motion are laws of nature that have been found by experimental
investigations and have been shown to hold up to continued experimental investigations.
Newton’s laws are valid over a wide range of length- and time-scales. We
use Newton’s laws of motion to describe everything from the motion of atoms to the
motion of galaxies.</p>
<p>The second law is a vector equation with the acceleration having the same
direction as the force. The acceleration is proportional to the force via the mass <span class="math notranslate nohighlight">\(m\)</span> of the system under study.</p>
<p>Newton’s second law introduces a new property of an object, the so-called
inertial mass <span class="math notranslate nohighlight">\(m\)</span>. We determine the inertial mass of an object by measuring the
acceleration for a given applied force.</p>
<div class="section" id="then-the-first-law">
<h3><span class="section-number">3.2.1. </span>Then the First Law<a class="headerlink" href="#then-the-first-law" title="Permalink to this headline">¶</a></h3>
<p>What happens if the net external force on a body is zero? Applying Newton’s second
law, we find:</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{F} = 0 = m\boldsymbol{a},
\]</div>
<p>which gives using the definition of the acceleration</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{a} = \frac{d\boldsymbol{v}}{dt}=0.
\]</div>
<p>The acceleration is zero, which means that the velocity of the object is constant. This
is often referred to as Newton’s first law. An object in a state of uniform motion tends to remain in
that state unless an external force changes its state of motion.
Why do we need a separate law for this? Is it not simply a special case of Newton’s
second law? Yes, Newton’s first law can be deduced from the second law as we have
illustrated. However, the first law is often used for a different purpose: Newton’s
First Law tells us about the limit of applicability of Newton’s Second law. Newton’s
Second law can only be used in reference systems where the First law is obeyed. But
is not the First law always valid? No! The First law is only valid in reference systems
that are not accelerated. If you observe the motion of a ball from an accelerating
car, the ball will appear to accelerate even if there are no forces acting on it. We call
systems that are not accelerating inertial systems, and Newton’s first law is often
called the law of inertia. Newton’s first and second laws of motion are only valid in
inertial systems.</p>
<p>A system is an inertial system if it is not accelerated. It means that the reference system
must not be accelerating linearly or rotating. Unfortunately, this means that most
systems we know are not really inertial systems. For example, the surface of the
Earth is clearly not an inertial system, because the Earth is rotating. The Earth is also
not an inertial system, because it ismoving in a curved path around the Sun. However,
even if the surface of the Earth is not strictly an inertial system, it may be considered
to be approximately an inertial system for many laboratory-size experiments.</p>
</div>
<div class="section" id="and-finally-the-third-law">
<h3><span class="section-number">3.2.2. </span>And finally the Third Law<a class="headerlink" href="#and-finally-the-third-law" title="Permalink to this headline">¶</a></h3>
<p>If there is a force from object A on object B, there is also a force from object B on object A.
This fundamental principle of interactions is called Newton’s third law. We do not
know of any force that do not obey this law: All forces appear in pairs. Newton’s
third law is usually formulated as: For every action there is an equal and opposite
reaction.</p>
</div>
</div>
<div class="section" id="falling-baseball-in-one-dimension">
<h2><span class="section-number">3.3. </span>Falling baseball in one dimension<a class="headerlink" href="#falling-baseball-in-one-dimension" title="Permalink to this headline">¶</a></h2>
<p>We anticipate the mathematical model to come and assume that we have a
model for the motion of a falling baseball without air resistance.
Our system (the baseball) is at an initial height <span class="math notranslate nohighlight">\(y_0\)</span> (which we will
specify in the program below) at the initial time <span class="math notranslate nohighlight">\(t_0=0\)</span>. In our program example here we will plot the position in steps of <span class="math notranslate nohighlight">\(\Delta t\)</span> up to a final time <span class="math notranslate nohighlight">\(t_f\)</span>.
The mathematical formula for the position <span class="math notranslate nohighlight">\(y(t)\)</span> as function of time <span class="math notranslate nohighlight">\(t\)</span> is</p>
<div class="math notranslate nohighlight">
\[
y(t) = y_0-\frac{1}{2}gt^2,
\]</div>
<p>where <span class="math notranslate nohighlight">\(g=9.80665=0.980655\times 10^1\)</span>m/s<span class="math notranslate nohighlight">\(^2\)</span> is a constant representing the standard acceleration due to gravity.
We have here adopted the conventional standard value. This does not take into account other effects, such as buoyancy or drag.
Furthermore, we stop when the ball hits the ground, which takes place at</p>
<div class="math notranslate nohighlight">
\[
y(t) = 0= y_0-\frac{1}{2}gt^2,
\]</div>
<p>which gives us a final time <span class="math notranslate nohighlight">\(t_f=\sqrt{2y_0/g}\)</span>.</p>
<p>As of now we simply assume that   we know the formula for the falling object. Afterwards, we will derive it.</p>
<p>We start with preparing folders for storing our calculations, figures and if needed, specific data files we use as input or output files.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Where to save the figures and data files</span>
<span class="n">PROJECT_ROOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
<span class="n">FIGURE_ID</span> <span class="o">=</span> <span class="s2">&quot;Results/FigureFiles&quot;</span>
<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s2">&quot;DataFiles/&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">,</span> <span class="n">fig_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_path</span><span class="p">(</span><span class="n">dat_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">,</span> <span class="n">dat_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>

<span class="c1">#in case we have an input file we wish to read in</span>
<span class="c1">#infile = open(data_path(&quot;MassEval2016.dat&quot;),&#39;r&#39;)</span>
</pre></div>
</div>
</div>
</div>
<p>You could also define a function for making our plots. You
can obviously avoid this and simply set up various <strong>matplotlib</strong>
commands every time you need them. You may however find it convenient
to collect all such commands in one function and simply call this
function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">plt</span><span class="p">,</span> <span class="n">mpl</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn&#39;</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;serif&#39;</span>

<span class="k">def</span> <span class="nf">MakePlot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">styles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">axlabels</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">styles</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">axlabels</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">axlabels</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Thereafter we start setting up the code for the falling object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.patches</span> <span class="k">as</span> <span class="nn">mpatches</span>

<span class="n">g</span> <span class="o">=</span> <span class="mf">9.80655</span> <span class="c1">#m/s^2</span>
<span class="n">y_0</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1"># initial position in meters</span>
<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># time step</span>
<span class="c1"># final time when y = 0, t = sqrt(2*10/g)</span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">y_0</span><span class="o">/</span><span class="n">g</span><span class="p">)</span>
<span class="c1">#set up arrays </span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tfinal</span><span class="p">,</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span><span class="n">y_0</span> <span class="o">-</span><span class="n">g</span><span class="o">*.</span><span class="mi">5</span><span class="o">*</span><span class="n">t</span><span class="o">**</span><span class="mi">2</span>
<span class="c1"># Then make a nice printout in table form using Pandas</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;t[s]&#39;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span>
        <span class="s1">&#39;y[m]&#39;</span><span class="p">:</span> <span class="n">y</span>
        <span class="p">}</span>
<span class="n">RawData</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">RawData</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">blue_patch</span> <span class="o">=</span> <span class="n">mpatches</span><span class="o">.</span><span class="n">Patch</span><span class="p">(</span><span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Height y as function of  time t&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="o">=</span><span class="p">[</span><span class="n">blue_patch</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;t[s]&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;y[m]&quot;</span><span class="p">)</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;FallingBaseball&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t[s]</th>
      <th>y[m]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>10.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.1</td>
      <td>9.950967</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.2</td>
      <td>9.803869</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.3</td>
      <td>9.558705</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.4</td>
      <td>9.215476</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.5</td>
      <td>8.774181</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.6</td>
      <td>8.234821</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.7</td>
      <td>7.597395</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.8</td>
      <td>6.861904</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.9</td>
      <td>6.028347</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.0</td>
      <td>5.096725</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1.1</td>
      <td>4.067037</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.2</td>
      <td>2.939284</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1.3</td>
      <td>1.713465</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.4</td>
      <td>0.389581</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="_images/chapter3_15_1.png" src="_images/chapter3_15_1.png" />
</div>
</div>
<p>Here we used <strong>pandas</strong> (see below) to systemize the output of the position as function of time.</p>
<p>We define now the average velocity as</p>
<div class="math notranslate nohighlight">
\[
\overline{v}(t) = \frac{y(t+\Delta t)-y(t)}{\Delta t}.
\]</div>
<p>In the code we have set the time step <span class="math notranslate nohighlight">\(\Delta t\)</span> to a given value. We could define it in terms of the number of points <span class="math notranslate nohighlight">\(n\)</span> as</p>
<div class="math notranslate nohighlight">
\[
\Delta t = \frac{t_{\mathrm{final}-}t_{\mathrm{initial}}}{n+1}.
\]</div>
<p>Since we have discretized the variables, we introduce the counter <span class="math notranslate nohighlight">\(i\)</span> and let <span class="math notranslate nohighlight">\(y(t)\rightarrow y(t_i)=y_i\)</span> and <span class="math notranslate nohighlight">\(t\rightarrow t_i\)</span>
with <span class="math notranslate nohighlight">\(i=0,1,\dots, n\)</span>. This gives us the following shorthand notations that we will use for the rest of this course. We define</p>
<div class="math notranslate nohighlight">
\[
y_i = y(t_i),\hspace{0.2cm} i=0,1,2,\dots,n.
\]</div>
<p>This applies to other variables which depend on say time. Examples are the velocities, accelerations, momenta etc.
Furthermore we use the shorthand</p>
<div class="math notranslate nohighlight">
\[
y_{i\pm 1} = y(t_i\pm \Delta t),\hspace{0.12cm} i=0,1,2,\dots,n.
\]</div>
<div class="section" id="compact-equations">
<h3><span class="section-number">3.3.1. </span>Compact equations<a class="headerlink" href="#compact-equations" title="Permalink to this headline">¶</a></h3>
<p>We can then rewrite in a more compact form the average velocity as</p>
<div class="math notranslate nohighlight">
\[
\overline{v}_i = \frac{y_{i+1}-y_{i}}{\Delta t}.
\]</div>
<p>The velocity is defined as the change in position per unit time.
In the limit <span class="math notranslate nohighlight">\(\Delta t \rightarrow 0\)</span> this defines the instantaneous velocity, which is nothing but the slope of the position at a time <span class="math notranslate nohighlight">\(t\)</span>.
We have thus</p>
<div class="math notranslate nohighlight">
\[
v(t) = \frac{dy}{dt}=\lim_{\Delta t \rightarrow 0}\frac{y(t+\Delta t)-y(t)}{\Delta t}.
\]</div>
<p>Similarly, we can define the average acceleration as the change in velocity per unit time as</p>
<div class="math notranslate nohighlight">
\[
\overline{a}_i = \frac{v_{i+1}-v_{i}}{\Delta t},
\]</div>
<p>resulting in the instantaneous acceleration</p>
<div class="math notranslate nohighlight">
\[
a(t) = \frac{dv}{dt}=\lim_{\Delta t\rightarrow 0}\frac{v(t+\Delta t)-v(t)}{\Delta t}.
\]</div>
<p><strong>A note on notations</strong>: When writing for example the velocity as <span class="math notranslate nohighlight">\(v(t)\)</span> we are then referring to the continuous and instantaneous value. A subscript like
<span class="math notranslate nohighlight">\(v_i\)</span> refers always to the discretized values.</p>
<p>We can rewrite the instantaneous acceleration as</p>
<div class="math notranslate nohighlight">
\[
a(t) = \frac{dv}{dt}=\frac{d}{dt}\frac{dy}{dt}=\frac{d^2y}{dt^2}.
\]</div>
<p>This forms the starting point for our definition of forces later. It is a famous second-order differential equation. If the acceleration is constant we can now recover the formula for the falling ball we started with.
The acceleration can depend on the position and the velocity. To be more formal we should then write the above differential equation as</p>
<div class="math notranslate nohighlight">
\[
\frac{d^2y}{dt^2}=a(t,y(t),\frac{dy}{dt}).
\]</div>
<p>With given initial conditions for <span class="math notranslate nohighlight">\(y(t_0)\)</span> and <span class="math notranslate nohighlight">\(v(t_0)\)</span> we can then
integrate the above equation and find the velocities and positions at
a given time <span class="math notranslate nohighlight">\(t\)</span>.</p>
<p>If we multiply with mass, we have one of the famous expressions for Newton’s second law,</p>
<div class="math notranslate nohighlight">
\[
F(y,v,t)=m\frac{d^2y}{dt^2}=ma(t,y(t),\frac{dy}{dt}),
\]</div>
<p>where <span class="math notranslate nohighlight">\(F\)</span> is the force acting on an object with mass <span class="math notranslate nohighlight">\(m\)</span>. We see that it also has the right dimension, mass times length divided by time squared.
We will come back to this soon.</p>
</div>
<div class="section" id="integrating-our-equations">
<h3><span class="section-number">3.3.2. </span>Integrating our equations<a class="headerlink" href="#integrating-our-equations" title="Permalink to this headline">¶</a></h3>
<p>Formally we can then, starting with the acceleration (suppose we have measured it, how could we do that?)
compute say the height of a building.  To see this we perform the following integrations from an initial time <span class="math notranslate nohighlight">\(t_0\)</span>  to a given time <span class="math notranslate nohighlight">\(t\)</span></p>
<div class="math notranslate nohighlight">
\[
\int_{t_0}^t dt a(t) = \int_{t_0}^t dt \frac{dv}{dt} = v(t)-v(t_0),
\]</div>
<p>or as</p>
<div class="math notranslate nohighlight">
\[
v(t)=v(t_0)+\int_{t_0}^t dt a(t).
\]</div>
<p>When we know the velocity as function of time, we can find the position as function of time starting from the defintion of velocity as the derivative with respect to time, that is we have</p>
<div class="math notranslate nohighlight">
\[
\int_{t_0}^t dt v(t) = \int_{t_0}^t dt \frac{dy}{dt} = y(t)-y(t_0),
\]</div>
<p>or as</p>
<div class="math notranslate nohighlight">
\[
y(t)=y(t_0)+\int_{t_0}^t dt v(t).
\]</div>
<p>These equations define what is called the integration method for
finding the position and the velocity as functions of time. There is
no loss of generality if we extend these equations to more than one
spatial dimension.</p>
<p>Let us compute the velocity using the constant value for the acceleration given by <span class="math notranslate nohighlight">\(-g\)</span>. We have</p>
<div class="math notranslate nohighlight">
\[
v(t)=v(t_0)+\int_{t_0}^t dt a(t)=v(t_0)+\int_{t_0}^t dt (-g).
\]</div>
<p>Using our initial time as <span class="math notranslate nohighlight">\(t_0=0\)</span>s and setting the initial velocity <span class="math notranslate nohighlight">\(v(t_0)=v_0=0\)</span>m/s we get when integrating</p>
<div class="math notranslate nohighlight">
\[
v(t)=-gt.
\]</div>
<p>The more general case is</p>
<div class="math notranslate nohighlight">
\[
v(t)=v_0-g(t-t_0).
\]</div>
<p>We can then integrate the velocity and obtain the final formula for the position as function of time through</p>
<div class="math notranslate nohighlight">
\[
y(t)=y(t_0)+\int_{t_0}^t dt v(t)=y_0+\int_{t_0}^t dt v(t)=y_0+\int_{t_0}^t dt (-gt),
\]</div>
<p>With <span class="math notranslate nohighlight">\(y_0=10\)</span>m and <span class="math notranslate nohighlight">\(t_0=0\)</span>s, we obtain the equation we started with</p>
<div class="math notranslate nohighlight">
\[
y(t)=10-\frac{1}{2}gt^2.
\]</div>
</div>
<div class="section" id="computing-the-averages">
<h3><span class="section-number">3.3.3. </span>Computing the averages<a class="headerlink" href="#computing-the-averages" title="Permalink to this headline">¶</a></h3>
<p>After this mathematical background we are now ready to compute the mean velocity using our data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now we can compute the mean velocity using our data</span>
<span class="c1"># We define first an array Vaverage</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">Vaverage</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">Vaverage</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">DeltaT</span>
<span class="c1"># Now we can compute the mean accelearatio using our data</span>
<span class="c1"># We define first an array Aaverage</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="n">Aaverage</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">Aaverage</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">g</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">Aaverage</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">Vaverage</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">Vaverage</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">DeltaT</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;t[s]&#39;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span>
        <span class="s1">&#39;y[m]&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">,</span>
        <span class="s1">&#39;v[m/s]&#39;</span><span class="p">:</span> <span class="n">Vaverage</span><span class="p">,</span>
        <span class="s1">&#39;a[m/s^2]&#39;</span><span class="p">:</span> <span class="n">Aaverage</span>
        <span class="p">}</span>
<span class="n">NewData</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">NewData</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t[s]</th>
      <th>y[m]</th>
      <th>v[m/s]</th>
      <th>a[m/s^2]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>10.000000</td>
      <td>0.000000</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.1</td>
      <td>9.950967</td>
      <td>-1.470982</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.2</td>
      <td>9.803869</td>
      <td>-2.451638</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.3</td>
      <td>9.558705</td>
      <td>-3.432292</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.4</td>
      <td>9.215476</td>
      <td>-4.412948</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.5</td>
      <td>8.774181</td>
      <td>-5.393602</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.6</td>
      <td>8.234821</td>
      <td>-6.374258</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.7</td>
      <td>7.597395</td>
      <td>-7.354913</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.8</td>
      <td>6.861904</td>
      <td>-8.335567</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.9</td>
      <td>6.028347</td>
      <td>-9.316222</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>10</th>
      <td>1.0</td>
      <td>5.096725</td>
      <td>-10.296878</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>11</th>
      <td>1.1</td>
      <td>4.067037</td>
      <td>-11.277533</td>
      <td>-9.80655</td>
    </tr>
    <tr>
      <th>12</th>
      <td>1.2</td>
      <td>2.939284</td>
      <td>-12.258187</td>
      <td>-9.80655</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Note that we don’t print the last values!</p>
</div>
</div>
<div class="section" id="including-air-resistance-in-our-model">
<h2><span class="section-number">3.4. </span>Including Air Resistance in our model<a class="headerlink" href="#including-air-resistance-in-our-model" title="Permalink to this headline">¶</a></h2>
<p>In our discussions till now of the falling baseball, we have ignored
air resistance and simply assumed that our system is only influenced
by the gravitational force.  We will postpone the derivation of air
resistance till later, after our discussion of Newton’s laws and
forces.</p>
<p>For our discussions here it suffices to state that the accelerations is now modified to</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{a}(t) = -g +D\boldsymbol{v}(t)\vert v(t)\vert,
\]</div>
<p>where <span class="math notranslate nohighlight">\(\vert v(t)\vert\)</span> is the absolute value of the velocity and <span class="math notranslate nohighlight">\(D\)</span> is a constant which pertains to the specific object we are studying.
Since we are dealing with motion in one dimension, we can simplify the above to</p>
<div class="math notranslate nohighlight">
\[
a(t) = -g +Dv^2(t).
\]</div>
<p>We can rewrite this as a differential equation</p>
<div class="math notranslate nohighlight">
\[
a(t) = \frac{dv}{dt}=\frac{d^2y}{dt^2}= -g +Dv^2(t).
\]</div>
<p>Using the integral equations discussed above we can integrate twice
and obtain first the velocity as function of time and thereafter the
position as function of time.</p>
<p>For this particular case, we can actually obtain an analytical
solution for the velocity and for the position. Here we will first
compute the solutions analytically, thereafter we will derive Euler’s
method for solving these differential equations numerically.</p>
<p>For simplicity let us just write <span class="math notranslate nohighlight">\(v(t)\)</span> as <span class="math notranslate nohighlight">\(v\)</span>. We have</p>
<div class="math notranslate nohighlight">
\[
\frac{dv}{dt}= -g +Dv^2(t).
\]</div>
<p>We can solve this using the technique of separation of variables. We
isolate on the left all terms that involve <span class="math notranslate nohighlight">\(v\)</span> and on the right all
terms that involve time. We get then</p>
<div class="math notranslate nohighlight">
\[
\frac{dv}{g -Dv^2(t) }= -dt,
\]</div>
<p>We scale now the equation to the left by introducing a constant
<span class="math notranslate nohighlight">\(v_T=\sqrt{g/D}\)</span>. This constant has dimension length/time. Can you
show this?</p>
<p>Next we integrate the left-hand side (lhs) from <span class="math notranslate nohighlight">\(v_0=0\)</span> m/s to <span class="math notranslate nohighlight">\(v\)</span> and
the right-hand side (rhs) from <span class="math notranslate nohighlight">\(t_0=0\)</span> to <span class="math notranslate nohighlight">\(t\)</span> and obtain</p>
<div class="math notranslate nohighlight">
\[
\int_{0}^v\frac{dv}{g -Dv^2(t) }= \frac{v_T}{g}\mathrm{arctanh}(\frac{v}{v_T})  =-\int_0^tdt = -t.
\]</div>
<p>We can reorganize these equations as</p>
<div class="math notranslate nohighlight">
\[
v_T\mathrm{arctanh}(\frac{v}{v_T})  =-gt,
\]</div>
<p>which gives us <span class="math notranslate nohighlight">\(v\)</span> as function of time</p>
<div class="math notranslate nohighlight">
\[
v(t)=v_T\tanh{-(\frac{gt}{v_T})}.
\]</div>
<p>With the velocity we can then find the height <span class="math notranslate nohighlight">\(y(t)\)</span> by integrating yet another time, that is</p>
<div class="math notranslate nohighlight">
\[
y(t)=y(t_0)+\int_{t_0}^t dt v(t)=\int_{0}^t dt[v_T\tanh{-(\frac{gt}{v_T})}].
\]</div>
<p>This integral is a little bit trickier but we can look it up in a table over
known integrals and we get</p>
<div class="math notranslate nohighlight">
\[
y(t)=y(t_0)-\frac{v_T^2}{g}\log{[\cosh{(\frac{gt}{v_T})}]}.
\]</div>
<p>Alternatively we could have used the symbolic Python package <strong>Sympy</strong>  (example will be inserted later).</p>
<p>In most cases however, we need to revert to numerical solutions.</p>
</div>
<div class="section" id="our-first-attempt-at-solving-differential-equations">
<h2><span class="section-number">3.5. </span>Our first attempt at solving differential equations<a class="headerlink" href="#our-first-attempt-at-solving-differential-equations" title="Permalink to this headline">¶</a></h2>
<p>Here we will try the simplest possible approach to solving the second-order differential
equation</p>
<div class="math notranslate nohighlight">
\[
a(t) =\frac{d^2y}{dt^2}= -g +Dv^2(t).
\]</div>
<p>We rewrite it as two coupled first-order equations (this is a standard approach)</p>
<div class="math notranslate nohighlight">
\[
\frac{dy}{dt} = v(t),
\]</div>
<p>with initial condition <span class="math notranslate nohighlight">\(y(t_0)=y_0\)</span> and</p>
<div class="math notranslate nohighlight">
\[
a(t) =\frac{dv}{dt}= -g +Dv^2(t),
\]</div>
<p>with initial condition <span class="math notranslate nohighlight">\(v(t_0)=v_0\)</span>.</p>
<p>Many of the algorithms for solving differential equations start with simple Taylor equations.
If we now Taylor expand <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(v\)</span> around a value <span class="math notranslate nohighlight">\(t+\Delta t\)</span> we have</p>
<div class="math notranslate nohighlight">
\[
y(t+\Delta t) = y(t)+\Delta t \frac{dy}{dt}+\frac{\Delta t^2}{2!} \frac{d^2y}{dt^2}+O(\Delta t^3),
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
v(t+\Delta t) = v(t)+\Delta t \frac{dv}{dt}+\frac{\Delta t^2}{2!} \frac{d^2v}{dt^2}+O(\Delta t^3).
\]</div>
<p>Using the fact that <span class="math notranslate nohighlight">\(dy/dt = v\)</span> and <span class="math notranslate nohighlight">\(dv/dt=a\)</span> and keeping only terms up to <span class="math notranslate nohighlight">\(\Delta t\)</span> we have</p>
<div class="math notranslate nohighlight">
\[
y(t+\Delta t) = y(t)+\Delta t v(t)+O(\Delta t^2),
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
v(t+\Delta t) = v(t)+\Delta t a(t)+O(\Delta t^2).
\]</div>
<div class="section" id="discretizing-our-equations">
<h3><span class="section-number">3.5.1. </span>Discretizing our equations<a class="headerlink" href="#discretizing-our-equations" title="Permalink to this headline">¶</a></h3>
<p>Using our discretized versions of the equations with for example
<span class="math notranslate nohighlight">\(y_{i}=y(t_i)\)</span> and <span class="math notranslate nohighlight">\(y_{i\pm 1}=y(t_i+\Delta t)\)</span>, we can rewrite the
above equations as (and truncating at <span class="math notranslate nohighlight">\(\Delta t\)</span>)</p>
<div class="math notranslate nohighlight">
\[
y_{i+1} = y_i+\Delta t v_i,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
v_{i+1} = v_i+\Delta t a_i.
\]</div>
<p>These are the famous Euler equations (forward Euler).</p>
<p>To solve these equations numerically we start at a time <span class="math notranslate nohighlight">\(t_0\)</span> and simply integrate up these equations to a final time <span class="math notranslate nohighlight">\(t_f\)</span>,
The step size <span class="math notranslate nohighlight">\(\Delta t\)</span> is an input  parameter in our code.
You can define it directly in the code below as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.1</span>
</pre></div>
</div>
</div>
</div>
<p>With a given final time <strong>tfinal</strong>  we can then find the number of integration points via the <strong>ceil</strong> function included in the <strong>math</strong> package of Python
as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#define final time, assuming that initial time is zero</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">ceil</span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<p>The <strong>ceil</strong> function returns the smallest integer not less than the input in say</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mf">21.15</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>22
</pre></div>
</div>
</div>
</div>
<p>which in the case here is 22.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mf">21.75</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ceil</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>22
</pre></div>
</div>
</div>
</div>
<p>which also yields 22. The  <strong>floor</strong> function in the <strong>math</strong> package
is used to return the closest integer value which is less than or equal to the specified expression or value.
Compare the previous result to the usage of <strong>floor</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">floor</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">21.75</span>
<span class="nb">print</span><span class="p">(</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>21
</pre></div>
</div>
</div>
</div>
<p>Alternatively, we can define ourselves the number of integration(mesh) points. In this case we could have</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">tinitial</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">DeltaT</span> <span class="o">=</span> <span class="p">(</span><span class="n">tfinal</span><span class="o">-</span><span class="n">tinitial</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">DeltaT</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.05
</pre></div>
</div>
</div>
</div>
<p>Since we will set up one-dimensional arrays that contain the values of
various variables like time, position, velocity, acceleration etc, we
need to know the value of <span class="math notranslate nohighlight">\(n\)</span>, the number of data points (or
integration or mesh points).  With <span class="math notranslate nohighlight">\(n\)</span> we can initialize a given array
by setting all elelements to zero, as done here</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># define array a</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
</pre></div>
</div>
</div>
</div>
<p>In the code here we implement this simple Eurler scheme choosing a value for <span class="math notranslate nohighlight">\(D=0.0245\)</span> m/s.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Where to save the figures and data files</span>
<span class="n">PROJECT_ROOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
<span class="n">FIGURE_ID</span> <span class="o">=</span> <span class="s2">&quot;Results/FigureFiles&quot;</span>
<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s2">&quot;DataFiles/&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">,</span> <span class="n">fig_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_path</span><span class="p">(</span><span class="n">dat_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">,</span> <span class="n">dat_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>


<span class="n">g</span> <span class="o">=</span> <span class="mf">9.80655</span> <span class="c1">#m/s^2</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">0.00245</span> <span class="c1">#m/s</span>
<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># define scaling constant vT</span>
<span class="n">vT</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">g</span><span class="o">/</span><span class="n">D</span><span class="p">)</span>
<span class="c1"># set up arrays for t, a, v, and y and we can compare our results with analytical ones</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">yanalytic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Initial conditions</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1">#m/s</span>
<span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1">#m</span>
<span class="n">yanalytic</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># Start integrating using Euler&#39;s method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># expression for acceleration</span>
    <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">g</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="c1"># update velocity and position</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="c1"># update time to next time step and compute analytical answer</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
    <span class="n">yanalytic</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">vT</span><span class="o">*</span><span class="n">vT</span><span class="o">/</span><span class="n">g</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">cosh</span><span class="p">(</span><span class="n">g</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">vT</span><span class="p">))</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">):</span>
        <span class="k">break</span>
<span class="n">a</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">g</span> <span class="o">+</span> <span class="n">D</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;t[s]&#39;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span>
        <span class="s1">&#39;y[m]&#39;</span><span class="p">:</span> <span class="n">y</span><span class="o">-</span><span class="n">yanalytic</span><span class="p">,</span>
        <span class="s1">&#39;v[m/s]&#39;</span><span class="p">:</span> <span class="n">v</span><span class="p">,</span>
        <span class="s1">&#39;a[m/s^2]&#39;</span><span class="p">:</span> <span class="n">a</span>
        <span class="p">}</span>
<span class="n">NewData</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">NewData</span><span class="p">)</span>
<span class="c1">#finally we plot the data</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">yanalytic</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tfinal</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y and exact&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;v[m/s]&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time[s]&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;a[m/s^2]&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;EulerIntegration&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>t[s]</th>
      <th>y[m]</th>
      <th>v[m/s]</th>
      <th>a[m/s^2]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>-9.806550</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.1</td>
      <td>0.049031</td>
      <td>-0.980655</td>
      <td>-9.804194</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.2</td>
      <td>0.098034</td>
      <td>-1.961074</td>
      <td>-9.797128</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.3</td>
      <td>0.146963</td>
      <td>-2.940787</td>
      <td>-9.785362</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.4</td>
      <td>0.195770</td>
      <td>-3.919323</td>
      <td>-9.768915</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="_images/chapter3_111_1.png" src="_images/chapter3_111_1.png" />
</div>
</div>
<p>Try different values for <span class="math notranslate nohighlight">\(\Delta t\)</span> and study the difference between the exact solution and the numerical solution.</p>
</div>
<div class="section" id="simple-extension-the-euler-cromer-method">
<h3><span class="section-number">3.5.2. </span>Simple extension, the Euler-Cromer method<a class="headerlink" href="#simple-extension-the-euler-cromer-method" title="Permalink to this headline">¶</a></h3>
<p>The Euler-Cromer method is a simple variant of the standard Euler
method. We use the newly updated velocity <span class="math notranslate nohighlight">\(v_{i+1}\)</span> as an input to the
new position, that is, instead of</p>
<div class="math notranslate nohighlight">
\[
y_{i+1} = y_i+\Delta t v_i,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
v_{i+1} = v_i+\Delta t a_i,
\]</div>
<p>we use now the newly calculate for <span class="math notranslate nohighlight">\(v_{i+1}\)</span> as input to <span class="math notranslate nohighlight">\(y_{i+1}\)</span>, that is
we compute first</p>
<div class="math notranslate nohighlight">
\[
v_{i+1} = v_i+\Delta t a_i,
\]</div>
<p>and then</p>
<div class="math notranslate nohighlight">
\[
y_{i+1} = y_i+\Delta t v_{i+1},
\]</div>
<p>Implementing the Euler-Cromer method yields a simple change to the previous code. We only need to change the following line in the loop over time
steps</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># more codes in between here</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1"># more code</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="air-resistance-in-one-dimension">
<h2><span class="section-number">3.6. </span>Air Resistance in One Dimension<a class="headerlink" href="#air-resistance-in-one-dimension" title="Permalink to this headline">¶</a></h2>
<p>Here we look at both a quadratic in velocity resistance
and linear in velocity.  But first we give a qualitative argument
about the mathematical expression for the air resistance we used last
Friday.</p>
<p>Air resistance tends to scale as the square of the velocity. This is
in contrast to many problems chosen for textbooks, where it is linear
in the velocity. The choice of a linear dependence is motivated by
mathematical simplicity (it keeps the differential equation linear)
rather than by physics. One can see that the force should be quadratic
in velocity by considering the momentum imparted on the air
molecules. If an object sweeps through a volume <span class="math notranslate nohighlight">\(dV\)</span> of air in time
<span class="math notranslate nohighlight">\(dt\)</span>, the momentum imparted on the air is</p>
<!-- Equation labels as ordinary links -->
<div id="_auto1"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
dP=\rho_m dV v,
\label{_auto1} \tag{1}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(v\)</span> is the velocity of the object and <span class="math notranslate nohighlight">\(\rho_m\)</span> is the mass
density of the air. If the molecules bounce back as opposed to stop
you would double the size of the term. The opposite value of the
momentum is imparted onto the object itself. Geometrically, the
differential volume is</p>
<!-- Equation labels as ordinary links -->
<div id="_auto2"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
dV=Avdt,
\label{_auto2} \tag{2}
\end{equation}
\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is the cross-sectional area and <span class="math notranslate nohighlight">\(vdt\)</span> is the distance the
object moved in time <span class="math notranslate nohighlight">\(dt\)</span>.</p>
<p>Plugging this into the expression above,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto3"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{dP}{dt}=-\rho_m A v^2.
\label{_auto3} \tag{3}
\end{equation}
\]</div>
<p>This is the force felt by the particle, and is opposite to its
direction of motion. Now, because air doesn’t stop when it hits an
object, but flows around the best it can, the actual force is reduced
by a dimensionless factor <span class="math notranslate nohighlight">\(c_W\)</span>, called the drag coefficient.</p>
<!-- Equation labels as ordinary links -->
<div id="_auto4"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
F_{\rm drag}=-c_W\rho_m Av^2,
\label{_auto4} \tag{4}
\end{equation}
\]</div>
<p>and the acceleration is</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
\frac{dv}{dt}=-\frac{c_W\rho_mA}{m}v^2.
\end{eqnarray}
\]</div>
<p>For a particle with initial velocity <span class="math notranslate nohighlight">\(v_0\)</span>, one can separate the <span class="math notranslate nohighlight">\(dt\)</span>
to one side of the equation, and move everything with <span class="math notranslate nohighlight">\(v\)</span>s to the
other side. We did this in our discussion of simple motion and will not repeat it here.</p>
<p>On more general terms,
for many systems, e.g. an automobile, there are multiple sources of
resistance. In addition to wind resistance, where the force is
proportional to <span class="math notranslate nohighlight">\(v^2\)</span>, there are dissipative effects of the tires on
the pavement, and in the axel and drive train. These other forces can
have components that scale proportional to <span class="math notranslate nohighlight">\(v\)</span>, and components that
are independent of <span class="math notranslate nohighlight">\(v\)</span>. Those independent of <span class="math notranslate nohighlight">\(v\)</span>, e.g. the usual
<span class="math notranslate nohighlight">\(f=\mu_K N\)</span> frictional force you consider in your first Physics courses, only set in
once the object is actually moving. As speeds become higher, the <span class="math notranslate nohighlight">\(v^2\)</span>
components begin to dominate relative to the others. For automobiles
at freeway speeds, the <span class="math notranslate nohighlight">\(v^2\)</span> terms are largely responsible for the
loss of efficiency. To travel a distance <span class="math notranslate nohighlight">\(L\)</span> at fixed speed <span class="math notranslate nohighlight">\(v\)</span>, the
energy/work required to overcome the dissipative forces are <span class="math notranslate nohighlight">\(fL\)</span>,
which for a force of the form <span class="math notranslate nohighlight">\(f=\alpha v^n\)</span> becomes</p>
<div class="math notranslate nohighlight">
\[
\begin{eqnarray}
W=\int dx~f=\alpha v^n L.
\end{eqnarray}
\]</div>
<p>For <span class="math notranslate nohighlight">\(n=0\)</span> the work is
independent of speed, but for the wind resistance, where <span class="math notranslate nohighlight">\(n=2\)</span>,
slowing down is essential if one wishes to reduce fuel consumption. It
is also important to consider that engines are designed to be most
efficient at a chosen range of power output. Thus, some cars will get
better mileage at higher speeds (They perform better at 50 mph than at
5 mph) despite the considerations mentioned above.</p>
<p>As an example of Newton’s Laws we consider projectile motion (or a
falling raindrop or a ball we throw up in the air) with a drag force. Even though air resistance is
largely proportional to the square of the velocity, we will consider
the drag force to be linear to the velocity, <span class="math notranslate nohighlight">\(\boldsymbol{F}=-m\gamma\boldsymbol{v}\)</span>,
for the purposes of this exercise.</p>
<p>Such a dependence can be extracted from experimental data for objects moving at low velocities, see for example Malthe-Sørenssen chapter 5.6.</p>
<p>We will here focus on a two-dimensional problem.</p>
<p>The acceleration for a projectile moving upwards,
<span class="math notranslate nohighlight">\(\boldsymbol{a}=\boldsymbol{F}/m\)</span>, becomes</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\frac{dv_x}{dt}=-\gamma v_x,\\
\nonumber
\frac{dv_y}{dt}=-\gamma v_y-g,
\end{eqnarray}
\end{split}\]</div>
<p>and <span class="math notranslate nohighlight">\(\gamma\)</span> has dimensions of inverse time.</p>
<p>If you on the other hand have a falling raindrop, how do these equations change? See for example Figure 2.1 in Taylor.
Let us stay with a ball which is thrown up in the air at <span class="math notranslate nohighlight">\(t=0\)</span>.</p>
</div>
<div class="section" id="ways-of-solving-these-equations">
<h2><span class="section-number">3.7. </span>Ways of solving these equations<a class="headerlink" href="#ways-of-solving-these-equations" title="Permalink to this headline">¶</a></h2>
<p>We will go over two different ways to solve this equation. The first
by direct integration, and the second as a differential equation. To
do this by direct integration, one simply multiplies both sides of the
equations above by <span class="math notranslate nohighlight">\(dt\)</span>, then divide by the appropriate factors so
that the <span class="math notranslate nohighlight">\(v\)</span>s are all on one side of the equation and the <span class="math notranslate nohighlight">\(dt\)</span> is on
the other. For the <span class="math notranslate nohighlight">\(x\)</span> motion one finds an easily integrable equation,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\frac{dv_x}{v_x}&amp;=&amp;-\gamma dt,\\
\nonumber
\int_{v_{0x}}^{v_{x}}\frac{dv_x}{v_x}&amp;=&amp;-\gamma\int_0^{t}dt,\\
\nonumber
\ln\left(\frac{v_{x}}{v_{0x}}\right)&amp;=&amp;-\gamma t,\\
\nonumber
v_{x}(t)&amp;=&amp;v_{0x}e^{-\gamma t}.
\end{eqnarray}
\end{split}\]</div>
<p>This is very much the result you would have written down
by inspection. For the <span class="math notranslate nohighlight">\(y\)</span>-component of the velocity,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\frac{dv_y}{v_y+g/\gamma}&amp;=&amp;-\gamma dt\\
\nonumber
\ln\left(\frac{v_{y}+g/\gamma}{v_{0y}-g/\gamma}\right)&amp;=&amp;-\gamma t_f,\\
\nonumber
v_{fy}&amp;=&amp;-\frac{g}{\gamma}+\left(v_{0y}+\frac{g}{\gamma}\right)e^{-\gamma t}.
\end{eqnarray}
\end{split}\]</div>
<p>Whereas <span class="math notranslate nohighlight">\(v_x\)</span> starts at some value and decays
exponentially to zero, <span class="math notranslate nohighlight">\(v_y\)</span> decays exponentially to the terminal
velocity, <span class="math notranslate nohighlight">\(v_t=-g/\gamma\)</span>.</p>
<p>Although this direct integration is simpler than the method we invoke
below, the method below will come in useful for some slightly more
difficult differential equations in the future. The differential
equation for <span class="math notranslate nohighlight">\(v_x\)</span> is straight-forward to solve. Because it is first
order there is one arbitrary constant, <span class="math notranslate nohighlight">\(A\)</span>, and by inspection the
solution is</p>
<!-- Equation labels as ordinary links -->
<div id="_auto5"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v_x=Ae^{-\gamma t}.
\label{_auto5} \tag{5}
\end{equation}
\]</div>
<p>The arbitrary constants for equations of motion are usually determined
by the initial conditions, or more generally boundary conditions. By
inspection <span class="math notranslate nohighlight">\(A=v_{0x}\)</span>, the initial <span class="math notranslate nohighlight">\(x\)</span> component of the velocity.</p>
</div>
<div class="section" id="differential-equations-contn">
<h2><span class="section-number">3.8. </span>Differential Equations, contn<a class="headerlink" href="#differential-equations-contn" title="Permalink to this headline">¶</a></h2>
<p>The differential equation for <span class="math notranslate nohighlight">\(v_y\)</span> is a bit more complicated due to
the presence of <span class="math notranslate nohighlight">\(g\)</span>. Differential equations where all the terms are
linearly proportional to a function, in this case <span class="math notranslate nohighlight">\(v_y\)</span>, or to
derivatives of the function, e.g., <span class="math notranslate nohighlight">\(v_y\)</span>, <span class="math notranslate nohighlight">\(dv_y/dt\)</span>,
<span class="math notranslate nohighlight">\(d^2v_y/dt^2\cdots\)</span>, are called linear differential equations. If
there are terms proportional to <span class="math notranslate nohighlight">\(v^2\)</span>, as would happen if the drag
force were proportional to the square of the velocity, the
differential equation is not longer linear. Because this expression
has only one derivative in <span class="math notranslate nohighlight">\(v\)</span> it is a first-order linear differential
equation. If a term were added proportional to <span class="math notranslate nohighlight">\(d^2v/dt^2\)</span> it would be
a second-order differential equation.  In this case we have a term
completely independent of <span class="math notranslate nohighlight">\(v\)</span>, the gravitational acceleration <span class="math notranslate nohighlight">\(g\)</span>, and
the usual strategy is to first rewrite the equation with all the
linear terms on one side of the equal sign,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto6"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{dv_y}{dt}+\gamma v_y=-g.
\label{_auto6} \tag{6}
\end{equation}
\]</div>
<p>Now, the solution to the equation can be broken into two
parts. Because this is a first-order differential equation we know
that there will be one arbitrary constant. Physically, the arbitrary
constant will be determined by setting the initial velocity, though it
could be determined by setting the velocity at any given time. Like
most differential equations, solutions are not “solved”. Instead,
one guesses at a form, then shows the guess is correct. For these
types of equations, one first tries to find a single solution,
i.e. one with no arbitrary constants. This is called the {\it
particular} solution, <span class="math notranslate nohighlight">\(y_p(t)\)</span>, though it should really be called
“a” particular solution because there are an infinite number of such
solutions. One then finds a solution to the {\it homogenous} equation,
which is the equation with zero on the right-hand side,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto7"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{dv_{y,h}}{dt}+\gamma v_{y,h}=0.
\label{_auto7} \tag{7}
\end{equation}
\]</div>
<p>Homogenous solutions will have arbitrary constants.</p>
<p>The particular solution will solve the same equation as the original
general equation</p>
<!-- Equation labels as ordinary links -->
<div id="_auto8"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\frac{dv_{y,p}}{dt}+\gamma v_{y,p}=-g.
\label{_auto8} \tag{8}
\end{equation}
\]</div>
<p>However, we don’t need find one with arbitrary constants. Hence, it is
called a <strong>particular</strong> solution.</p>
<p>The sum of the two,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto9"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v_y=v_{y,p}+v_{y,h},
\label{_auto9} \tag{9}
\end{equation}
\]</div>
<p>is a solution of the total equation because of the linear nature of
the differential equation. One has now found a <em>general</em> solution
encompassing all solutions, because it both satisfies the general
equation (like the particular solution), and has an arbitrary constant
that can be adjusted to fit any initial condition (like the homogeneous
solution). If the equations were not linear, that is if there were terms
such as <span class="math notranslate nohighlight">\(v_y^2\)</span> or <span class="math notranslate nohighlight">\(v_y\dot{v}_y\)</span>, this technique would not work.</p>
<p>Returning to the example above, the homogenous solution is the same as
that for <span class="math notranslate nohighlight">\(v_x\)</span>, because there was no gravitational acceleration in
that case,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto10"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v_{y,h}=Be^{-\gamma t}.
\label{_auto10} \tag{10}
\end{equation}
\]</div>
<p>In this case a particular solution is one with constant velocity,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto11"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v_{y,p}=-g/\gamma.
\label{_auto11} \tag{11}
\end{equation}
\]</div>
<p>Note that this is the terminal velocity of a particle falling from a
great height. The general solution is thus,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto12"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v_y=Be^{-\gamma t}-g/\gamma,
\label{_auto12} \tag{12}
\end{equation}
\]</div>
<p>and one can find <span class="math notranslate nohighlight">\(B\)</span> from the initial velocity,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto13"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v_{0y}=B-g/\gamma,~~~B=v_{0y}+g/\gamma.
\label{_auto13} \tag{13}
\end{equation}
\]</div>
<p>Plugging in the expression for <span class="math notranslate nohighlight">\(B\)</span> gives the <span class="math notranslate nohighlight">\(y\)</span> motion given the initial velocity,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto14"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
v_y=(v_{0y}+g/\gamma)e^{-\gamma t}-g/\gamma.
\label{_auto14} \tag{14}
\end{equation}
\]</div>
<p>It is easy to see that this solution has <span class="math notranslate nohighlight">\(v_y=v_{0y}\)</span> when <span class="math notranslate nohighlight">\(t=0\)</span> and
<span class="math notranslate nohighlight">\(v_y=-g/\gamma\)</span> when <span class="math notranslate nohighlight">\(t\rightarrow\infty\)</span>.</p>
<p>One can also integrate the two equations to find the coordinates <span class="math notranslate nohighlight">\(x\)</span>
and <span class="math notranslate nohighlight">\(y\)</span> as functions of <span class="math notranslate nohighlight">\(t\)</span>,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
x&amp;=&amp;\int_0^t dt'~v_{0x}(t')=\frac{v_{0x}}{\gamma}\left(1-e^{-\gamma t}\right),\\
\nonumber
y&amp;=&amp;\int_0^t dt'~v_{0y}(t')=-\frac{gt}{\gamma}+\frac{v_{0y}+g/\gamma}{\gamma}\left(1-e^{-\gamma t}\right).
\end{eqnarray}
\end{split}\]</div>
<p>If the question was to find the position at a time <span class="math notranslate nohighlight">\(t\)</span>, we would be
finished. However, the more common goal in a projectile equation
problem is to find the range, i.e. the distance <span class="math notranslate nohighlight">\(x\)</span> at which <span class="math notranslate nohighlight">\(y\)</span>
returns to zero. For the case without a drag force this was much
simpler. The solution for the <span class="math notranslate nohighlight">\(y\)</span> coordinate would have been
<span class="math notranslate nohighlight">\(y=v_{0y}t-gt^2/2\)</span>. One would solve for <span class="math notranslate nohighlight">\(t\)</span> to make <span class="math notranslate nohighlight">\(y=0\)</span>, which would
be <span class="math notranslate nohighlight">\(t=2v_{0y}/g\)</span>, then plug that value for <span class="math notranslate nohighlight">\(t\)</span> into <span class="math notranslate nohighlight">\(x=v_{0x}t\)</span> to
find <span class="math notranslate nohighlight">\(x=2v_{0x}v_{0y}/g=v_0\sin(2\theta_0)/g\)</span>. One follows the same
steps here, except that the expression for <span class="math notranslate nohighlight">\(y(t)\)</span> is more
complicated. Searching for the time where <span class="math notranslate nohighlight">\(y=0\)</span>, and we get</p>
<!-- Equation labels as ordinary links -->
<div id="_auto15"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
0=-\frac{gt}{\gamma}+\frac{v_{0y}+g/\gamma}{\gamma}\left(1-e^{-\gamma t}\right).
\label{_auto15} \tag{15}
\end{equation}
\]</div>
<p>This cannot be inverted into a simple expression <span class="math notranslate nohighlight">\(t=\cdots\)</span>. Such
expressions are known as “transcendental equations”, and are not the
rare instance, but are the norm. In the days before computers, one
might plot the right-hand side of the above graphically as
a function of time, then find the point where it crosses zero.</p>
<p>Now, the most common way to solve for an equation of the above type
would be to apply Newton’s method numerically. This involves the
following algorithm for finding solutions of some equation <span class="math notranslate nohighlight">\(F(t)=0\)</span>.</p>
<ol class="simple">
<li><p>First guess a value for the time, <span class="math notranslate nohighlight">\(t_{\rm guess}\)</span>.</p></li>
<li><p>Calculate <span class="math notranslate nohighlight">\(F\)</span> and its derivative, <span class="math notranslate nohighlight">\(F(t_{\rm guess})\)</span> and <span class="math notranslate nohighlight">\(F'(t_{\rm guess})\)</span>.</p></li>
<li><p>Unless you guessed perfectly, <span class="math notranslate nohighlight">\(F\ne 0\)</span>, and assuming that <span class="math notranslate nohighlight">\(\Delta F\approx F'\Delta t\)</span>, one would choose</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta t=-F(t_{\rm guess})/F'(t_{\rm guess})\)</span>.</p></li>
<li><p>Now repeat step 1, but with <span class="math notranslate nohighlight">\(t_{\rm guess}\rightarrow t_{\rm guess}+\Delta t\)</span>.</p></li>
</ol>
<p>If the <span class="math notranslate nohighlight">\(F(t)\)</span> were perfectly linear in <span class="math notranslate nohighlight">\(t\)</span>, one would find <span class="math notranslate nohighlight">\(t\)</span> in one
step. Instead, one typically finds a value of <span class="math notranslate nohighlight">\(t\)</span> that is closer to
the final answer than <span class="math notranslate nohighlight">\(t_{\rm guess}\)</span>. One breaks the loop once one
finds <span class="math notranslate nohighlight">\(F\)</span> within some acceptable tolerance of zero. A program to do
this will be added shortly.</p>
</div>
<div class="section" id="motion-in-a-magnetic-field">
<h2><span class="section-number">3.9. </span>Motion in a Magnetic Field<a class="headerlink" href="#motion-in-a-magnetic-field" title="Permalink to this headline">¶</a></h2>
<p>Another example of a velocity-dependent force is magnetism,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\boldsymbol{F}&amp;=&amp;q\boldsymbol{v}\times\boldsymbol{B},\\
\nonumber
F_i&amp;=&amp;q\sum_{jk}\epsilon_{ijk}v_jB_k.
\end{eqnarray}
\end{split}\]</div>
<p>For a uniform field in the <span class="math notranslate nohighlight">\(z\)</span> direction <span class="math notranslate nohighlight">\(\boldsymbol{B}=B\hat{z}\)</span>, the force can only have <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> components,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
F_x&amp;=&amp;qBv_y\\
\nonumber
F_y&amp;=&amp;-qBv_x.
\end{eqnarray}
\end{split}\]</div>
<p>The differential equations are</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\dot{v}_x&amp;=&amp;\omega_c v_y,\omega_c= qB/m\\
\nonumber
\dot{v}_y&amp;=&amp;-\omega_c v_x.
\end{eqnarray}
\end{split}\]</div>
<p>One can solve the equations by taking time derivatives of either equation, then substituting into the other equation,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
\ddot{v}_x=\omega_c\dot{v_y}=-\omega_c^2v_x,\\
\nonumber
\ddot{v}_y&amp;=&amp;-\omega_c\dot{v}_x=-\omega_cv_y.
\end{eqnarray}
\end{split}\]</div>
<p>The solution to these equations can be seen by inspection,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
v_x&amp;=&amp;A\sin(\omega_ct+\phi),\\
\nonumber
v_y&amp;=&amp;A\cos(\omega_ct+\phi).
\end{eqnarray}
\end{split}\]</div>
<p>One can integrate the equations to find the positions as a function of time,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{eqnarray}
x-x_0&amp;=&amp;\int_{x_0}^x dx=\int_0^t dt v(t)\\
\nonumber
&amp;=&amp;\frac{-A}{\omega_c}\cos(\omega_ct+\phi),\\
\nonumber
y-y_0&amp;=&amp;\frac{A}{\omega_c}\sin(\omega_ct+\phi).
\end{eqnarray}
\end{split}\]</div>
<p>The trajectory is a circle centered at <span class="math notranslate nohighlight">\(x_0,y_0\)</span> with amplitude <span class="math notranslate nohighlight">\(A\)</span> rotating in the clockwise direction.</p>
<p>The equations of motion for the <span class="math notranslate nohighlight">\(z\)</span> motion are</p>
<!-- Equation labels as ordinary links -->
<div id="_auto16"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
\dot{v_z}=0,
\label{_auto16} \tag{16}
\end{equation}
\]</div>
<p>which leads to</p>
<!-- Equation labels as ordinary links -->
<div id="_auto17"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
z-z_0=V_zt.
\label{_auto17} \tag{17}
\end{equation}
\]</div>
<p>Added onto the circle, the motion is helical.</p>
<p>Note that the kinetic energy,</p>
<!-- Equation labels as ordinary links -->
<div id="_auto18"></div>
<div class="math notranslate nohighlight">
\[
\begin{equation}
T=\frac{1}{2}m(v_x^2+v_y^2+v_z^2)=\frac{1}{2}m(\omega_c^2A^2+V_z^2),
\label{_auto18} \tag{18}
\end{equation}
\]</div>
<p>is constant. This is because the force is perpendicular to the
velocity, so that in any differential time element <span class="math notranslate nohighlight">\(dt\)</span> the work done
on the particle <span class="math notranslate nohighlight">\(\boldsymbol{F}\cdot{dr}=dt\boldsymbol{F}\cdot{v}=0\)</span>.</p>
<p>One should think about the implications of a velocity dependent
force. Suppose one had a constant magnetic field in deep space. If a
particle came through with velocity <span class="math notranslate nohighlight">\(v_0\)</span>, it would undergo cyclotron
motion with radius <span class="math notranslate nohighlight">\(R=v_0/\omega_c\)</span>. However, if it were still its
motion would remain fixed. Now, suppose an observer looked at the
particle in one reference frame where the particle was moving, then
changed their velocity so that the particle’s velocity appeared to be
zero. The motion would change from circular to fixed. Is this
possible?</p>
<p>The solution to the puzzle above relies on understanding
relativity. Imagine that the first observer believes <span class="math notranslate nohighlight">\(\boldsymbol{B}\ne 0\)</span> and
that the electric field <span class="math notranslate nohighlight">\(\boldsymbol{E}=0\)</span>. If the observer then changes
reference frames by accelerating to a velocity <span class="math notranslate nohighlight">\(\boldsymbol{v}\)</span>, in the new
frame <span class="math notranslate nohighlight">\(\boldsymbol{B}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{E}\)</span> both change. If the observer moved to the
frame where the charge, originally moving with a small velocity <span class="math notranslate nohighlight">\(v\)</span>,
is now at rest, the new electric field is indeed <span class="math notranslate nohighlight">\(\boldsymbol{v}\times\boldsymbol{B}\)</span>,
which then leads to the same acceleration as one had before. If the
velocity is not small compared to the speed of light, additional
<span class="math notranslate nohighlight">\(\gamma\)</span> factors come into play,
<span class="math notranslate nohighlight">\(\gamma=1/\sqrt{1-(v/c)^2}\)</span>. Relativistic motion will not be
considered in this course.</p>
</div>
<div class="section" id="summarizing-the-various-motion-problems">
<h2><span class="section-number">3.10. </span>Summarizing the various motion problems<a class="headerlink" href="#summarizing-the-various-motion-problems" title="Permalink to this headline">¶</a></h2>
<p>The examples we have discussed above were included in order to
illustrate various methods (which depend on the specific problem) to
find the solutions of the equations of motion.
We have solved the equations of motion in the following ways:</p>
<p><strong>Solve the differential equations analytically.</strong></p>
<p>We did this for example with the following object in one or two dimensions or the sliding block.
Here we had for example an equation set like</p>
<div class="math notranslate nohighlight">
\[
\frac{dv_x}{dt}=-\gamma v_x,
\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[
\frac{dv_y}{dt}=-\gamma v_y-g,
\]</div>
<p>and <span class="math notranslate nohighlight">\(\gamma\)</span> has dimension of inverse time.</p>
<p>We could also in case we can separate the degrees of freedom integrate. Take for example one of the equations in the previous slide</p>
<div class="math notranslate nohighlight">
\[
\frac{dv_x}{dt}=-\gamma v_x,
\]</div>
<p>which we can rewrite in terms of a left-hand side which depends only on the velocity and a right-hand side which depends only on time</p>
<div class="math notranslate nohighlight">
\[
\frac{dv_x}{v_x}=-\gamma dt.
\]</div>
<p>Integrating we have (since we can separate <span class="math notranslate nohighlight">\(v_x\)</span> and <span class="math notranslate nohighlight">\(t\)</span>)</p>
<div class="math notranslate nohighlight">
\[
\int_{v_0}^{v_t}\frac{dv_x}{v_x}=-\int_{t_0}^{t_f}\gamma dt,
\]</div>
<p>where <span class="math notranslate nohighlight">\(v_f\)</span> is the velocity at a final time and <span class="math notranslate nohighlight">\(t_f\)</span> is the final time.
In this case we found, after having integrated the above two sides that</p>
<div class="math notranslate nohighlight">
\[
v_f(t)=v_0\exp{-\gamma t}.
\]</div>
<p>Finally, using for example Euler’s method, we can solve the
differential equations numerically. If we can compare our numerical
solutions with analytical solutions, we have an extra check of our
numerical approaches.</p>
</div>
<div class="section" id="exercises">
<h2><span class="section-number">3.11. </span>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<div class="section" id="electron-moving-into-an-electric-field">
<h3><span class="section-number">3.11.1. </span>Electron moving into an electric field<a class="headerlink" href="#electron-moving-into-an-electric-field" title="Permalink to this headline">¶</a></h3>
<p>An electron is sent through a varying electrical
field. Initially, the electron is moving in the <span class="math notranslate nohighlight">\(x\)</span>-direction with a velocity
<span class="math notranslate nohighlight">\(v_x = 100\)</span> m/s. The electron enters the field when it passes the origin. The field
varies with time, causing an acceleration of the electron that varies in time</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{a}(t)=\left(−20 \mathrm{m/s}^2 −10\mathrm{m/s}^3t\right) \boldsymbol{e}_y,
\]</div>
<p>or if we replace <span class="math notranslate nohighlight">\(\boldsymbol{e}_y\)</span> with <span class="math notranslate nohighlight">\(\boldsymbol{e}_2\)</span> (the unit vectors in the <span class="math notranslate nohighlight">\(y\)</span>-direction) we have</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{a}(t)=\left(−20 \mathrm{m/s}^2 −10\mathrm{m/s}^3t\right) \boldsymbol{e}_2.
\]</div>
<p>Note that the velocity in the <span class="math notranslate nohighlight">\(x\)</span>-direction is a constant and is not affected by the force which acts only in the <span class="math notranslate nohighlight">\(y\)</span>-direction.
This means that we can decouple the two degrees of freedom and skip the vector symbols.
We have then a constant velocity in the <span class="math notranslate nohighlight">\(x\)</span>-direction</p>
<div class="math notranslate nohighlight">
\[
v_x(t) = 100\mathrm{m/s},
\]</div>
<p>and integrating up the acceleration in the <span class="math notranslate nohighlight">\(y\)</span>-direction (and using that the initial time <span class="math notranslate nohighlight">\(t_0=0\)</span>) we get</p>
<div class="math notranslate nohighlight">
\[
v_y(t) = -20\mathrm{m/s^2}t-5\mathrm{m/s^3}t^2.
\]</div>
<p>Find the position as a function of time for the electron.</p>
<p>We integrate again in the <span class="math notranslate nohighlight">\(x\)</span>-direction</p>
<div class="math notranslate nohighlight">
\[
x(t) = 100\mathrm{m/s}t,
\]</div>
<p>and in the <span class="math notranslate nohighlight">\(y\)</span>-direction (remember that these two degrees of freedom don’t depend on each other)
we get</p>
<div class="math notranslate nohighlight">
\[
y(t) = -10\mathrm{m/s^2}t^2-\frac{5}{3}\mathrm{m/s^3}t^3.
\]</div>
<p>The field is only acting inside a box of length <span class="math notranslate nohighlight">\(L = 2m\)</span>.</p>
<p>How long time is the electron inside the field?</p>
<p>If we use the equation for the <span class="math notranslate nohighlight">\(x\)</span>-direction (the length of the box), we can then use the equation for <span class="math notranslate nohighlight">\(x(t) = 100\mathrm{m/s}t\)</span>
and simply set <span class="math notranslate nohighlight">\(x=2\)</span>m and we find</p>
<div class="math notranslate nohighlight">
\[
t=\frac{1}{50}\mathrm{s}.
\]</div>
<p>What is the displacement in the <span class="math notranslate nohighlight">\(y\)</span>-direction when the electron leaves the box. (We call this the deflection of the electron).</p>
<p>Here we simply use</p>
<div class="math notranslate nohighlight">
\[
y(t) = -10\mathrm{m/s^2}t^2-\frac{5}{3}\mathrm{m/s^3}t^3,
\]</div>
<p>and use <span class="math notranslate nohighlight">\(t=1/50\)</span>s and find that</p>
<div class="math notranslate nohighlight">
\[
y = -0.004013 \mathrm{m}.
\]</div>
<p>Find the angle the velocity vector forms with the horizontal axis as the electron leaves the box.</p>
<p>Again, we use <span class="math notranslate nohighlight">\(t=1/50\)</span>s and calculate the velocities in the <span class="math notranslate nohighlight">\(x\)</span>- and the <span class="math notranslate nohighlight">\(y\)</span>-directions (the velocity in the <span class="math notranslate nohighlight">\(x\)</span>-direction is just a constant) and find the angle using</p>
<div class="math notranslate nohighlight">
\[
\tan{\alpha} = \frac{v_y(t=1/50)}{v_x(t=1/50)},
\]</div>
<p>which leads to</p>
<div class="math notranslate nohighlight">
\[
\alpha = -0.23,
\]</div>
<p>in degrees (not radians).</p>
</div>
<div class="section" id="drag-force">
<h3><span class="section-number">3.11.2. </span>Drag force<a class="headerlink" href="#drag-force" title="Permalink to this headline">¶</a></h3>
<p>Using equations (2.84) and (2.82) in Taylor, we have that <span class="math notranslate nohighlight">\(f_{\mathrm{quad}}/f_{\mathrm{lin}}=(\kappa\rho Av^2)/(3\pi\eta Dv)\)</span>. With <span class="math notranslate nohighlight">\(\kappa =1/4\)</span> and <span class="math notranslate nohighlight">\(A=\pi D^2/4\)</span> we obtain <span class="math notranslate nohighlight">\(f_{\mathrm{quad}}/f_{\mathrm{lin}}=(\rho Dv)/(48\eta)\)</span> or <span class="math notranslate nohighlight">\(R/48\)</span> with <span class="math notranslate nohighlight">\(R\)</span> given by equation (2.83) of Taylor.</p>
<p>With these numbers <span class="math notranslate nohighlight">\(R=1.1\times 10^{-2}\)</span> and it is safe to neglect the quadratic drag.</p>
</div>
<div class="section" id="falling-object">
<h3><span class="section-number">3.11.3. </span>Falling object<a class="headerlink" href="#falling-object" title="Permalink to this headline">¶</a></h3>
<p>If we insert Taylor series for <span class="math notranslate nohighlight">\(\exp{-(t/\tau)}\)</span> into equation (2.33) of Taylor, we have</p>
<div class="math notranslate nohighlight">
\[
v_y(t) = v_{\mathrm{ter}}\left[1-\exp{-(t/\tau)}\right] = v_{\mathrm{ter}}\left[1-(1-\frac{t}{\tau}+\frac{t^2}{2\tau^2}+\dots   )\right].
\]</div>
<p>The first two terms on the right cancel and, if <span class="math notranslate nohighlight">\(t\)</span> is sufficiently small, we can neglect terms with higher powers than two in <span class="math notranslate nohighlight">\(t\)</span>.  This gives us</p>
<div class="math notranslate nohighlight">
\[
v_y(t) \approx v_{\mathrm{ter}}\frac{t}{\tau}=gt,
\]</div>
<p>where we used that <span class="math notranslate nohighlight">\(v_{\mathrm{ter}}=g\tau\)</span> from equation (2.34) in Taylor. This means that for small velocities it is the gravitational force which dominates.</p>
<p>Setting <span class="math notranslate nohighlight">\(v_y(t_0)=0\)</span> in equation (2.35) of Taylor and using the Taylor series for the exponential we find that</p>
<div class="math notranslate nohighlight">
\[
y(t) = v_{\mathrm{ter}}t-v_{\mathrm{ter}}\tau\left[1-\exp{-(t/\tau)}\right] = v_{\mathrm{ter}}t-v_{\mathrm{ter}}\tau\left[1-(1-\frac{t}{\tau}+\frac{t^2}{2\tau^2}+\dots   )\right].
\]</div>
<p>On the rhs the second and third terms cancel, as do the first and fourth. If we neglect all terms beyond <span class="math notranslate nohighlight">\(t^2\)</span>, this leaves us with</p>
<div class="math notranslate nohighlight">
\[
y(t) \approx v_{\mathrm{ter}}\frac{t^2}{2\tau}=\frac{1}{2}gt^2.
\]</div>
<p>Again, for small times, as expected, the gravitational force plays the major role.</p>
</div>
<div class="section" id="motion-of-a-cyclist">
<h3><span class="section-number">3.11.4. </span>Motion of a cyclist<a class="headerlink" href="#motion-of-a-cyclist" title="Permalink to this headline">¶</a></h3>
<p>Putting in the numbers for the characteristic time we find</p>
<div class="math notranslate nohighlight">
\[
\tau = \frac{m}{Dv_0} = \frac{80}{0.20\times 20}=20\mathrm{s}.
\]</div>
<p>From an initial velocity of 20m/s we will slow down to half the initial speed, 10m/s in 20s.  From Taylor equation (2.45) we have then that the time to slow down to any speed <span class="math notranslate nohighlight">\(v\)</span> is</p>
<div class="math notranslate nohighlight">
\[
t = \frac{M}{D}\left(\frac{1}{v}-\frac{1}{v_0}\right).
\]</div>
<p>This gives a time of 6.7s for a velocity of 15m/s, 20s for a velocity of 10m/s and 60s for a velocity of 5m/s.  We see that this approximation leads to an infinite time before we come to rest. To ignore ordinary friction at low speeds is indeed a bad approximation.</p>
</div>
<div class="section" id="falling-ball-and-preparing-for-the-numerical-exercise">
<h3><span class="section-number">3.11.5. </span>Falling ball and preparing for the numerical exercise<a class="headerlink" href="#falling-ball-and-preparing-for-the-numerical-exercise" title="Permalink to this headline">¶</a></h3>
<p>In this example we study the motion of an object subject to a constant force, a velocity dependent
force, and for the numerical part a position-dependent force.
Without the position dependent force, we can solve the problem analytically. This is what we will do in this exercise.
The position dependent force requires numerical efforts (exercise 7).
In addition to the  falling ball case, we will include the effect of the ball bouncing back from the floor in exercises 7.</p>
<p>Here we limit ourselves to a ball that is thrown from a height <span class="math notranslate nohighlight">\(h\)</span>
above the ground with an initial velocity
<span class="math notranslate nohighlight">\(\boldsymbol{v}_0\)</span> at time <span class="math notranslate nohighlight">\(t=t_0\)</span>.
We assume we have only a gravitational force and a force due to the air resistance.
The position of the ball as function of time is  <span class="math notranslate nohighlight">\(\boldsymbol{r}(t)\)</span> where <span class="math notranslate nohighlight">\(t\)</span> is time.
The position is measured with respect to a coordinate system with origin at the floor.</p>
<p>We assume we have an initial position <span class="math notranslate nohighlight">\(\boldsymbol{r}(t_0)=h\boldsymbol{e}_y\)</span> and an initial velocity <span class="math notranslate nohighlight">\(\boldsymbol{v}_0=v_{x,0}\boldsymbol{e}_x+v_{y,0}\boldsymbol{e}_y\)</span>.</p>
<p>In this exercise we assume the system is influenced by the gravitational force</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{G}=-mg\boldsymbol{e}_y
\]</div>
<p>and an air resistance given by a square law</p>
<div class="math notranslate nohighlight">
\[
-Dv\boldsymbol{v}.
\]</div>
<p>The analytical expressions for velocity and position as functions of
time will be used to compare with the numerical results in exercise 6.</p>
<p>Identify the forces acting on the ball and set up a diagram with the forces acting on the ball. Find the acceleration of the falling ball.</p>
<p>The forces acting on the ball are the gravitational force <span class="math notranslate nohighlight">\(\boldsymbol{G}=-mg\boldsymbol{e}_y\)</span> and the air resistance <span class="math notranslate nohighlight">\(\boldsymbol{F}_D=-D\boldsymbol{v}v\)</span> with <span class="math notranslate nohighlight">\(v\)</span> the absolute value of the velocity. The accelaration in the <span class="math notranslate nohighlight">\(x\)</span>-direction is</p>
<div class="math notranslate nohighlight">
\[
a_x = -\frac{Dv_x\vert v\vert}{m},
\]</div>
<p>and in the <span class="math notranslate nohighlight">\(y\)</span>-direction</p>
<div class="math notranslate nohighlight">
\[
a_y = -g-\frac{Dv_y\vert v\vert}{m},
\]</div>
<p>where <span class="math notranslate nohighlight">\(\vert v\vert=\sqrt{v_x^2+v_y^2}\)</span>.  Note that due to the dependence on <span class="math notranslate nohighlight">\(v_x\)</span> and <span class="math notranslate nohighlight">\(v_y\)</span> in each equation, it means we may not be able find an analytical solution. In this case we cannot.
In order to compare our code with analytical results, we will thus study the problem only in the <span class="math notranslate nohighlight">\(y\)</span>-direction.</p>
<p>In the general code below we would write this as (pseudocode style)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>    <span class="n">ax</span> <span class="o">=</span> <span class="o">-</span><span class="n">D</span><span class="o">*</span><span class="n">vx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">m</span>
    <span class="n">ay</span> <span class="o">=</span> <span class="o">-</span><span class="n">g</span> <span class="o">-</span> <span class="n">D</span><span class="o">*</span><span class="n">vy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">m</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">14</span><span class="o">-</span><span class="mi">847092</span><span class="n">aec374</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">ax</span> <span class="o">=</span> <span class="o">-</span><span class="n">D</span><span class="o">*</span><span class="n">vx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">m</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">ay</span> <span class="o">=</span> <span class="o">-</span><span class="n">g</span> <span class="o">-</span> <span class="n">D</span><span class="o">*</span><span class="n">vy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="nb">abs</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="n">m</span>

<span class="ne">NameError</span>: name &#39;vx&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Integrate the acceleration from an initial time <span class="math notranslate nohighlight">\(t_0\)</span> to a final time <span class="math notranslate nohighlight">\(t\)</span> and find the velocity.</p>
<p>We reduce our problem to a one-dimensional in the <span class="math notranslate nohighlight">\(y\)</span>-direction only since for the two-dimensional motion we cannot find an analtical solution. For one dimension however, we have an analytical solution.
We specialize our equations  for the <span class="math notranslate nohighlight">\(y\)</span>-direction only</p>
<div class="math notranslate nohighlight">
\[
\frac{dv_y}{dt}= -g +Dv_y^2(t).
\]</div>
<p>We can solve this using the technique of separation of variables. We
isolate on the left all terms that involve <span class="math notranslate nohighlight">\(v\)</span> and on the right all
terms that involve time. We get then</p>
<div class="math notranslate nohighlight">
\[
\frac{dv_y}{g -Dv_y^2(t) }= -dt,
\]</div>
<p>We scale now the equation to the left by introducing a constant
<span class="math notranslate nohighlight">\(v_T=\sqrt{g/D}\)</span>. This constant has dimension length/time.</p>
<p>Next we integrate the left-hand side (lhs) from <span class="math notranslate nohighlight">\(v_{y0}=0\)</span> m/s to <span class="math notranslate nohighlight">\(v\)</span> and
the right-hand side (rhs) from <span class="math notranslate nohighlight">\(t_0=0\)</span> to <span class="math notranslate nohighlight">\(t\)</span> and obtain</p>
<div class="math notranslate nohighlight">
\[
\int_{0}^{v_y}\frac{dv_y}{g -Dv_y^2(t) }= \frac{v_T}{g}\mathrm{arctanh}(\frac{v_y}{v_T})  =-\int_0^tdt = -t.
\]</div>
<p>We can reorganize these equations as</p>
<div class="math notranslate nohighlight">
\[
v_T\mathrm{arctanh}(\frac{v_y}{v_T})  =-gt,
\]</div>
<p>which gives us <span class="math notranslate nohighlight">\(v_y\)</span> as function of time</p>
<div class="math notranslate nohighlight">
\[
v_y(t)=v_T\tanh{-(\frac{gt}{v_T})}.
\]</div>
<p>With a finite initial velocity we need simply to add <span class="math notranslate nohighlight">\(v_{y0}\)</span>.</p>
<p>Find thereafter the position as function of time starting with an initial time <span class="math notranslate nohighlight">\(t_0\)</span>. Find the time it takes to hit the floor.  Here you will find it convenient to set the initial velocity in the <span class="math notranslate nohighlight">\(y\)</span>-direction to zero.</p>
<p>With the velocity we can then find the height <span class="math notranslate nohighlight">\(y(t)\)</span> by integrating yet another time, that is</p>
<div class="math notranslate nohighlight">
\[
y(t)=y(t_0)+\int_{t_0}^t dt v_y(t)=\int_{0}^t dt[v_T\tanh{-(\frac{gt}{v_T})}].
\]</div>
<p>This integral is a little bit trickier but we can look it up in a table over
known integrals and we get</p>
<div class="math notranslate nohighlight">
\[
y(t)=y(t_0)-\frac{v_T^2}{g}\log{[\cosh{(\frac{gt}{v_T})}]}.
\]</div>
<p>Here we have assumed that we set the initial velocity in the <span class="math notranslate nohighlight">\(y\)</span>-direction to zero, that is <span class="math notranslate nohighlight">\(v_y(t_0)=0\)</span>m/s. Adding a non-zero velocity gives us an additional term of <span class="math notranslate nohighlight">\(v_{y0}t\)</span>.<br />
Using a zero initial velocity and setting</p>
<div class="math notranslate nohighlight">
\[
y(t)=0=y(t_0)-\frac{v_T^2}{g}\log{[\cosh{(-\frac{gt}{v_T})}]}=y(t_0)-\frac{v_T^2}{g}\log{[\cosh{(\frac{gt}{v_T})}]},
\]</div>
<p>(note that <span class="math notranslate nohighlight">\(\cosh\)</span> yields the same values for negative and positive arguments)
allows us to find the final time by solving</p>
<div class="math notranslate nohighlight">
\[
y(t_0)=\frac{v_T^2}{g}\log{[\cosh{(\frac{gt}{v_T})}]},
\]</div>
<p>which gives</p>
<div class="math notranslate nohighlight">
\[
t = \frac{v_T}{g}\mathrm{arccosh}(\exp{(gy_0/v_T^2)}).
\]</div>
<p>In the code below we would code these analytical expressions (with zero initial velocity in the <span class="math notranslate nohighlight">\(y\)</span>-direction) as</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>    <span class="n">yanalytic</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">vT</span><span class="o">*</span><span class="n">vT</span><span class="o">/</span><span class="n">g</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">cosh</span><span class="p">(</span><span class="n">g</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">vT</span><span class="p">))</span><span class="o">+</span><span class="n">vy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>We will use the above analytical results in our numerical calculations in the next exercise</p>
</div>
<div class="section" id="numerical-elements-solving-the-previous-exercise-numerically-and-adding-the-bouncing-from-the-floor">
<h3><span class="section-number">3.11.6. </span>Numerical elements, solving the previous exercise  numerically and adding the bouncing from the floor<a class="headerlink" href="#numerical-elements-solving-the-previous-exercise-numerically-and-adding-the-bouncing-from-the-floor" title="Permalink to this headline">¶</a></h3>
<p>Here we will:</p>
<ol class="simple">
<li><p>Learn and utilize Euler’s Method to find the position and the velocity</p></li>
<li><p>Compare analytical and computational solutions</p></li>
<li><p>Add additional forces to our model</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># let&#39;s start by importing useful packages we are familiar with</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<p>We will choose the following values</p>
<ol class="simple">
<li><p>mass <span class="math notranslate nohighlight">\(m=0,2\)</span> kg</p></li>
<li><p>accelleration (gravity) <span class="math notranslate nohighlight">\(g=9.81\)</span> m/s<span class="math notranslate nohighlight">\(^{2}\)</span>.</p></li>
<li><p>initial position is the height <span class="math notranslate nohighlight">\(h=2\)</span> m</p></li>
<li><p>initial velocities <span class="math notranslate nohighlight">\(v_{x,0}=v_{y,0}=10\)</span> m/s</p></li>
</ol>
<p>Can you find a reasonable value for the drag coefficient <span class="math notranslate nohighlight">\(D\)</span>?
You need also to define an initial time and
the step size <span class="math notranslate nohighlight">\(\Delta t\)</span>. We can define the step size <span class="math notranslate nohighlight">\(\Delta t\)</span> as the difference between any
two neighboring values in time (time steps) that we analyze within
some range. It can be determined by dividing the interval we are
analyzing, which in our case is time <span class="math notranslate nohighlight">\(t_{\mathrm{final}}-t_0\)</span>, by the number of steps we
are taking <span class="math notranslate nohighlight">\((N)\)</span>. This gives us a step size <span class="math notranslate nohighlight">\(\Delta t = \dfrac{t_{\mathrm{final}}-t_0}{N}\)</span>.</p>
<p>With these preliminaries we are now ready to plot our results from exercise 5.</p>
<p>Set up arrays for time, velocity, acceleration and positions for the results from exercise 5. Define an initial and final time. Choose the final time to be the time when the ball hits the ground for the first time. Make a plot of the position and velocity as functions of time.  Here you could set the initial velocity in the <span class="math notranslate nohighlight">\(y\)</span>-direction to zero and use the result from exercise 5. Else you need to try different initial times using the result from exercise 5 as a starting guess.  It is not critical if you don’t reach the ground when the initial velocity in the <span class="math notranslate nohighlight">\(y\)</span>-direction is not zero.</p>
<p>We move now to the numerical solution of the differential equations as discussed in the <a class="reference external" href="https://mhjensen.github.io/Physics321/doc/pub/motion/html/motion.html">lecture notes</a> or Malthe-Sørenssen chapter 7.5.
Let us remind ourselves about  Euler’s Method.</p>
<p>Suppose we know <span class="math notranslate nohighlight">\(f(t)\)</span> and its derivative <span class="math notranslate nohighlight">\(f'(t)\)</span>. To find <span class="math notranslate nohighlight">\(f(t+\Delta t)\)</span> at the next step, <span class="math notranslate nohighlight">\(t+\Delta t\)</span>,
we can consider the Taylor expansion:</p>
<p><span class="math notranslate nohighlight">\(f(t+\Delta t) = f(t) + \dfrac{(\Delta t)f'(t)}{1!} + \dfrac{(\Delta t)^2f''(t)}{2!} + ...\)</span></p>
<p>If we ignore the <span class="math notranslate nohighlight">\(f''\)</span> term and higher derivatives, we obtain</p>
<p><span class="math notranslate nohighlight">\(f(t+\Delta t) \approx f(t) + (\Delta t)f'(t)\)</span>.</p>
<p>This approximation is the basis of Euler’s method, and the Taylor
expansion suggests that it will have errors of <span class="math notranslate nohighlight">\(O(\Delta t^2)\)</span>.  Thus, one
would expect it to work better, the smaller the step size <span class="math notranslate nohighlight">\(h\)</span> that you
use. In our case the step size is <span class="math notranslate nohighlight">\(\Delta t\)</span>.</p>
<p>In setting up our code we need to</p>
<ol class="simple">
<li><p>Define and obtain all initial values, constants, and time to be analyzed with step sizes as done above (you can use the same values)</p></li>
<li><p>Calculate the velocity using <span class="math notranslate nohighlight">\(v_{i+1} = v_{i} + (\Delta t)*a_{i}\)</span></p></li>
<li><p>Calculate the position using <span class="math notranslate nohighlight">\(pos_{i+1} = r_{i} + (\Delta t)*v_{i}\)</span></p></li>
<li><p>Calculate the new acceleration <span class="math notranslate nohighlight">\(a_{i+1}\)</span>.</p></li>
<li><p>Repeat steps 2-4 for all time steps within a loop.</p></li>
</ol>
<p>Write a code which implements Euler’s method and compute numerically and plot the position and velocity as functions of time for various values of <span class="math notranslate nohighlight">\(\Delta t\)</span>. Comment your results.</p>
<p>Below you will find two codes, one which uses explicit expressions for the <span class="math notranslate nohighlight">\(x\)</span>- and <span class="math notranslate nohighlight">\(y\)</span>-directions and one which rewrites the expressions as compact vectors, as done in homework 2. Running the codes shows a sensitivity to the chosen step size <span class="math notranslate nohighlight">\(\Delta t\)</span>. You will clearly notice that when comparing with the analytical results, that larger values of the step size in time result in a poorer agreement with the analytical solutions.</p>
<ul class="simple">
<li><p>Compare your numerically obtained positions and velocities with the analytical results from exercise 5. Comment again your results.</p></li>
</ul>
<p>The codes follow here. Running them allows you to probe the various parameters and compare with analytical solutions as well.</p>
<p>The analytical results are discussed in the lecture notes, see the slides of the week of January 25-29 <a class="reference external" href="https://mhjensen.github.io/Physics321/doc/pub/week4/html/week4-bs.html">https://mhjensen.github.io/Physics321/doc/pub/week4/html/week4-bs.html</a>.</p>
<p>The codes here show two different ways of solving the two-dimensional problem. The first one defines arrays for the <span class="math notranslate nohighlight">\(x\)</span>- and <span class="math notranslate nohighlight">\(y\)</span>-directions explicitely, while the second code uses a more
compact (and thus closer to the mathmeatics) notation with a full two-dimensional vector.</p>
<p>The initial conditions for the first example are set so that we only an object falling in the <span class="math notranslate nohighlight">\(y\)</span>-direction. Then it makes sense to compare with the analytical solution. If you change the initial conditions, this comparison is no longer correct.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exercise 6, hw3, brute force way with declaration of vx, vy, x and y</span>
<span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Where to save the figures and data files</span>
<span class="n">PROJECT_ROOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
<span class="n">FIGURE_ID</span> <span class="o">=</span> <span class="s2">&quot;Results/FigureFiles&quot;</span>
<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s2">&quot;DataFiles/&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">,</span> <span class="n">fig_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_path</span><span class="p">(</span><span class="n">dat_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">,</span> <span class="n">dat_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>

<span class="c1"># Output file</span>
<span class="n">outfile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">data_path</span><span class="p">(</span><span class="s2">&quot;Eulerresults.dat&quot;</span><span class="p">),</span><span class="s1">&#39;w&#39;</span><span class="p">)</span>

<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">plt</span><span class="p">,</span> <span class="n">mpl</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn&#39;</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;serif&#39;</span>


<span class="n">g</span> <span class="o">=</span> <span class="mf">9.80655</span> <span class="c1">#m/s^2</span>
<span class="c1"># The mass and the drag constant D</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">0.00245</span> <span class="c1">#mass/length   kg/m</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1">#kg, mass of falling object</span>
<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">1.4</span>
<span class="c1"># set up number of points for all variables</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># define scaling constant vT used in analytical solution</span>
<span class="n">vT</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">g</span><span class="o">/</span><span class="n">D</span><span class="p">)</span>
<span class="c1"># set up arrays for t, a, v, and y and arrays for analytical results</span>
<span class="c1">#brute force setting up of arrays for x and y, vx, vy, ax and ay</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">vy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">vx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">yanalytic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="c1"># Initial conditions, note that these correspond to an object falling in the y-direction only.</span>
<span class="n">vx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#m/s</span>
<span class="n">vy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>  <span class="c1">#m/s</span>
<span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.0</span> <span class="c1">#m</span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span> <span class="c1">#m</span>
<span class="n">yanalytic</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="c1"># Start integrating using Euler&#39;s method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># expression for acceleration, note the absolute value and division by mass</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="o">-</span><span class="n">D</span><span class="o">*</span><span class="n">vx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">m</span>
    <span class="n">ay</span> <span class="o">=</span> <span class="o">-</span><span class="n">g</span> <span class="o">-</span> <span class="n">D</span><span class="o">*</span><span class="n">vy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">vy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="n">m</span>
    <span class="c1"># update velocity and position</span>
    <span class="n">vx</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">ax</span>
    <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">vx</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">vy</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">vy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">ay</span>
    <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">vy</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="c1"># update time to next time step and compute analytical answer</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>
    <span class="n">yanalytic</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="p">(</span><span class="n">vT</span><span class="o">*</span><span class="n">vT</span><span class="o">/</span><span class="n">g</span><span class="p">)</span><span class="o">*</span><span class="n">log</span><span class="p">(</span><span class="n">cosh</span><span class="p">(</span><span class="n">g</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">vT</span><span class="p">))</span><span class="o">+</span><span class="n">vy</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">y</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">):</span>
        <span class="k">break</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;t[s]&#39;</span><span class="p">:</span> <span class="n">t</span><span class="p">,</span>
        <span class="s1">&#39;Relative error in y&#39;</span><span class="p">:</span> <span class="nb">abs</span><span class="p">((</span><span class="n">y</span><span class="o">-</span><span class="n">yanalytic</span><span class="p">)</span><span class="o">/</span><span class="n">yanalytic</span><span class="p">),</span>
        <span class="s1">&#39;vy[m/s]&#39;</span><span class="p">:</span> <span class="n">vy</span><span class="p">,</span>
        <span class="s1">&#39;x[m]&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span>
        <span class="s1">&#39;vx[m/s]&#39;</span><span class="p">:</span> <span class="n">vx</span>
<span class="p">}</span>
<span class="n">NewData</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">NewData</span><span class="p">)</span>
<span class="c1"># save to file</span>
<span class="n">NewData</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">outfile</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1">#then plot</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tfinal</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">vy</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;vy[m/s]&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time[s]&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tfinal</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">vx</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;vx[m/s]&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time[s]&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;EulerIntegration&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We see a good agreement with the analytical solution. This agreement
improves if we decrease <span class="math notranslate nohighlight">\(\Delta t\)</span>. Furthermore, since we put the
initial velocity and position in the <span class="math notranslate nohighlight">\(x\)</span> direction to zero,
the motion in the <span class="math notranslate nohighlight">\(x\)</span>-direction is
zero, as expected.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Smarter way with declaration of vx, vy, x and y</span>
<span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Where to save the figures and data files</span>
<span class="n">PROJECT_ROOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
<span class="n">FIGURE_ID</span> <span class="o">=</span> <span class="s2">&quot;Results/FigureFiles&quot;</span>
<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s2">&quot;DataFiles/&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">,</span> <span class="n">fig_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_path</span><span class="p">(</span><span class="n">dat_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">,</span> <span class="n">dat_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>


<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">plt</span><span class="p">,</span> <span class="n">mpl</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn&#39;</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;serif&#39;</span>

<span class="n">g</span> <span class="o">=</span> <span class="mf">9.80655</span> <span class="c1">#m/s^2 g to 6 leading digits after decimal point</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">0.00245</span> <span class="c1">#m/s</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1"># kg</span>
<span class="c1"># Define Gravitational force as a vector in x and y. It is a constant</span>
<span class="n">G</span> <span class="o">=</span> <span class="o">-</span><span class="n">m</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">1.3</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, a, v, and x</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># Initial conditions as compact 2-dimensional arrays</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">10.0</span><span class="p">])</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">10.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="c1"># Start integrating using Euler&#39;s method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up forces, air resistance FD, not now that we need the norm of the vector</span>
    <span class="c1"># Here you could have defined your own function for this</span>
    <span class="n">vabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">FD</span> <span class="o">=</span> <span class="o">-</span><span class="n">D</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">vabs</span>
    <span class="c1"># Final net forces acting on falling object</span>
    <span class="n">Fnet</span> <span class="o">=</span> <span class="n">FD</span><span class="o">+</span><span class="n">G</span>
    <span class="c1"># The accelration at a given time t_i</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">Fnet</span><span class="o">/</span><span class="n">m</span>
    <span class="c1"># update velocity, time and position using Euler&#39;s method</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">a</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tfinal</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;vy[m/s]&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time[s]&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tfinal</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;vx[m/s]&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time[s]&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;EulerIntegration&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Till now we have only introduced gravity and air resistance and studied
their effects via a constant acceleration due to gravity and the force
arising from air resistance. But what happens when the ball hits the
floor? What if we would like to simulate the normal force from the floor acting on the ball?</p>
<p>We need then to include a force model for the normal force from
the floor on the ball. The simplest approach to such a system is to introduce a contact force
model represented by a spring model.  We model the interaction between the floor
and the ball as a single spring. But the normal force is zero when
there is no contact. Here  we define a simple model that allows us to include
such effects in our models.</p>
<p>The normal force from the floor on the ball is represented by a spring force. This
is a strong simplification of the actual deformation process occurring at the contact
between the ball and the floor due to the deformation of both the ball and the floor.</p>
<p>The deformed region corresponds roughly to the region of <strong>overlap</strong> between the
ball and the floor. The depth of this region is <span class="math notranslate nohighlight">\(\Delta y = R − y(t)\)</span>, where <span class="math notranslate nohighlight">\(R\)</span>
is the radius of the ball. This is supposed to represent the compression of the spring.
Our model for the normal force acting on the ball is then</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{N} = −k (R − y(t)) \boldsymbol{e}_y.
\]</div>
<p>The normal force must act upward when <span class="math notranslate nohighlight">\(y &lt; R\)</span>,
hence the sign must be negative.
However, we must also ensure that the normal force only acts when the ball is in
contact with the floor, otherwise the normal force is zero. The full formation of the
normal force is therefore</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{N} = −k (R − y(t)) \boldsymbol{e}_y,
\]</div>
<p>when <span class="math notranslate nohighlight">\(y(t) &lt; R\)</span> and zero when <span class="math notranslate nohighlight">\(y(t) \le R\)</span>.
In the numerical calculations you can choose <span class="math notranslate nohighlight">\(R=0.1\)</span> m and the spring constant <span class="math notranslate nohighlight">\(k=1000\)</span> N/m.</p>
<ul class="simple">
<li><p>Identify the forces acting on the ball and set up a diagram with the forces acting on the ball. Find the acceleration of the falling ball now with the normal force as well.</p></li>
<li><p>Choose a large enough final time so you can study the ball bouncing up and down several times. Add the normal force and compute the height of the ball as function of time with and without air resistance. Comment your results.</p></li>
</ul>
<p>The following code shows how
to set up the problem with gravitation, a drag force and a normal
force from the ground. The normal force makes the ball bounce up
again.</p>
<p>The code here includes all forces. Commenting out the air resistance will result in a ball which bounces up and down to the same height.
Furthermore, you will note that for larger values of <span class="math notranslate nohighlight">\(\Delta t\)</span> the results will not be physically meaningful. Can you figure out why?  Try also different values for the step size in order to see whether the final results agrees with what you expect.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Smarter way with declaration of vx, vy, x and y</span>
<span class="c1"># Here we have added a normal force from the ground</span>
<span class="c1"># Common imports</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="c1"># Where to save the figures and data files</span>
<span class="n">PROJECT_ROOT_DIR</span> <span class="o">=</span> <span class="s2">&quot;Results&quot;</span>
<span class="n">FIGURE_ID</span> <span class="o">=</span> <span class="s2">&quot;Results/FigureFiles&quot;</span>
<span class="n">DATA_ID</span> <span class="o">=</span> <span class="s2">&quot;DataFiles/&quot;</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">PROJECT_ROOT_DIR</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">)</span>

<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">FIGURE_ID</span><span class="p">,</span> <span class="n">fig_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">data_path</span><span class="p">(</span><span class="n">dat_id</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_ID</span><span class="p">,</span> <span class="n">dat_id</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">save_fig</span><span class="p">(</span><span class="n">fig_id</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">image_path</span><span class="p">(</span><span class="n">fig_id</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.png&quot;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;png&#39;</span><span class="p">)</span>


<span class="kn">from</span> <span class="nn">pylab</span> <span class="kn">import</span> <span class="n">plt</span><span class="p">,</span> <span class="n">mpl</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;seaborn&#39;</span><span class="p">)</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;serif&#39;</span>

<span class="c1"># Define constants</span>
<span class="n">g</span> <span class="o">=</span> <span class="mf">9.80655</span> <span class="c1">#in m/s^2</span>
<span class="n">D</span> <span class="o">=</span> <span class="mf">0.0245</span> <span class="c1"># in mass/length, kg/m</span>
<span class="n">m</span> <span class="o">=</span> <span class="mf">0.2</span> <span class="c1"># in kg</span>
<span class="n">R</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># in meters</span>
<span class="n">k</span> <span class="o">=</span> <span class="mf">1000.0</span> <span class="c1"># in mass/time^2</span>
<span class="c1"># Define Gravitational force as a vector in x and y, zero x component</span>
<span class="n">G</span> <span class="o">=</span> <span class="o">-</span><span class="n">m</span><span class="o">*</span><span class="n">g</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">DeltaT</span> <span class="o">=</span> <span class="mf">0.001</span>
<span class="c1">#set up arrays </span>
<span class="n">tfinal</span> <span class="o">=</span> <span class="mf">15.0</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">ceil</span><span class="p">(</span><span class="n">tfinal</span><span class="o">/</span><span class="n">DeltaT</span><span class="p">)</span>
<span class="c1"># set up arrays for t, v, and r, the latter contain the x and y comps</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
<span class="c1"># Initial conditions</span>
<span class="n">r0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">2.0</span><span class="p">])</span>
<span class="n">v0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">10.0</span><span class="p">,</span><span class="mf">10.0</span><span class="p">])</span>
<span class="n">r</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">r0</span>
<span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">v0</span>
<span class="c1"># Start integrating using Euler&#39;s method</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="c1"># Set up forces, air resistance FD</span>
    <span class="k">if</span> <span class="p">(</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">R</span><span class="p">):</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">R</span><span class="o">-</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">vabs</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
    <span class="n">FD</span> <span class="o">=</span> <span class="o">-</span><span class="n">D</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">vabs</span>
    <span class="n">Fnet</span> <span class="o">=</span> <span class="n">FD</span><span class="o">+</span><span class="n">G</span><span class="o">+</span><span class="n">N</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">Fnet</span><span class="o">/</span><span class="n">m</span>
    <span class="c1"># update velocity, time and position</span>
    <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">a</span>
    <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span><span class="o">*</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">DeltaT</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">tfinal</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x[m]&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">save_fig</span><span class="p">(</span><span class="s2">&quot;BouncingBallEuler&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="chapter2.html" title="previous page"><span class="section-number">2. </span>Classical Mechanics, Mathematics and Numerical background</a>
    <a class='right-next' id="next-link" href="chapter4.html" title="next page"><span class="section-number">4. </span>Work, Energy, Momentum and Conservation laws</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Morten Hjorth-Jensen and Scott Pratt<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>